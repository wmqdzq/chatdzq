import{a as Z,I as ee,b as te,r as p,t as oe,J as U,p as O,w as h,h as $,i as l,y as s,u as c,z as se,l as m,j as k,k as w,F as J,s as M,x as A,v as ae,A as z,c as ne,m as le,_ as ue,C as re,D as ie,o as n,G as ce}from"./entry.d811778a.js";import{_ as de}from"./ossUploader.a4d2e4d5.js";import{_ as pe}from"./createLoading.vue.59f23d8b.js";import{_ as _e,a as ve}from"./close3.bdd7467f.js";const b=y=>(re("data-v-dcce1eed"),y=y(),ie(),y),fe={class:"inputContainer"},me={class:"input-paus"},ge=["onClick"],he=b(()=>s("img",{class:"img",src:_e},null,-1)),ye=b(()=>s("div",null,"停止生成",-1)),Ce=[he,ye],ke={key:0,class:"appoint"},be=b(()=>s("div",{class:"appoint-btn"},"@ 员工名",-1)),Se={class:"appoint-content"},Ie=["onClick"],Le={class:"appoint-list"},Ne={class:"list-tag"},$e=["onClick"],we={class:"area"},Ae={class:"icon pointer"},xe=b(()=>s("div",{class:"logo"},null,-1)),Te={key:0},Be=b(()=>s("div",{class:"triangleRight"},null,-1)),Ve={key:0,class:"icon upload"},Ee={key:1,class:"icon internet"},Re={key:1,class:"agreement"},Ue=["href"],Oe=Z({name:"cInput",__name:"template",props:{content:{},consumeEnergy:{},placeholder:{default:"请输入您要问的问题，通过Ctrl+回车换行"},robotCode:{},robotType:{},isUoload:{type:Boolean},isInternet:{type:Boolean},format:{},isAgreement:{type:Boolean,default:!0},isPaus:{type:Boolean,default:!0},isLoginCheck:{type:Boolean,default:!0},isAppoint:{type:Boolean,default:!1},userCodeList:{},userList:{},robotInfo:{default:{}}},emits:["update:content","update:isAgent","submit","upload","update:userCodeList"],setup(y,{emit:d}){const a=y,x=ee(),_=te(),C=p(!1),S=p(!1),N=p([]),u=p([]),I=p(!1),{consumeEnergy:T,placeholder:B,robotCode:K,isLoginCheck:V}=oe(a);p();const{proxy:r}=le(),o=p(null),L=p(!0),v=p(!1),E=r.$debounce(()=>{if(V.value&&!U("authtoken").value){x.push("/login");return}if(_.isLoad){r.$Message.error("请等机器人回复后再发送哦~");return}let e=JSON.parse(JSON.stringify(o.value));if(e=e?e.replace(/[\r\n]/g,"").trim():"",!e)r.$Message.error("你还没有输入问题呢！"),o.value=null;else{if(e.length>6e3){r.$Message.error("您输入的问题过长！");return}_.setIsLoad(!0),d("update:content",e),O(()=>{d("submit"),v.value=!0,setTimeout(()=>{o.value=null},50)})}},300),P=()=>{d("update:content",o.value)},D=r.$debounce(e=>{if(V.value&&!U("authtoken").value){x.push("/login");return}if(e.ctrlKey&&e.keyCode===13){let t=JSON.parse(JSON.stringify(o.value));t=t?t.replace(/[\r\n]/g,"").trim():"",t?o.value=o.value+`
`:(r.$Message.error("你还没有输入问题呢！"),o.value=null,v.value=!1)}if(!e.ctrlKey&&e.keyCode===13){let t=JSON.parse(JSON.stringify(o.value));if(t=t?t.replace(/[\r\n]/g,"").trim():"",!t)r.$Message.error("你还没有输入问题呢！"),v.value=!1,setTimeout(()=>{o.value=null},50);else{if(_.isLoad){r.$Message.error("请等机器人回复后再发送哦~");return}o.value=o.value.replace(/\n$/,""),_.setIsLoad(!0),d("update:content",t),O(()=>{d("submit"),v.value=!0,setTimeout(()=>{o.value=null},50)})}}},300),F=()=>{L.value=!L.value,d("update:isAgent",L.value)},j=e=>{I.value=!0;let t=[];e.forEach(g=>{t.push({resourceName:g.name,resourceCode:g.code,resourceSize:g.size})});let f={resourceList:t};r.$api.resourceUploadCallback(f).then(()=>{I.value=!1,d("upload",e)},g=>{I.value=!1})},q=()=>{_.resetStream(),_.abortReadingStream()},G=()=>{S.value=!0,N.value=[],r.$api.queryDigitalRobotInfoList().then(e=>{N.value=e.data,S.value=!1}).catch(()=>{S.value=!1})},H=e=>{u.value.length===0?u.value.push(e):u.value.some(f=>f.userCode===e.userCode)||u.value.push(e),C.value=!1};return h(()=>a.content,()=>{o.value=a.content,(!a.content||a.content=="")&&(v.value=!1)},{deep:!0,immediate:!0}),h(()=>a.consumeEnergy,()=>{a.consumeEnergy==0?v.value=!0:v.value=!1},{deep:!0,immediate:!0}),h(()=>C.value,()=>{a.isAppoint&&C.value&&G()}),h(()=>u.value,()=>{d("update:userCodeList",[]);let e=[];u.value.forEach((t,f)=>{e.push(t.userCode),f==Number(u.value.length-1)&&d("update:userCodeList",e)})},{deep:!0}),h(()=>a.userList,e=>{u.value=e},{deep:!0}),h(()=>a.robotInfo,()=>{console.log(a.robotInfo),console.log(a.robotInfo)},{deep:!0}),(e,t)=>{const f=$("Spin"),g=$("Poptip"),Q=$("Input"),W=ue,X=de,Y=pe;return n(),l("div",fe,[s("div",me,[c(_).isLoad&&a.isPaus?(n(),l("div",{key:0,class:"input-top",onClick:se(q,["stop"])},Ce,8,ge)):m("",!0)]),e.robotInfo&&e.robotInfo.type&&e.robotInfo.type=="AI_ASSISTANT"?(n(),l("div",ke,[k(g,{placement:"top",transfer:!0,"popper-class":"popperClassTemplate",modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=i=>C.value=i)},{content:w(()=>[s("div",Se,[k(f,{fix:"",show:S.value},null,8,["show"]),(n(!0),l(J,null,M(N.value,i=>(n(),l("div",{class:"content-item",onClick:R=>H(i)},A(i.userName),9,Ie))),256))])]),default:w(()=>[be]),_:1},8,["modelValue"]),s("div",Le,[(n(!0),l(J,null,M(u.value,(i,R)=>(n(),l("div",Ne,[s("div",null,A(i.userName),1),s("img",{class:"tag-close",onClick:Je=>u.value.splice(R,1),src:ve},null,8,$e)]))),256))])])):m("",!0),s("div",we,[k(W,null,{default:w(()=>[k(Q,{type:"textarea",border:!1,autosize:{minRows:1,maxRows:4},rows:1,modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=i=>o.value=i),onOnChange:P,onKeydown:c(D),placeholder:c(B)?c(B):"请输入您要问的问题"},null,8,["modelValue","onKeydown","placeholder"])]),_:1}),s("div",Ae,[s("div",{class:"submit",onClick:t[2]||(t[2]=(...i)=>c(E)&&c(E)(...i))},[xe,c(T)?(n(),l("div",Te,"-"+A(c(T)),1)):m("",!0),Be])]),e.isUoload?(n(),l("div",Ve,[k(X,{format:e.format,modeType:"icon",code:c(K),type:e.robotType,onUploadSuccess:j},null,8,["format","code","type"])])):m("",!0),e.isInternet?(n(),l("div",Ee,[s("span",{class:ae(L.value?"active":""),onClick:F},null,2)])):m("",!0)]),a.isAgreement?(n(),l("p",Re,[z(" 请遵守"),s("a",{href:c(_).configuration.userServiceLink},"《用户服务协议》",8,Ue),z("，Ai结果由各大模型输出，其内容仅供参考，不代表我们的观点和态度。 ")])):m("",!0),I.value?(n(),ne(Y,{key:2,position:"center"})):m("",!0)])}}});const De=ce(Oe,[["__scopeId","data-v-dcce1eed"]]);export{De as i};
