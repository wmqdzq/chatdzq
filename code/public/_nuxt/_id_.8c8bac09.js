import{a as R,b as q,e as $,r as s,t as z,f as x,h as k,i as a,y as u,x as w,F as _,s as E,j as N,m as F,p as U,C as G,D as j,o as e,v as I,B as O,c as h,l as y,G as W}from"./entry.d811778a.js";import{_ as J}from"./robot.23bfda18.js";import{i as K}from"./template.800b7f53.js";import{c as Q}from"./content.8ac9cfa6.js";import"./_commonjsHelpers.86de73f2.js";import"./_commonjs-dynamic-modules.302442b1.js";import"./ossUploader.a4d2e4d5.js";import"./upload.51048db5.js";import"./svga.1e6ae788.js";import"./loding.bf55ea5c.js";import"./createLoading.vue.59f23d8b.js";import"./close3.bdd7467f.js";const M=i=>(G("data-v-0090209d"),i=i(),j(),i),X={class:"preview"},Z={class:"preview-top"},ee={class:"preview-content"},te={class:"logo"},oe=["src"],se={key:1,src:J},ne={key:1,src:"https://hz-oss.chatdzq.com/file/common/static-web/d638965e-dd7b-4fe9-b03b-3f39c3342d1a.png"},ae=["src"],re=M(()=>u("h3",null,"您可以告诉我需要创作什么内容？比如下面：",-1)),ce=["onClick"],le=M(()=>u("div",{id:"bottoms"},null,-1)),ue={class:"preview-content-bottom"},ie=R({__name:"shareDialogue",props:{data:{},name:{}},setup(i){const g=i;q();const{proxy:n}=F(),d=$(),c=s([]),v=s({});s(null);const C=s([]);s("");const S=s(""),p=s("");s("CHAT");const A=s(!1);s(!1);const f=s(!1),T=s("");z(g);const D=()=>{let o=new Date().getTime();S.value=o.toString()},B=async()=>{var l;if(f.value){n.$Message.error("该链接已被关闭。请联系管理员。");return}if(A.value)return;if(n.$isEmpty(p.value)){n.$Message.error("请输入问题");return}var o="";o=window.location.host;const r={sk:((l=d.currentRoute.value.params)==null?void 0:l.id)??"",stream:!0,groupId:d.currentRoute.value.query.groupId?d.currentRoute.value.query.groupId:S.value,content:p.value,source:o};c.value.push({content:p.value,type:"USER",chatType:"CHAT"}),n.$setAiChat(n,r,"portal",m=>{m&&m.content&&(n.$processChatData(c.value,m,!0),L())})},L=async()=>{var o;await U(),(o=document.querySelector("#bottoms"))==null||o.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},V=()=>{var o;n.$api.robot_checkRobotInfoByEncryCode({encryCode:((o=d.currentRoute.value.params)==null?void 0:o.id)??""}).then(r=>{f.value=!1,T.value=r.data.code,v.value=r.data;let l=r.data.welcomeContent;C.value=r.data.robotPromptText?r.data.robotPromptText.split("@"):[],n.$isEmpty(l)||(n.$isEmpty(c.value)?c.value.push({content:l,type:"SYSTEM",chatType:"CHAT"}):(c.value[0].content=l,c.value[0].type="SYSTEM",c.value[0].chatType="CHAT"))}).catch(()=>{f.value=!0})},Y=o=>{o.srcElement.scrollTop<10};return x(()=>{D(),V(),n.$toMonitorA()}),(o,r)=>{const l=k("Spin"),m=k("Image");return e(),a("div",X,[u("div",Z,w(v.value.name),1),u("div",ee,[u("div",{class:"preview-content-main",onScroll:Y},[(e(!0),a(_,null,E(c.value,(t,H)=>(e(),a("div",{class:I(["content",t.type=="SYSTEM"?"left":"right"])},[u("div",te,[t.type=="SYSTEM"?(e(),a(_,{key:0},[v.value.robotLogo?(e(),a("img",{key:0,src:v.value.robotLogo},null,8,oe)):(e(),a("img",se))],64)):(e(),a("img",ne))]),u("div",{class:I(["name",t.type=="SYSTEM"?"blue":""]),style:O({"background-color":t.type=="USER"?v.value.dialogueColor:"#fff"})},[o.$isEmpty(t.content)?(e(),h(l,{key:0})):(e(),a(_,{key:1},[t.chatType=="CHAT"?(e(),h(Q,{key:0,content:t.content,isShowTagView:!1},null,8,["content"])):y("",!0),t.chatType=="DRAW"?(e(),h(m,{key:1,preview:!0,"preview-list":[t.content],class:"cImage-img",src:t.content,fit:"cover"},null,8,["preview-list","src"])):y("",!0),t.chatType=="VIDEO"?(e(),a("video",{key:2,width:"658",height:"444",controls:"",src:t.content},null,8,ae)):y("",!0)],64)),t.type=="SYSTEM"&&H==0?(e(),a(_,{key:2},[re,(e(!0),a(_,null,E(C.value,(b,P)=>(e(),a("div",{class:"tag",key:"prompt"+P,onClick:de=>p.value=b},w(b),9,ce))),128))],64)):y("",!0)],6)],2))),256)),le],32),u("div",ue,[N(K,{content:p.value,"onUpdate:content":r[0]||(r[0]=t=>p.value=t),isAgreement:!1,isPaus:!0,robotCode:T.value,onSubmit:B,isLoginCheck:!1},null,8,["content","robotCode"])])])])}}});const pe=W(ie,[["__scopeId","data-v-0090209d"]]),we=R({__name:"[id]",setup(i){$();const g=s({code:"",type:"",name:"",llmCode:"",promptText:"",hitRate:"",styleSetup:"",typeName:""});x(()=>{n()});const n=async()=>{};return(d,c)=>(e(),h(pe,{data:g.value.styleSetup},null,8,["data"]))}});export{we as default};
