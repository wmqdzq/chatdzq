import{a as Z,r as u,e as D,J as g,b as j,f as W,w as K,N as $,h as m,i as V,y as a,j as l,k as r,l as I,F as X,z as q,u as h,c as N,B as ee,E as te,m as ae,p as O,a2 as oe,C as le,D as ne,o as p,A as w,x as se,G as ue}from"./entry.b3d0478f.js";import ie from"./weixinScan.cfa18dfe.js";import{l as re}from"./loginbg.c2d5a2fb.js";import ce from"./imageCode.e7d995d7.js";import"./_commonjsHelpers.86de73f2.js";import"./_commonjs-dynamic-modules.302442b1.js";const de="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABXCAYAAACAw4LhAAAAAXNSR0IArs4c6QAAA/1JREFUeF7t3N1x1DAQB/CV796hhKQCPHYKCBVACaQDqCChAkIFBCpIGiDhPTLuAErIYx6SE6PhzFx8srQryWdy/t9LJnO7kvyzzh+SbEXrz9HR0akx5qD7f5d/tdYnnPpGbuOV1vrS1466rs+J6IUnZqsM1QWXZXlQFMW1UmrnyFrrf+0IbOA1ER1zdoY0xhjzsWmas0D9v4ho0MdVxpMNmwp5NsB2702BPCvgKZBnB7xr5FkC7xJ5tsC7Qp41cIe8WCy+SC991vEv7bnTl5sRuCWiu5h2GmN+FEVx48tdrVZeA6XUudb682YZrOvPmAZ3OVVVvVNKeRuWC1gp9fr29taLNLQtVVWdKaVOfdtqjDlpmuZC4gHgtRaAiaiua++dHHrwwG8LhwjJQacXi2NwAh4nFcAcpUCMHb9o2/a3KwzAeYBftm3rvP4EcAZgXxE5gcuyLJfLpb1xcX4eHh7aoR0d2kzOZZpSqjXG+G5kLrTWX5/tjUYIKeV7DnCo/OCAe6iAmO9z9uCY+rk5AOZKRcYBOBKOmwZgrlRk3LMF5szxcW+VQ3bruqJmnZVSb4jobagO3/eTnORsg0LIuYA5J1QP0KUx5soHqJT6RESDl4mTAYeQ/wfgnayLSPl5cHKHejKAOXrMGBcygJl43LA+MoC5coK4TWQAC+AkoR1y0zSHkryh2JSriL04yblgfGPJUnQAS8V68Yz1wXZpadSNhl1PERiKpKIoTpbLpXNiwTb1/v7+rj9cOvq0faLpk/TQrHLOulxlPT4+Hg7N3AzVvVfA69U53kXUxhg79R/1mT0wEdkZBe/jCHVdmyhdIgIwgGP7zt88xjEYPTiFGMApeoxcADOQUkKqqnqvlHrlKeOmP23ej63rOnadsz3JfZAuC3hWl2kpO2eqXACPLA9gAI8sMHLx6MEAHllg5OLRgwEsEsjRYVyDQdxyt3K5iaKtnCLYzowsFovvRJQ0/eSaOqrr2vueiG57J114sgv0HMgADuypVGQAM34KKcgAZgDbkFhkADOBY5EBLACOQQawEFiKDOAIYAkygCOBucgATgDmILuA7VSV79GBrkn2lTT9N67sza2yxN13CcdZZSmpa5bAvp4MYEn3ibitBnBGYFdPBnBm4D4ygEcA3kQ2xnwLvUdY0oTZnuRcSN2juNKXz/nAASzpjhGxAI5Ak6QAWKIVEQvgCDRJCoAlWhGxAI5Ak6QAWKIVEQtgIVpZlsdFUdgnSrfsVqvVT/tmvM0iASwHHlxBtPcre4RW0eFD48kAjibdTnQhAzgjMHeoE8fgRPTNnowenIg5lN4hu4Y60YMzoQ8NdQI4E/BQMQAG8MgCIxePHgzgkQVGLv4PVYLVhdF1rb0AAAAASUVORK5CYII=",v=C=>(le("data-v-7b8c5910"),C=C(),ne(),C),ve={class:"login-main"},me={class:"logo"},ge=["src"],pe={class:"login-area"},fe={key:0,class:"weixin-login"},_e=v(()=>a("div",{class:"weixin-login-top"},[a("div",null,"扫码登录更方便")],-1)),Ae={class:"title"},he={class:"form"},Ce={class:"code"},be={class:"name"},xe=v(()=>a("span",null,"还没有账号，",-1)),ke=v(()=>a("div",null,"忘记密码?",-1)),ye={class:"agree"},Ve=v(()=>a("div",null,"登录或注册即代表同意",-1)),Ie=v(()=>a("div",null,"用户服务协议",-1)),Ne=v(()=>a("div",null,"和",-1)),Oe=v(()=>a("div",null,"隐私政策",-1)),we=v(()=>a("div",{class:"login-bottom"},[a("div",null,"搜索无限可能！")],-1)),Be=Z({__name:"index",setup(C){const{Modal:Q}=te,{proxy:o}=ae(),B=u(),d=D(),n=u(0),R=g("authtoken"),s=j(),x=u(""),e=u({captchaCode:"",accountNumber:"",password:"",code:"",time:90,single:!1,btnloading:!1});u(0),u(""),u("");const M=u(0),b=u(!1),z=u(null),f=u(null);u(null),clearInterval(f.value),s.setIsShowMessage(!0),g("authtoken").value=null,W(()=>{P(),s.clearuUser()});const L=u(re),P=()=>{let i={advertBoardCode:"LOGIN_BACKGROUP"};o.$api1.banner_list_photo(i).then(t=>{t.resultObj.length>0&&(L.value=t.resultObj[0].advertBgPhoto)})},_=u();K(()=>n.value,i=>{O(()=>{i===0&&e.value.accountNumber.length==11&&_.value.getCodeImg(e.value.accountNumber,"LOGIN")})},{deep:!0,immediate:!0}),K(()=>e.value.accountNumber,i=>{O(()=>{n.value===0&&i.length===11&&_.value.getCodeImg(e.value.accountNumber,"LOGIN")})},{deep:!0,immediate:!0});const U=o.$debounce(()=>{if(o.$isEmpty(e.value.accountNumber))return o.$Message.error("请输入您的手机号");if(o.$isEmpty(_.value.captchaCode))return o.$Message.error("请输入图形验证码");e.value.btnloading=!0;let i={captchaCode:_.value.captchaCode,account:e.value.accountNumber,sendCodeType:"LOGIN"};o.$api.tenant_sendRegisterCode(i).then(()=>{clearInterval(f.value),o.$Message.success("验证码已发送,请注意查收"),f.value=setInterval(()=>{e.value.time=Number(e.value.time)-1,e.value.btnloading=!1,e.value.time==0&&(e.value.time=90,clearInterval(f.value))},1e3)}).catch(()=>{e.value.btnloading=!1})},500),T=o.$debounce(()=>{if(o.$isEmpty(e.value.accountNumber)){o.$Message.error("请输入您的手机号");return}if(n==1&&o.$isEmpty(e.value.password)){o.$Message.error("请输入密码");return}if(n==0&&o.$isEmpty(e.value.code)){o.$Message.error("请输入验证码");return}if(!e.value.single){o.$Message.error("请同意用户服务协议");return}b.value=!0;let i={accountNumber:e.value.accountNumber,password:n.value==0?"":e.value.password,registerCode:n.value==0?e.value.code:"",secretKey:g("secretKey").value?g("secretKey").value:""};o.$api.tenant_tenantLogin(i).then(t=>{b.value=!1,x.value=t.data.resultHint,R.value=JSON.stringify(t.data),g("secretKey").value=null,G(t.data)}).catch(t=>{if(b.value=!1,t.code==1111){M.value=t.code;return}if(t.code==1112){z.value.show();return}t.code==10007&&(g("secretKey").value=null)})},500),F=async()=>{n.value=3,await O(),B.value.chooseWeixin()},G=i=>{i.isTenant?(s.fullPath&&s.fullPath=="/",s.defJumpUrl.indexOf("/share")!=-1?d.go(-1):d.push("/")):s.fullPath?s.fullPath.indexOf("enterprise")!=-1||s.fullPath.indexOf("/ai")!=-1?d.push("/"):s.defJumpUrl.indexOf("/share")!=-1?d.go(-1):d.push("/"):d.push("/"),o.$isEmpty(x.value)||setTimeout(()=>{Q.confirm({okText:"我知道了",cancelText:"",content:x.value})},3e3),s.setTopNavList(o)};return $(()=>{clearInterval(f.value)}),(i,t)=>{const A=oe,S=m("van-tab"),Y=m("van-tabs"),k=m("Input"),y=m("FormItem"),E=m("Button"),H=m("Form"),J=m("Checkbox");return p(),V("div",{class:"login",style:ee("background-image: url("+L.value+");")},[a("div",ve,[l(A,{to:"/"},{default:r(()=>[a("div",me,[a("img",{class:"login-main-img",src:h(s).configuration.loginLogo},null,8,ge)])]),_:1}),a("div",pe,[n.value!=3?(p(),V("div",fe,[_e,a("img",{onClick:F,class:"scan",src:de})])):I("",!0),n.value!=3?(p(),V(X,{key:1},[a("div",Ae,[l(Y,{active:n.value,"onUpdate:active":t[0]||(t[0]=c=>n.value=c),"title-active-color":"#0090F7","line-height":"4px","line-width":"56px"},{default:r(()=>[l(S,{title:"短信登录"}),l(S,{title:"密码登录"})]),_:1},8,["active"])]),a("div",he,[l(H,null,{default:r(()=>[l(y,null,{default:r(()=>[l(k,{modelValue:e.value.accountNumber,"onUpdate:modelValue":t[1]||(t[1]=c=>e.value.accountNumber=c),maxlength:11,oninput:e.value.accountNumber=e.value.accountNumber.replace(/[^\d]/g,""),size:"large",placeholder:"手机号"},null,8,["modelValue","oninput"])]),_:1}),n.value==1?(p(),N(y,{key:0},{default:r(()=>[l(k,{size:"large",modelValue:e.value.password,"onUpdate:modelValue":t[2]||(t[2]=c=>e.value.password=c),type:"password",placeholder:"密码"},null,8,["modelValue"])]),_:1})):I("",!0),n.value==0?(p(),N(y,{key:1},{default:r(()=>[l(ce,{ref_key:"imgCode",ref:_},null,512),a("div",Ce,[l(k,{size:"large",modelValue:e.value.code,"onUpdate:modelValue":t[3]||(t[3]=c=>e.value.code=c),placeholder:"验证码"},null,8,["modelValue"]),l(E,{size:"large",disabled:e.value.time<90,loading:e.value.btnloading,onClick:h(U),class:"btn"},{default:r(()=>[w(se(e.value.time>=90?"获取验证码":e.value.time+"s后重新获取"),1)]),_:1},8,["disabled","loading","onClick"])])]),_:1})):I("",!0)]),_:1})]),a("div",be,[a("div",null,[xe,a("span",null,[l(A,{to:"/login/register"},{default:r(()=>[w("前往注册")]),_:1})])]),a("div",null,[l(A,{to:"/login/forget"},{default:r(()=>[ke]),_:1})])]),l(E,{class:"btn",type:"primary",size:"large",loading:b.value,onClick:q(h(T),["stop"])},{default:r(()=>[w("登录")]),_:1},8,["loading","onClick"]),a("div",ye,[l(J,{modelValue:e.value.single,"onUpdate:modelValue":t[4]||(t[4]=c=>e.value.single=c)},null,8,["modelValue"]),Ve,l(A,{to:h(s).configuration.userServiceLink},{default:r(()=>[Ie]),_:1},8,["to"]),Ne,l(A,{to:h(s).configuration.privacyPolicy},{default:r(()=>[Oe]),_:1},8,["to"])])],64)):(p(),N(ie,{key:2,ref_key:"weixinScanRef",ref:B,active:n.value,"onUpdate:active":t[5]||(t[5]=c=>n.value=c)},null,8,["active"]))]),we])],4)}}});const Me=ue(Be,[["__scopeId","data-v-7b8c5910"]]);export{Me as default};
