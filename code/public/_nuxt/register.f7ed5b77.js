import{a as D,r as s,e as P,J as i,b as A,f as H,N as J,h as c,i as E,y as o,j as l,k as r,F as q,u as d,c as Q,B as W,E as X,m as Y,a2 as Z,C as ee,D as oe,o as x,A as $,x as ae,G as te}from"./entry.d811778a.js";import le from"./weixinScan.34d8bdd9.js";import{l as ne}from"./loginbg.ebcd0f03.js";import se from"./imageCode.cd26929d.js";import"./_commonjsHelpers.86de73f2.js";import"./_commonjs-dynamic-modules.302442b1.js";const m=p=>(ee("data-v-aa82669d"),p=p(),oe(),p),ue={class:"login-main"},re={class:"logo"},ie=["src"],ce={class:"login-area"},de=m(()=>o("div",{class:"title-name"},"注册新账号",-1)),me={class:"form"},pe={class:"code"},ve={class:"name"},ge=m(()=>o("span",null,"已有账号,",-1)),_e={class:"agree"},fe=m(()=>o("div",null,"登录或注册即代表同意",-1)),he=["href"],Ce=m(()=>o("div",null,"和",-1)),ye=["href"],be=m(()=>o("div",{class:"login-bottom"},[o("div",null,"搜索无限可能！")],-1)),ke=D({__name:"register",setup(p){const{Modal:M}=X,{proxy:e}=Y(),R=s(),b=s(0),U=P(),z=i("authtoken"),a=s({captchaCode:"",accountNumber:"",registerCode:"",password:"",secretKey:i("secretKey").value?i("secretKey").value:""}),k=A(),w=s(""),v=s(!1),I=s(!1),g=s("获取验证码"),_=s(null),f=s(!1),V=s("");i("authtoken").value=null,H(()=>{T()});const N=s(ne),T=()=>{let n={advertBoardCode:"LOGIN_BACKGROUP"};e.$api1.banner_list_photo(n).then(t=>{t.resultObj.length>0&&(N.value=t.resultObj[0].advertBgPhoto)})},h=s(),F=()=>{a.value.accountNumber.length==11&&h.value.getCodeImg(a.value.accountNumber,"REGISTER")},K=e.$debounce(()=>{if(g.value!=="获取验证码")return;if(clearInterval(_.value),e.$isEmpty(a.value.accountNumber))return e.$Message.error("请输入您的手机号");if(e.$isEmpty(h.value.captchaCode))return e.$Message.error("请输入图形验证码");v.value=!0;let n={captchaCode:h.value.captchaCode,account:a.value.accountNumber,sendCodeType:"REGISTER"};e.$api.tenant_sendRegisterCode(n).then(t=>{v.value=!1,O()}).catch(()=>{v.value=!1})},500),O=()=>{clearInterval(_.valuer);let n=90;_.value=setInterval(()=>{n!==0?(g.value=n+"s",n--):(n=90,g.value="获取验证码",clearInterval(_.value))},1e3)},G=e.$debounce(()=>{if(e.$isEmpty(a.value.accountNumber)){e.$Message.error("请输入您的手机号");return}if(e.$isEmpty(a.value.registerCode)){e.$Message.error("请输入验证码");return}if(e.$isEmpty(a.value.password)){e.$Message.error("请设置密码");return}if(V.value!==a.value.password){e.$Message.error("重复输入密码错误");return}if(!I.value){e.$Message.error("请阅读并同意用户服务协议、隐私政策");return}f.value=!0,e.$api.tenant_register(a.value).then(n=>{f.value=!1,w.value=n.data.resultHint,z.value=JSON.stringify(n.data),U.push("/"),i("secretKey").value=null,e.$isEmpty(w.value)||setTimeout(()=>{M.confirm({okText:"我知道了",cancelText:"",content:w.value})},3e3)}).catch(n=>{n.resultCode==10007&&(i("secretKey").value=null),f.value=!1})},500);return J(()=>{}),(n,t)=>{const S=Z,C=c("Input"),y=c("FormItem"),B=c("Button"),L=c("Form"),j=c("Checkbox");return x(),E("div",{class:"login",style:W("background-image: url("+N.value+");")},[o("div",ue,[l(S,{to:"/"},{default:r(()=>[o("div",re,[o("img",{class:"login-main-img",src:d(k).configuration.loginLogo},null,8,ie)])]),_:1}),o("div",ce,[b.value!=3?(x(),E(q,{key:0},[de,o("div",me,[l(L,null,{default:r(()=>[l(y,null,{default:r(()=>[l(C,{size:"large",autocomplete:"new-password",maxlength:11,modelValue:a.value.accountNumber,"onUpdate:modelValue":t[0]||(t[0]=u=>a.value.accountNumber=u),onOnChange:F,oninput:a.value.accountNumber=a.value.accountNumber.replace(/[^\d]/g,""),placeholder:"手机号"},null,8,["modelValue","oninput"])]),_:1}),l(y,null,{default:r(()=>[l(se,{ref_key:"imgCode",ref:h},null,512),o("div",pe,[l(C,{size:"large",autocomplete:"new-password",modelValue:a.value.registerCode,"onUpdate:modelValue":t[1]||(t[1]=u=>a.value.registerCode=u),placeholder:"验证码"},null,8,["modelValue"]),l(B,{size:"large",class:"btn",loading:v.value,onClick:d(K)},{default:r(()=>[$(ae(g.value),1)]),_:1},8,["loading","onClick"])])]),_:1}),l(y,null,{default:r(()=>[l(C,{size:"large",type:"password",autocomplete:"new-password",modelValue:a.value.password,"onUpdate:modelValue":t[2]||(t[2]=u=>a.value.password=u),placeholder:"设置密码"},null,8,["modelValue"])]),_:1}),l(y,null,{default:r(()=>[l(C,{size:"large",type:"password",autocomplete:"new-password",modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=u=>V.value=u),placeholder:"重复密码"},null,8,["modelValue"])]),_:1})]),_:1})]),o("div",ve,[o("div",null,[ge,o("span",null,[l(S,{to:"/login"},{default:r(()=>[$("立即登录")]),_:1})])])]),l(B,{class:"btn",type:"primary",size:"large",loading:f.value,onClick:d(G)},{default:r(()=>[$("注册")]),_:1},8,["loading","onClick"]),o("div",_e,[l(j,{modelValue:I.value,"onUpdate:modelValue":t[4]||(t[4]=u=>I.value=u)},null,8,["modelValue"]),fe,o("a",{href:d(k).configuration.userServiceLink},"用户服务协议",8,he),Ce,o("a",{href:d(k).configuration.privacyPolicy},"隐私政策",8,ye)])],64)):(x(),Q(le,{key:1,ref_key:"weixinScanRef",ref:R,active:b.value,"onUpdate:active":t[5]||(t[5]=u=>b.value=u)},null,8,["active"]))]),be])],4)}}});const Se=te(ke,[["__scopeId","data-v-aa82669d"]]);export{Se as default};
