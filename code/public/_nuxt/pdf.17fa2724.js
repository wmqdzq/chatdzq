var Ge=Object.defineProperty;var Xe=(ot,f,Q)=>f in ot?Ge(ot,f,{enumerable:!0,configurable:!0,writable:!0,value:Q}):ot[f]=Q;var Mt=(ot,f,Q)=>(Xe(ot,typeof f!="symbol"?f+"":f,Q),Q),re=(ot,f,Q)=>{if(!f.has(ot))throw TypeError("Cannot "+Q)};var P=(ot,f,Q)=>(re(ot,f,"read from private field"),Q?Q.call(ot):f.get(ot)),rt=(ot,f,Q)=>{if(f.has(ot))throw TypeError("Cannot add the same private member more than once");f instanceof WeakSet?f.add(ot):f.set(ot,Q)},mt=(ot,f,Q,S)=>(re(ot,f,"write to private field"),S?S.call(ot,Q):f.set(ot,Q),Q),ae=(ot,f,Q,S)=>({set _(y){mt(ot,f,y,Q)},get _(){return P(ot,f,S)}}),ht=(ot,f,Q)=>(re(ot,f,"access private method"),Q);import{a as getDefaultExportFromCjs}from"./_commonjsHelpers.86de73f2.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules.302442b1.js";import{ag as require$$5}from"./entry.d811778a.js";function _mergeNamespaces(ot,f){for(var Q=0;Q<f.length;Q++){const S=f[Q];if(typeof S!="string"&&!Array.isArray(S)){for(const y in S)if(y!=="default"&&!(y in ot)){const J=Object.getOwnPropertyDescriptor(S,y);J&&Object.defineProperty(ot,y,J.get?J:{enumerable:!0,get:()=>S[y]})}}}return Object.freeze(Object.defineProperty(ot,Symbol.toStringTag,{value:"Module"}))}var pdfExports={},pdf$2={get exports(){return pdfExports},set exports(ot){pdfExports=ot}};(function(module,exports){(function(f,Q){module.exports=Q()})(globalThis,()=>(()=>{var __webpack_modules__=[,(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.VerbosityLevel=f.Util=f.UnknownErrorException=f.UnexpectedResponseException=f.UNSUPPORTED_FEATURES=f.TextRenderingMode=f.StreamType=f.RenderingIntentFlag=f.PermissionFlag=f.PasswordResponses=f.PasswordException=f.PageActionEventType=f.OPS=f.MissingPDFException=f.LINE_FACTOR=f.LINE_DESCENT_FACTOR=f.InvalidPDFException=f.ImageKind=f.IDENTITY_MATRIX=f.FormatError=f.FontType=f.FeatureTest=f.FONT_IDENTITY_MATRIX=f.DocumentActionEventType=f.CMapCompressionType=f.BaseException=f.AnnotationType=f.AnnotationStateModelType=f.AnnotationReviewState=f.AnnotationReplyType=f.AnnotationMode=f.AnnotationMarkedState=f.AnnotationFlag=f.AnnotationFieldFlag=f.AnnotationEditorType=f.AnnotationEditorPrefix=f.AnnotationEditorParamsType=f.AnnotationBorderStyleType=f.AnnotationActionEventType=f.AbortException=void 0,f.arrayByteLength=st,f.arraysToBytes=dt,f.assert=c,f.bytesToString=w,f.createPromiseCapability=pt,f.createValidAbsoluteUrl=E,f.escapeString=Tt,f.getModificationDate=it,f.getVerbosityLevel=et,f.info=lt,f.isArrayBuffer=Ot,f.isArrayEqual=Zt,f.isAscii=Rt,f.objectFromMap=Z,f.objectSize=at,f.setVerbosityLevel=H,f.shadow=R,f.string32=Y,f.stringToBytes=L,f.stringToPDFString=Et,f.stringToUTF16BEString=Ft,f.stringToUTF8String=Xt,f.unreachable=D,f.utf8StringToString=xt,f.warn=bt,Q(2);const S=[1,0,0,1,0,0];f.IDENTITY_MATRIX=S;const y=[.001,0,0,.001,0,0];f.FONT_IDENTITY_MATRIX=y;const J=1.35;f.LINE_FACTOR=J;const X=.35;f.LINE_DESCENT_FACTOR=X;const tt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};f.RenderingIntentFlag=tt;const N={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};f.AnnotationMode=N;const _="pdfjs_internal_editor_";f.AnnotationEditorPrefix=_;const k={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};f.AnnotationEditorType=k;const O={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};f.AnnotationEditorParamsType=O;const C={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};f.PermissionFlag=C;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};f.TextRenderingMode=v;const l={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};f.ImageKind=l;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};f.AnnotationType=t;const s={MARKED:"Marked",REVIEW:"Review"};f.AnnotationStateModelType=s;const r={MARKED:"Marked",UNMARKED:"Unmarked"};f.AnnotationMarkedState=r;const g={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};f.AnnotationReviewState=g;const m={GROUP:"Group",REPLY:"R"};f.AnnotationReplyType=m;const a={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};f.AnnotationFlag=a;const e={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};f.AnnotationFieldFlag=e;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};f.AnnotationBorderStyleType=n;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};f.AnnotationActionEventType=d;const T={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};f.DocumentActionEventType=T;const b={O:"PageOpen",C:"PageClose"};f.PageActionEventType=b;const u={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};f.StreamType=u;const x={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};f.FontType=x;const K={ERRORS:0,WARNINGS:1,INFOS:5};f.VerbosityLevel=K;const nt={NONE:0,BINARY:1,STREAM:2};f.CMapCompressionType=nt;const $={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};f.OPS=$;const z={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};f.UNSUPPORTED_FEATURES=z;const U={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};f.PasswordResponses=U;let W=K.WARNINGS;function H(V){Number.isInteger(V)&&(W=V)}function et(){return W}function lt(V){W>=K.INFOS&&console.log(`Info: ${V}`)}function bt(V){W>=K.WARNINGS&&console.log(`Warning: ${V}`)}function D(V){throw new Error(V)}function c(V,j){V||D(j)}function o(V){if(!V)return!1;switch(V.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function E(V,j=null,B=null){if(!V)return null;try{if(B&&typeof V=="string"){if(B.addDefaultProtocol&&V.startsWith("www.")){const _t=V.match(/\./g);_t&&_t.length>=2&&(V=`http://${V}`)}if(B.tryConvertEncoding)try{V=Xt(V)}catch{}}const gt=j?new URL(V,j):new URL(V);if(o(gt))return gt}catch{}return null}function R(V,j,B){return Object.defineProperty(V,j,{value:B,enumerable:!0,configurable:!0,writable:!1}),B}const M=function(){function j(B,gt){this.constructor===j&&D("Cannot initialize BaseException."),this.message=B,this.name=gt}return j.prototype=new Error,j.constructor=j,j}();f.BaseException=M;class I extends M{constructor(j,B){super(j,"PasswordException"),this.code=B}}f.PasswordException=I;class G extends M{constructor(j,B){super(j,"UnknownErrorException"),this.details=B}}f.UnknownErrorException=G;class q extends M{constructor(j){super(j,"InvalidPDFException")}}f.InvalidPDFException=q;class i extends M{constructor(j){super(j,"MissingPDFException")}}f.MissingPDFException=i;class h extends M{constructor(j,B){super(j,"UnexpectedResponseException"),this.status=B}}f.UnexpectedResponseException=h;class p extends M{constructor(j){super(j,"FormatError")}}f.FormatError=p;class A extends M{constructor(j){super(j,"AbortException")}}f.AbortException=A;function w(V){(typeof V!="object"||V===null||V.length===void 0)&&D("Invalid argument for bytesToString");const j=V.length,B=8192;if(j<B)return String.fromCharCode.apply(null,V);const gt=[];for(let _t=0;_t<j;_t+=B){const yt=Math.min(_t+B,j),St=V.subarray(_t,yt);gt.push(String.fromCharCode.apply(null,St))}return gt.join("")}function L(V){typeof V!="string"&&D("Invalid argument for stringToBytes");const j=V.length,B=new Uint8Array(j);for(let gt=0;gt<j;++gt)B[gt]=V.charCodeAt(gt)&255;return B}function st(V){if(V.length!==void 0)return V.length;if(V.byteLength!==void 0)return V.byteLength;D("Invalid argument for arrayByteLength")}function dt(V){const j=V.length;if(j===1&&V[0]instanceof Uint8Array)return V[0];let B=0;for(let yt=0;yt<j;yt++)B+=st(V[yt]);let gt=0;const _t=new Uint8Array(B);for(let yt=0;yt<j;yt++){let St=V[yt];St instanceof Uint8Array||(typeof St=="string"?St=L(St):St=new Uint8Array(St));const Pt=St.byteLength;_t.set(St,gt),gt+=Pt}return _t}function Y(V){return String.fromCharCode(V>>24&255,V>>16&255,V>>8&255,V&255)}function at(V){return Object.keys(V).length}function Z(V){const j=Object.create(null);for(const[B,gt]of V)j[B]=gt;return j}function ct(){const V=new Uint8Array(4);return V[0]=1,new Uint32Array(V.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch{return!1}}class F{static get isLittleEndian(){return R(this,"isLittleEndian",ct())}static get isEvalSupported(){return R(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return R(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}f.FeatureTest=F;const ut=[...Array(256).keys()].map(V=>V.toString(16).padStart(2,"0"));class At{static makeHexColor(j,B,gt){return`#${ut[j]}${ut[B]}${ut[gt]}`}static scaleMinMax(j,B){let gt;j[0]?(j[0]<0&&(gt=B[0],B[0]=B[1],B[1]=gt),B[0]*=j[0],B[1]*=j[0],j[3]<0&&(gt=B[2],B[2]=B[3],B[3]=gt),B[2]*=j[3],B[3]*=j[3]):(gt=B[0],B[0]=B[2],B[2]=gt,gt=B[1],B[1]=B[3],B[3]=gt,j[1]<0&&(gt=B[2],B[2]=B[3],B[3]=gt),B[2]*=j[1],B[3]*=j[1],j[2]<0&&(gt=B[0],B[0]=B[1],B[1]=gt),B[0]*=j[2],B[1]*=j[2]),B[0]+=j[4],B[1]+=j[4],B[2]+=j[5],B[3]+=j[5]}static transform(j,B){return[j[0]*B[0]+j[2]*B[1],j[1]*B[0]+j[3]*B[1],j[0]*B[2]+j[2]*B[3],j[1]*B[2]+j[3]*B[3],j[0]*B[4]+j[2]*B[5]+j[4],j[1]*B[4]+j[3]*B[5]+j[5]]}static applyTransform(j,B){const gt=j[0]*B[0]+j[1]*B[2]+B[4],_t=j[0]*B[1]+j[1]*B[3]+B[5];return[gt,_t]}static applyInverseTransform(j,B){const gt=B[0]*B[3]-B[1]*B[2],_t=(j[0]*B[3]-j[1]*B[2]+B[2]*B[5]-B[4]*B[3])/gt,yt=(-j[0]*B[1]+j[1]*B[0]+B[4]*B[1]-B[5]*B[0])/gt;return[_t,yt]}static getAxialAlignedBoundingBox(j,B){const gt=At.applyTransform(j,B),_t=At.applyTransform(j.slice(2,4),B),yt=At.applyTransform([j[0],j[3]],B),St=At.applyTransform([j[2],j[1]],B);return[Math.min(gt[0],_t[0],yt[0],St[0]),Math.min(gt[1],_t[1],yt[1],St[1]),Math.max(gt[0],_t[0],yt[0],St[0]),Math.max(gt[1],_t[1],yt[1],St[1])]}static inverseTransform(j){const B=j[0]*j[3]-j[1]*j[2];return[j[3]/B,-j[1]/B,-j[2]/B,j[0]/B,(j[2]*j[5]-j[4]*j[3])/B,(j[4]*j[1]-j[5]*j[0])/B]}static apply3dTransform(j,B){return[j[0]*B[0]+j[1]*B[1]+j[2]*B[2],j[3]*B[0]+j[4]*B[1]+j[5]*B[2],j[6]*B[0]+j[7]*B[1]+j[8]*B[2]]}static singularValueDecompose2dScale(j){const B=[j[0],j[2],j[1],j[3]],gt=j[0]*B[0]+j[1]*B[2],_t=j[0]*B[1]+j[1]*B[3],yt=j[2]*B[0]+j[3]*B[2],St=j[2]*B[1]+j[3]*B[3],Pt=(gt+St)/2,Dt=Math.sqrt((gt+St)**2-4*(gt*St-yt*_t))/2,kt=Pt+Dt||1,Ct=Pt-Dt||1;return[Math.sqrt(kt),Math.sqrt(Ct)]}static normalizeRect(j){const B=j.slice(0);return j[0]>j[2]&&(B[0]=j[2],B[2]=j[0]),j[1]>j[3]&&(B[1]=j[3],B[3]=j[1]),B}static intersect(j,B){const gt=Math.max(Math.min(j[0],j[2]),Math.min(B[0],B[2])),_t=Math.min(Math.max(j[0],j[2]),Math.max(B[0],B[2]));if(gt>_t)return null;const yt=Math.max(Math.min(j[1],j[3]),Math.min(B[1],B[3])),St=Math.min(Math.max(j[1],j[3]),Math.max(B[1],B[3]));return yt>St?null:[gt,yt,_t,St]}static bezierBoundingBox(j,B,gt,_t,yt,St,Pt,Dt){const kt=[],Ct=[[],[]];let Lt,It,jt,wt,Nt,Wt,zt,Vt;for(let $t=0;$t<2;++$t){if($t===0?(It=6*j-12*gt+6*yt,Lt=-3*j+9*gt-9*yt+3*Pt,jt=3*gt-3*j):(It=6*B-12*_t+6*St,Lt=-3*B+9*_t-9*St+3*Dt,jt=3*_t-3*B),Math.abs(Lt)<1e-12){if(Math.abs(It)<1e-12)continue;wt=-jt/It,0<wt&&wt<1&&kt.push(wt);continue}zt=It*It-4*jt*Lt,Vt=Math.sqrt(zt),!(zt<0)&&(Nt=(-It+Vt)/(2*Lt),0<Nt&&Nt<1&&kt.push(Nt),Wt=(-It-Vt)/(2*Lt),0<Wt&&Wt<1&&kt.push(Wt))}let Ht=kt.length,Ut;const qt=Ht;for(;Ht--;)wt=kt[Ht],Ut=1-wt,Ct[0][Ht]=Ut*Ut*Ut*j+3*Ut*Ut*wt*gt+3*Ut*wt*wt*yt+wt*wt*wt*Pt,Ct[1][Ht]=Ut*Ut*Ut*B+3*Ut*Ut*wt*_t+3*Ut*wt*wt*St+wt*wt*wt*Dt;return Ct[0][qt]=j,Ct[1][qt]=B,Ct[0][qt+1]=Pt,Ct[1][qt+1]=Dt,Ct[0].length=Ct[1].length=qt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}f.Util=At;const vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Et(V){if(V[0]>="ï"){let B;if(V[0]==="þ"&&V[1]==="ÿ"?B="utf-16be":V[0]==="ÿ"&&V[1]==="þ"?B="utf-16le":V[0]==="ï"&&V[1]==="»"&&V[2]==="¿"&&(B="utf-8"),B)try{const gt=new TextDecoder(B,{fatal:!0}),_t=L(V);return gt.decode(_t)}catch(gt){bt(`stringToPDFString: "${gt}".`)}}const j=[];for(let B=0,gt=V.length;B<gt;B++){const _t=vt[V.charCodeAt(B)];j.push(_t?String.fromCharCode(_t):V.charAt(B))}return j.join("")}function Tt(V){return V.replace(/([()\\\n\r])/g,j=>j===`
`?"\\n":j==="\r"?"\\r":`\\${j}`)}function Rt(V){return/^[\x00-\x7F]*$/.test(V)}function Ft(V){const j=["þÿ"];for(let B=0,gt=V.length;B<gt;B++){const _t=V.charCodeAt(B);j.push(String.fromCharCode(_t>>8&255),String.fromCharCode(_t&255))}return j.join("")}function Xt(V){return decodeURIComponent(escape(V))}function xt(V){return unescape(encodeURIComponent(V))}function Ot(V){return typeof V=="object"&&V!==null&&V.byteLength!==void 0}function Zt(V,j){if(V.length!==j.length)return!1;for(let B=0,gt=V.length;B<gt;B++)if(V[B]!==j[B])return!1;return!0}function it(V=new Date){return[V.getUTCFullYear().toString(),(V.getUTCMonth()+1).toString().padStart(2,"0"),V.getUTCDate().toString().padStart(2,"0"),V.getUTCHours().toString().padStart(2,"0"),V.getUTCMinutes().toString().padStart(2,"0"),V.getUTCSeconds().toString().padStart(2,"0")].join("")}function pt(){const V=Object.create(null);let j=!1;return Object.defineProperty(V,"settled",{get(){return j}}),V.promise=new Promise(function(B,gt){V.resolve=function(_t){j=!0,B(_t)},V.reject=function(_t){j=!0,gt(_t)}}),V}},(ot,f,Q)=>{Q(3)},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.isNodeJS=void 0;const Q=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");f.isNodeJS=Q},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ot,Q,S,y,J,X,tt,N,_,oe,O,C;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:l,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:s}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=l,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=s}let createPDFNetworkStream;function setPDFNetworkStreamFactory(l){createPDFNetworkStream=l}function getDocument(l){const t=new PDFDocumentLoadingTask;let s;if(typeof l=="string"||l instanceof URL)s={url:l};else if((0,_util.isArrayBuffer)(l))s={data:l};else if(l instanceof PDFDataRangeTransport)s={range:l};else{if(typeof l!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!l.url&&!l.data&&!l.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=l}const r=Object.create(null);let g=null,m=null;for(const e in s){const n=s[e];switch(e){case"url":if(typeof window<"u")try{r[e]=new URL(n,window.location).href;continue}catch(d){(0,_util.warn)(`Cannot create valid URL: "${d}".`)}else if(typeof n=="string"||n instanceof URL){r[e]=n.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":g=n;continue;case"worker":m=n;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&n instanceof Buffer)r[e]=new Uint8Array(n);else{if(n instanceof Uint8Array)break;if(typeof n=="string")r[e]=(0,_util.stringToBytes)(n);else if(typeof n=="object"&&n!==null&&!isNaN(n.length))r[e]=new Uint8Array(n);else if((0,_util.isArrayBuffer)(n))r[e]=new Uint8Array(n);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}r[e]=n}if(r.CMapReaderFactory=r.CMapReaderFactory||DefaultCMapReaderFactory,r.StandardFontDataFactory=r.StandardFontDataFactory||DefaultStandardFontDataFactory,r.ignoreErrors=r.stopAtErrors!==!0,r.fontExtraProperties=r.fontExtraProperties===!0,r.pdfBug=r.pdfBug===!0,r.enableXfa=r.enableXfa===!0,(!Number.isInteger(r.rangeChunkSize)||r.rangeChunkSize<1)&&(r.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof r.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(r.docBaseUrl))&&(r.docBaseUrl=null),(!Number.isInteger(r.maxImageSize)||r.maxImageSize<-1)&&(r.maxImageSize=-1),typeof r.cMapUrl!="string"&&(r.cMapUrl=null),typeof r.standardFontDataUrl!="string"&&(r.standardFontDataUrl=null),typeof r.useWorkerFetch!="boolean"&&(r.useWorkerFetch=r.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&r.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof r.isEvalSupported!="boolean"&&(r.isEvalSupported=!0),typeof r.disableFontFace!="boolean"&&(r.disableFontFace=_is_node.isNodeJS),typeof r.useSystemFonts!="boolean"&&(r.useSystemFonts=!_is_node.isNodeJS&&!r.disableFontFace),(typeof r.ownerDocument!="object"||r.ownerDocument===null)&&(r.ownerDocument=globalThis.document),typeof r.disableRange!="boolean"&&(r.disableRange=!1),typeof r.disableStream!="boolean"&&(r.disableStream=!1),typeof r.disableAutoFetch!="boolean"&&(r.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(r.verbosity),!m){const e={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};m=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=m}const a=t.docId;return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(m,r,g,a),n=new Promise(function(d){let T;g?T=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,contentDispositionFilename:r.contentDispositionFilename,disableRange:r.disableRange,disableStream:r.disableStream},g):r.data||(T=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream})),d(T)});return Promise.all([e,n]).then(function([d,T]){if(t.destroyed)throw new Error("Loading aborted");const b=new _message_handler.MessageHandler(a,d,m.port),u=new WorkerTransport(b,t,T,r);t._transport=u,b.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(l,t,s,r){if(l.destroyed)throw new Error("Worker was destroyed");s&&(t.length=s.length,t.initialData=s.initialData,t.progressiveDone=s.progressiveDone,t.contentDispositionFilename=s.contentDispositionFilename);const g=await l.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),l.destroyed)throw new Error("Worker was destroyed");return g}const f=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ae(f,ot)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=f;ot=new WeakMap,rt(PDFDocumentLoadingTask,ot,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,s,r=!1,g=null){this.length=t,this.initialData=s,this.progressiveDone=r,this.contentDispositionFilename=g,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const r of this._rangeListeners)r(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,s){this._pdfInfo=t,this._transport=s,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,s,r,g,m=!1){this._pageIndex=t,this._pageInfo=s,this._ownerDocument=g,this._transport=r,this._stats=m?new _display_utils.StatTimer:null,this._pdfBug=m,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:r=0,offsetY:g=0,dontFlip:m=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:s,offsetX:r,offsetY:g,dontFlip:m})}getAnnotations({intent:t="display"}={}){const s=this._transport.getRenderingIntent(t);let r=this._annotationPromises.get(s.cacheKey);return r||(r=this._transport.getAnnotations(this._pageIndex,s.renderingIntent),this._annotationPromises.set(s.cacheKey,r),r=r.then(g=>{for(const m of g)m.titleObj!==void 0&&Object.defineProperty(m,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),m.titleObj.str}}),m.contentsObj!==void 0&&Object.defineProperty(m,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),m.contentsObj.str}});return g})),r}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:s,intent:r="display",annotationMode:g=_util.AnnotationMode.ENABLE,transform:m=null,imageLayer:a=null,canvasFactory:e=null,background:n=null,optionalContentConfigPromise:d=null,annotationCanvasMap:T=null,pageColors:b=null,printAnnotationStorage:u=null}){var H,et;((H=arguments[0])==null?void 0:H.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_FORMS)),((et=arguments[0])==null?void 0:et.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const x=this._transport.getRenderingIntent(r,g,u);this.pendingCleanup=!1,d||(d=this._transport.getOptionalContentConfig());let K=this._intentStates.get(x.cacheKey);K||(K=Object.create(null),this._intentStates.set(x.cacheKey,K)),K.streamReaderCancelTimeout&&(clearTimeout(K.streamReaderCancelTimeout),K.streamReaderCancelTimeout=null);const nt=e||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),$=!!(x.renderingIntent&_util.RenderingIntentFlag.PRINT);K.displayReadyCapability||(K.displayReadyCapability=(0,_util.createPromiseCapability)(),K.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(x));const z=lt=>{K.renderTasks.delete(U),(this.cleanupAfterRender||$)&&(this.pendingCleanup=!0),this._tryCleanup(),lt?(U.capability.reject(lt),this._abortOperatorList({intentState:K,reason:lt instanceof Error?lt:new Error(lt)})):U.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},U=new InternalRenderTask({callback:z,params:{canvasContext:t,viewport:s,transform:m,imageLayer:a,background:n},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:T,operatorList:K.operatorList,pageIndex:this._pageIndex,canvasFactory:nt,useRequestAnimationFrame:!$,pdfBug:this._pdfBug,pageColors:b});(K.renderTasks||(K.renderTasks=new Set)).add(U);const W=U.task;return Promise.all([K.displayReadyCapability.promise,d]).then(([lt,bt])=>{if(this.pendingCleanup){z();return}this._stats&&this._stats.time("Rendering"),U.initializeGraphics({transparency:lt,optionalContentConfig:bt}),U.operatorListChanged()}).catch(z),W}getOperatorList({intent:t="display",annotationMode:s=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){function g(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(e))}const m=this._transport.getRenderingIntent(t,s,r,!0);let a=this._intentStates.get(m.cacheKey);a||(a=Object.create(null),this._intentStates.set(m.cacheKey,a));let e;return a.opListReadCapability||(e=Object.create(null),e.operatorListChanged=g,a.opListReadCapability=(0,_util.createPromiseCapability)(),(a.renderTasks||(a.renderTasks=new Set)).add(e),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(m)),a.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:s===!0},{highWaterMark:100,size(g){return g.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const s=this.streamTextContent(t);return new Promise(function(r,g){function m(){a.read().then(function({value:n,done:d}){if(d){r(e);return}Object.assign(e.styles,n.styles),e.items.push(...n.items),m()},g)}const a=s.getReader(),e={items:[],styles:Object.create(null)};m()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const r of s.renderTasks)t.push(r.completed),r.cancel();this.objs.clear();for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:r}of this._intentStates.values())if(s.size>0||!r.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,s){const r=this._intentStates.get(s);r&&(this._stats&&this._stats.timeEnd("Page Request"),r.displayReadyCapability&&r.displayReadyCapability.resolve(t))}_renderPageChunk(t,s){for(let r=0,g=t.length;r<g;r++)s.operatorList.fnArray.push(t.fnArray[r]),s.operatorList.argsArray.push(t.argsArray[r]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const r of s.renderTasks)r.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageMap:r}){const m=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:r}).getReader(),a=this._intentStates.get(s);a.streamReader=m;const e=()=>{m.read().then(({value:n,done:d})=>{if(d){a.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,a),e())},n=>{if(a.streamReader=null,!this._transport.destroyed){if(a.operatorList){a.operatorList.lastChunk=!0;for(const d of a.renderTasks)d.operatorListChanged();this._tryCleanup()}if(a.displayReadyCapability)a.displayReadyCapability.reject(n);else if(a.opListReadCapability)a.opListReadCapability.reject(n);else throw n}})};e()}_abortOperatorList({intentState:t,reason:s,force:r=!1}){if(t.streamReader){if(!r){if(t.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:s,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[g,m]of this._intentStates)if(m===t){this._intentStates.delete(g);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,s){const r={data:structuredClone(t,s)};this._deferred.then(()=>{for(const g of this._listeners)g.call(this,r)})}addEventListener(t,s){this._listeners.push(s)}removeEventListener(t,s){const r=this._listeners.indexOf(s);this._listeners.splice(r,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const l=(Q=document==null?void 0:document.currentScript)==null?void 0:Q.src;l&&(PDFWorkerUtil.fallbackWorkerSrc=l.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(l,t){let s;try{if(s=new URL(l),!s.origin||s.origin==="null")return!1}catch{return!1}const r=new URL(t,s);return s.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(l){const t=`importScripts("${l}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class{constructor({name:l=null,port:t=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(t&&P(_PDFWorker,S).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=l,this.destroyed=!1,this.verbosity=s,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){P(_PDFWorker,S).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(l){this._port=l,this._messageHandler=new _message_handler.MessageHandler("main","worker",l),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:l}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,l)||(l=PDFWorkerUtil.createCDNWrapper(new URL(l,window.location).href));const t=new Worker(l),s=new _message_handler.MessageHandler("main","worker",t),r=()=>{t.removeEventListener("error",g),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},g=()=>{this._webWorker||r()};t.addEventListener("error",g),s.on("test",a=>{if(t.removeEventListener("error",g),this.destroyed){r();return}a?(this._messageHandler=s,this._port=t,this._webWorker=t,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),s.destroy(),t.terminate())}),s.on("ready",a=>{if(t.removeEventListener("error",g),this.destroyed){r();return}try{m()}catch{this._setupFakeWorker()}});const m=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};m();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(l=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const s=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(s+"_worker",s,t);l.setup(r,t);const g=new _message_handler.MessageHandler(s,s+"_worker",t);this._messageHandler=g,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})}).catch(l=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${l.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),P(_PDFWorker,S).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(l){if(!(l!=null&&l.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return P(this,S).has(l.port)?P(this,S).get(l.port):new _PDFWorker(l)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var l;try{return((l=globalThis.pdfjsWorker)==null?void 0:l.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;S=new WeakMap,rt(PDFWorker,S,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,s,r,g){rt(this,y,null);rt(this,J,new Map);rt(this,X,new Map);rt(this,tt,null);this.messageHandler=t,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:g.ownerDocument,styleElement:g.styleElement}),this._params=g,g.useWorkerFetch||(this.CMapReaderFactory=new g.CMapReaderFactory({baseUrl:g.cMapUrl,isCompressed:g.cMapPacked}),this.StandardFontDataFactory=new g.StandardFontDataFactory({baseUrl:g.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return P(this,y)}getRenderingIntent(t,s=_util.AnnotationMode.ENABLE,r=null,g=!1){let m=_util.RenderingIntentFlag.DISPLAY,a=null;switch(t){case"any":m=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":m=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(s){case _util.AnnotationMode.DISABLE:m+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:m+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:m+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,a=(m&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${s}`)}return g&&(m+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:m,cacheKey:`${m}_${_annotation_storage.AnnotationStorage.getHash(a)}`,annotationStorageMap:a}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of P(this,J).values())t.push(r._destroy());P(this,J).clear(),P(this,X).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return t.push(s),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),mt(this,tt,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=m=>{this._lastProgress={loaded:m.loaded,total:m.total}},g.onPull=()=>{this._fullReader.read().then(function({value:m,done:a}){if(a){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(m),"GetReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(m),1,[m])}).catch(m=>{g.error(m)})},g.onCancel=m=>{this._fullReader.cancel(m),g.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",r=>{const g=(0,_util.createPromiseCapability)(),m=this._fullReader;return m.headersReady.then(()=>{var a;(!m.isStreamingSupported||!m.isRangeSupported)&&(this._lastProgress&&((a=s.onProgress)==null||a.call(s,this._lastProgress)),m.onProgress=e=>{var n;(n=s.onProgress)==null||n.call(s,{loaded:e.loaded,total:e.total})}),g.resolve({isStreamingSupported:m.isStreamingSupported,isRangeSupported:m.isRangeSupported,contentLength:m.contentLength})},g.reject),g.promise}),t.on("GetRangeReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const m=this._networkStream.getRangeReader(r.begin,r.end);if(!m){g.close();return}g.onPull=()=>{m.read().then(function({value:a,done:e}){if(e){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetRangeReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{g.error(a)})},g.onCancel=a=>{m.cancel(a),g.ready.catch(e=>{if(!this.destroyed)throw e})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,s._capability.resolve(new PDFDocumentProxy(r,this))}),t.on("DocException",function(r){let g;switch(r.name){case"PasswordException":g=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":g=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":g=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":g=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":g=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}s._capability.reject(g)}),t.on("PasswordRequest",r=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const g=m=>{m instanceof Error?this._passwordCapability.reject(m):this._passwordCapability.resolve({password:m})};try{s.onPassword(g,r.code)}catch(m){this._passwordCapability.reject(m)}}else this._passwordCapability.reject(new _util.PasswordException(r.message,r.code));return this._passwordCapability.promise}),t.on("DataLoaded",r=>{var g;(g=s.onProgress)==null||g.call(s,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;P(this,J).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,g,m])=>{var a;if(!this.destroyed&&!this.commonObjs.has(r))switch(g){case"Font":const e=this._params;if("error"in m){const T=m.error;(0,_util.warn)(`Error during font loading: ${T}`),this.commonObjs.resolve(r,T);break}let n=null;e.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)&&(n={registerFont(T,b){globalThis.FontInspector.fontAdded(T,b)}});const d=new _font_loader.FontFaceObject(m,{isEvalSupported:e.isEvalSupported,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:n});this.fontLoader.bind(d).catch(T=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!e.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(r,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(r,m);break;default:throw new Error(`Got unknown common object type ${g}`)}}),t.on("obj",([r,g,m,a])=>{var n;if(this.destroyed)return;const e=P(this,J).get(g);if(!e.objs.has(r))switch(m){case"Image":e.objs.resolve(r,a);const d=8e6;if(a){let T;if(a.bitmap){const{bitmap:b,width:u,height:x}=a;T=u*x*4,e._bitmaps.add(b)}else T=((n=a.data)==null?void 0:n.length)||0;T>d&&(e.cleanupAfterRender=!0)}break;case"Pattern":e.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${m}`)}}),t.on("DocProgress",r=>{var g;this.destroyed||(g=s.onProgress)==null||g.call(s,{loaded:r.loaded,total:r.total})}),t.on("DocStats",r=>{this.destroyed||mt(this,y,Object.freeze({streamTypes:Object.freeze(r.streamTypes),fontTypes:Object.freeze(r.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var s,r;this.destroyed||(r=(s=this.loadingTask).onUnsupportedFeature)==null||r.call(s,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,r=P(this,X).get(s);if(r)return r;const g=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(m=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(s,m,this,this._params.ownerDocument,this._params.pdfBug);return P(this,J).set(s,a),a});return P(this,X).set(s,g),g}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}saveDocument(){var t;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((t=this._fullReader)==null?void 0:t.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return P(this,tt)||mt(this,tt,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var s,r;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const s of P(this,J).values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),mt(this,tt,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}y=new WeakMap,J=new WeakMap,X=new WeakMap,tt=new WeakMap;class PDFObjects{constructor(){rt(this,_);rt(this,N,Object.create(null))}get(t,s=null){if(s){const g=ht(this,_,oe).call(this,t);return g.capability.promise.then(()=>s(g.data)),null}const r=P(this,N)[t];if(!(r!=null&&r.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const s=P(this,N)[t];return(s==null?void 0:s.capability.settled)||!1}resolve(t,s=null){const r=ht(this,_,oe).call(this,t);r.data=s,r.capability.resolve()}clear(){mt(this,N,Object.create(null))}}N=new WeakMap,_=new WeakSet,oe=function(t){const s=P(this,N)[t];return s||(P(this,N)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){rt(this,O,null);mt(this,O,t),this.onContinue=null}get promise(){return P(this,O).capability.promise}cancel(){P(this,O).cancel()}get separateAnnots(){const{separateAnnots:t}=P(this,O).operatorList;if(!t)return!1;const{annotationCanvasMap:s}=P(this,O);return t.form||t.canvas&&(s==null?void 0:s.size)>0}}O=new WeakMap,exports.RenderTask=RenderTask;const v=class{constructor({callback:t,params:s,objs:r,commonObjs:g,annotationCanvasMap:m,operatorList:a,pageIndex:e,canvasFactory:n,useRequestAnimationFrame:d=!1,pdfBug:T=!1,pageColors:b=null}){this.callback=t,this.params=s,this.objs=r,this.commonObjs=g,this.annotationCanvasMap=m,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=e,this.canvasFactory=n,this._pdfBug=T,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){var n;if(this.cancelled)return;if(this._canvas){if(P(v,C).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");P(v,C).add(this._canvas)}this._pdfBug&&((n=globalThis.StepperManager)!=null&&n.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:g,transform:m,imageLayer:a,background:e}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,a,s,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:m,viewport:g,transparency:t,background:e}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&P(v,C).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&P(v,C).delete(this._canvas),this.callback())))}};let InternalRenderTask=v;C=new WeakMap,rt(InternalRenderTask,C,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(ot,f,Q)=>{var N,Ce,k;Object.defineProperty(f,"__esModule",{value:!0}),f.PrintAnnotationStorage=f.AnnotationStorage=void 0;var S=Q(1),y=Q(6),J=Q(10);class X{constructor(){rt(this,N);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(C,v){const l=this._storage.get(C);return l===void 0?v:Object.assign(v,l)}getRawValue(C){return this._storage.get(C)}remove(C){if(this._storage.delete(C),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const v of this._storage.values())if(v instanceof y.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(C,v){const l=this._storage.get(C);let t=!1;if(l!==void 0)for(const[s,r]of Object.entries(v))l[s]!==r&&(t=!0,l[s]=r);else t=!0,this._storage.set(C,v);t&&ht(this,N,Ce).call(this),v instanceof y.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(v.constructor._type)}has(C){return this._storage.has(C)}getAll(){return this._storage.size>0?(0,S.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new tt(this)}get serializable(){if(this._storage.size===0)return null;const C=new Map;for(const[v,l]of this._storage){const t=l instanceof y.AnnotationEditor?l.serialize():l;t&&C.set(v,t)}return C}static getHash(C){if(!C)return"";const v=new J.MurmurHash3_64;for(const[l,t]of C)v.update(`${l}:${JSON.stringify(t)}`);return v.hexdigest()}}N=new WeakSet,Ce=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},f.AnnotationStorage=X;class tt extends X{constructor(v){super();rt(this,k,null);mt(this,k,structuredClone(v.serializable))}get print(){(0,S.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return P(this,k)}}k=new WeakMap,f.PrintAnnotationStorage=tt},(ot,f,Q)=>{var X,tt,N,_,k,O;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationEditor=void 0;var S=Q(7),y=Q(1);const C=class{constructor(l){rt(this,X,this.focusin.bind(this));rt(this,tt,this.focusout.bind(this));rt(this,N,!1);rt(this,_,!1);rt(this,k,!1);rt(this,O,C._zIndex++);this.constructor===C&&(0,y.unreachable)("Cannot initialize AnnotationEditor."),this.parent=l.parent,this.id=l.id,this.width=this.height=null,this.pageIndex=l.parent.pageIndex,this.name=l.name,this.div=null;const[t,s]=this.parent.viewportBaseDimensions;this.x=l.x/t,this.y=l.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,y.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=P(this,O)}focusin(l){P(this,N)?mt(this,N,!1):this.parent.setSelected(this)}focusout(l){if(!this.isAttachedToDOM)return;const t=l.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(l.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(l){const t=this.parent.div.getBoundingClientRect();this.startX=l.clientX-t.x,this.startY=l.clientY-t.y,l.dataTransfer.setData("text/plain",this.id),l.dataTransfer.effectAllowed="move"}setAt(l,t,s,r){const[g,m]=this.parent.viewportBaseDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(l+s)/g,this.y=(t+r)/m,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(l,t){const[s,r]=this.parent.viewportBaseDimensions;[l,t]=this.screenToPageTranslation(l,t),this.x+=l/s,this.y+=t/r,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(l,t){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[t,-l];case 180:return[-l,-t];case 270:return[-t,l];default:return[l,t]}}setDims(l,t){const[s,r]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*l/s}%`,this.div.style.height=`${100*t/r}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",P(this,X)),this.div.addEventListener("focusout",P(this,tt));const[l,t]=this.getInitialTranslation();return this.translate(l,t),(0,S.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(l){const t=S.KeyboardManager.platform.isMac;if(l.button!==0||l.ctrlKey&&t){l.preventDefault();return}l.ctrlKey&&!t||l.shiftKey||l.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),mt(this,N,!0)}getRect(l,t){const[s,r]=this.parent.viewportBaseDimensions,[g,m]=this.parent.pageDimensions,a=g*l/s,e=m*t/r,n=this.x*g,d=this.y*m,T=this.width*g,b=this.height*m;switch(this.rotation){case 0:return[n+a,m-d-e-b,n+a+T,m-d-e];case 90:return[n+e,m-d+a,n+e+b,m-d+a+T];case 180:return[n-a-T,m-d+e,n-a,m-d+e+b];case 270:return[n-e-b,m-d-a-T,n-e,m-d-a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(l,t){const[s,r,g,m]=l,a=g-s,e=m-r;switch(this.rotation){case 0:return[s,t-m,a,e];case 90:return[s,t-r,e,a];case 180:return[g,t-r,a,e];case 270:return[g,t-m,e,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){mt(this,k,!0)}disableEditMode(){mt(this,k,!1)}isInEditMode(){return P(this,k)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var l;(l=this.div)==null||l.addEventListener("focusin",P(this,X))}serialize(){(0,y.unreachable)("An editor must be serializable")}static deserialize(l,t){const s=new this.prototype.constructor({parent:t,id:t.getNextId()});s.rotation=l.rotation;const[r,g]=t.pageDimensions,[m,a,e,n]=s.getRectInCurrentCoords(l.rect,g);return s.x=m/r,s.y=a/g,s.width=e/r,s.height=n/g,s}remove(){this.div.removeEventListener("focusin",P(this,X)),this.div.removeEventListener("focusout",P(this,tt)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var l;(l=this.div)==null||l.classList.add("selectedEditor")}unselect(){var l;(l=this.div)==null||l.classList.remove("selectedEditor")}updateParams(l,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return P(this,_)}set isEditing(l){mt(this,_,l),l?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let J=C;X=new WeakMap,tt=new WeakMap,N=new WeakMap,_=new WeakMap,k=new WeakMap,O=new WeakMap,Mt(J,"_colorManager",new S.ColorManager),Mt(J,"_zIndex",1),f.AnnotationEditor=J},(ot,f,Q)=>{var v,l,t,s,r,g,Te,e,d,T,b,u,x,K,nt,$,z,U,W,H,et,lt,bt,D,c,o,xe,R,le,I,Bt,q,Jt,h,Pe,A,we,L,ce,dt,Qt,at,te;Object.defineProperty(f,"__esModule",{value:!0}),f.KeyboardManager=f.CommandManager=f.ColorManager=f.AnnotationEditorUIManager=void 0,f.bindEvents=J,f.opacityToHex=X;var S=Q(1),y=Q(8);function J(ft,F,ut){for(const At of ut)F.addEventListener(At,ft[At].bind(ft))}function X(ft){return Math.round(Math.min(255,Math.max(1,255*ft))).toString(16).padStart(2,"0")}class tt{constructor(){rt(this,v,0)}getId(){return`${S.AnnotationEditorPrefix}${ae(this,v)._++}`}}v=new WeakMap;class N{constructor(F=128){rt(this,l,[]);rt(this,t,!1);rt(this,s,void 0);rt(this,r,-1);mt(this,s,F)}add({cmd:F,undo:ut,mustExec:At,type:vt=NaN,overwriteIfSameType:Et=!1,keepUndo:Tt=!1}){if(At&&F(),P(this,t))return;const Rt={cmd:F,undo:ut,type:vt};if(P(this,r)===-1){P(this,l).length>0&&(P(this,l).length=0),mt(this,r,0),P(this,l).push(Rt);return}if(Et&&P(this,l)[P(this,r)].type===vt){Tt&&(Rt.undo=P(this,l)[P(this,r)].undo),P(this,l)[P(this,r)]=Rt;return}const Ft=P(this,r)+1;Ft===P(this,s)?P(this,l).splice(0,1):(mt(this,r,Ft),Ft<P(this,l).length&&P(this,l).splice(Ft)),P(this,l).push(Rt)}undo(){P(this,r)!==-1&&(mt(this,t,!0),P(this,l)[P(this,r)].undo(),mt(this,t,!1),mt(this,r,P(this,r)-1))}redo(){P(this,r)<P(this,l).length-1&&(mt(this,r,P(this,r)+1),mt(this,t,!0),P(this,l)[P(this,r)].cmd(),mt(this,t,!1))}hasSomethingToUndo(){return P(this,r)!==-1}hasSomethingToRedo(){return P(this,r)<P(this,l).length-1}destroy(){mt(this,l,null)}}l=new WeakMap,t=new WeakMap,s=new WeakMap,r=new WeakMap,f.CommandManager=N;const a=class{constructor(F){rt(this,g);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ut=a.platform.isMac;for(const[At,vt]of F)for(const Et of At){const Tt=Et.startsWith("mac+");ut&&Tt?(this.callbacks.set(Et.slice(4),vt),this.allKeys.add(Et.split("+").at(-1))):!ut&&!Tt&&(this.callbacks.set(Et,vt),this.allKeys.add(Et.split("+").at(-1)))}}static get platform(){const F=typeof navigator<"u"?navigator.platform:"";return(0,S.shadow)(this,"platform",{isWin:F.includes("Win"),isMac:F.includes("Mac")})}exec(F,ut){if(!this.allKeys.has(ut.key))return;const At=this.callbacks.get(ht(this,g,Te).call(this,ut));At&&(At.bind(F)(),ut.stopPropagation(),ut.preventDefault())}};let _=a;g=new WeakSet,Te=function(F){F.altKey&&this.buffer.push("alt"),F.ctrlKey&&this.buffer.push("ctrl"),F.metaKey&&this.buffer.push("meta"),F.shiftKey&&this.buffer.push("shift"),this.buffer.push(F.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut},f.KeyboardManager=_;class k{constructor(){rt(this,e,null)}copy(F){F&&(Array.isArray(F)?mt(this,e,F.map(ut=>ut.serialize())):mt(this,e,[F.serialize()]),mt(this,e,P(this,e).filter(ut=>!!ut)),P(this,e).length===0&&mt(this,e,null))}paste(){return P(this,e)}isEmpty(){return P(this,e)===null}destroy(){mt(this,e,null)}}e=new WeakMap;const n=class{get _colors(){const F=new Map([["CanvasText",null],["Canvas",null]]);return(0,y.getColorValues)(F),(0,S.shadow)(this,"_colors",F)}convert(F){const ut=(0,y.getRGB)(F);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[At,vt]of this._colors)if(vt.every((Et,Tt)=>Et===ut[Tt]))return n._colorsMapping.get(At);return ut}getHexCode(F){const ut=this._colors.get(F);return ut?S.Util.makeHexColor(...ut):F}};let O=n;Mt(O,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),f.ColorManager=O;const ct=class{constructor(F,ut){rt(this,o);rt(this,R);rt(this,I);rt(this,q);rt(this,h);rt(this,A);rt(this,L);rt(this,dt);rt(this,at);rt(this,d,null);rt(this,T,new Map);rt(this,b,new Map);rt(this,u,new k);rt(this,x,new N);rt(this,K,0);rt(this,nt,null);rt(this,$,null);rt(this,z,new tt);rt(this,U,!1);rt(this,W,S.AnnotationEditorType.NONE);rt(this,H,new Set);rt(this,et,this.keydown.bind(this));rt(this,lt,this.onEditingAction.bind(this));rt(this,bt,this.onPageChanging.bind(this));rt(this,D,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,c,null);mt(this,c,F),mt(this,$,ut),P(this,$)._on("editingaction",P(this,lt)),P(this,$)._on("pagechanging",P(this,bt))}destroy(){ht(this,R,le).call(this),P(this,$)._off("editingaction",P(this,lt)),P(this,$)._off("pagechanging",P(this,bt));for(const F of P(this,b).values())F.destroy();P(this,b).clear(),P(this,T).clear(),mt(this,d,null),P(this,H).clear(),P(this,u).destroy(),P(this,x).destroy()}onPageChanging({pageNumber:F}){mt(this,K,F-1)}focusMainContainer(){P(this,c).focus()}keydown(F){var ut;(ut=this.getActive())!=null&&ut.shouldGetKeyboardEvents()||ct._keyboardManager.exec(this,F)}onEditingAction(F){["undo","redo","cut","copy","paste","delete","selectAll"].includes(F.name)&&this[F.name]()}setEditingState(F){F?(ht(this,o,xe).call(this),ht(this,I,Bt).call(this,{isEditing:P(this,W)!==S.AnnotationEditorType.NONE,isEmpty:ht(this,dt,Qt).call(this),hasSomethingToUndo:P(this,x).hasSomethingToUndo(),hasSomethingToRedo:P(this,x).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:P(this,u).isEmpty()})):(ht(this,R,le).call(this),ht(this,I,Bt).call(this,{isEditing:!1}))}registerEditorTypes(F){mt(this,nt,F);for(const ut of P(this,nt))ht(this,q,Jt).call(this,ut.defaultPropertiesToUpdate)}getId(){return P(this,z).getId()}addLayer(F){P(this,b).set(F.pageIndex,F),P(this,U)?F.enable():F.disable()}removeLayer(F){P(this,b).delete(F.pageIndex)}updateMode(F){if(mt(this,W,F),F===S.AnnotationEditorType.NONE)this.setEditingState(!1),ht(this,A,we).call(this);else{this.setEditingState(!0),ht(this,h,Pe).call(this);for(const ut of P(this,b).values())ut.updateMode(F)}}updateToolbar(F){F!==P(this,W)&&P(this,$).dispatch("switchannotationeditormode",{source:this,mode:F})}updateParams(F,ut){for(const At of P(this,H))At.updateParams(F,ut);for(const At of P(this,nt))At.updateDefaultParams(F,ut)}getEditors(F){const ut=[];for(const At of P(this,T).values())At.pageIndex===F&&ut.push(At);return ut}getEditor(F){return P(this,T).get(F)}addEditor(F){P(this,T).set(F.id,F)}removeEditor(F){P(this,T).delete(F.id),this.unselect(F)}setActiveEditor(F){P(this,d)!==F&&(mt(this,d,F),F&&ht(this,q,Jt).call(this,F.propertiesToUpdate))}toggleSelected(F){if(P(this,H).has(F)){P(this,H).delete(F),F.unselect(),ht(this,I,Bt).call(this,{hasSelectedEditor:this.hasSelection});return}P(this,H).add(F),F.select(),ht(this,q,Jt).call(this,F.propertiesToUpdate),ht(this,I,Bt).call(this,{hasSelectedEditor:!0})}setSelected(F){for(const ut of P(this,H))ut!==F&&ut.unselect();P(this,H).clear(),P(this,H).add(F),F.select(),ht(this,q,Jt).call(this,F.propertiesToUpdate),ht(this,I,Bt).call(this,{hasSelectedEditor:!0})}isSelected(F){return P(this,H).has(F)}unselect(F){F.unselect(),P(this,H).delete(F),ht(this,I,Bt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return P(this,H).size!==0}undo(){P(this,x).undo(),ht(this,I,Bt).call(this,{hasSomethingToUndo:P(this,x).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ht(this,dt,Qt).call(this)})}redo(){P(this,x).redo(),ht(this,I,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:P(this,x).hasSomethingToRedo(),isEmpty:ht(this,dt,Qt).call(this)})}addCommands(F){P(this,x).add(F),ht(this,I,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ht(this,dt,Qt).call(this)})}delete(){if(P(this,d)&&P(this,d).commitOrRemove(),!this.hasSelection)return;const F=[...P(this,H)],ut=()=>{for(const vt of F)vt.remove()},At=()=>{for(const vt of F)ht(this,L,ce).call(this,vt)};this.addCommands({cmd:ut,undo:At,mustExec:!0})}copy(){if(P(this,d)&&P(this,d).commitOrRemove(),this.hasSelection){const F=[];for(const ut of P(this,H))ut.isEmpty()||F.push(ut);if(F.length===0)return;P(this,u).copy(F),ht(this,I,Bt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(P(this,u).isEmpty())return;this.unselectAll();const F=P(this,b).get(P(this,K)),ut=P(this,u).paste().map(Et=>F.deserialize(Et)),At=()=>{for(const Et of ut)ht(this,L,ce).call(this,Et);ht(this,at,te).call(this,ut)},vt=()=>{for(const Et of ut)Et.remove()};this.addCommands({cmd:At,undo:vt,mustExec:!0})}selectAll(){for(const F of P(this,H))F.commit();ht(this,at,te).call(this,P(this,T).values())}unselectAll(){if(P(this,d)){P(this,d).commitOrRemove();return}if(ht(this,at,te).size!==0){for(const F of P(this,H))F.unselect();P(this,H).clear(),ht(this,I,Bt).call(this,{hasSelectedEditor:!1})}}isActive(F){return P(this,d)===F}getActive(){return P(this,d)}getMode(){return P(this,W)}};let C=ct;d=new WeakMap,T=new WeakMap,b=new WeakMap,u=new WeakMap,x=new WeakMap,K=new WeakMap,nt=new WeakMap,$=new WeakMap,z=new WeakMap,U=new WeakMap,W=new WeakMap,H=new WeakMap,et=new WeakMap,lt=new WeakMap,bt=new WeakMap,D=new WeakMap,c=new WeakMap,o=new WeakSet,xe=function(){P(this,c).addEventListener("keydown",P(this,et))},R=new WeakSet,le=function(){P(this,c).removeEventListener("keydown",P(this,et))},I=new WeakSet,Bt=function(F){Object.entries(F).some(([At,vt])=>P(this,D)[At]!==vt)&&P(this,$).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(P(this,D),F)})},q=new WeakSet,Jt=function(F){P(this,$).dispatch("annotationeditorparamschanged",{source:this,details:F})},h=new WeakSet,Pe=function(){if(!P(this,U)){mt(this,U,!0);for(const F of P(this,b).values())F.enable()}},A=new WeakSet,we=function(){if(this.unselectAll(),P(this,U)){mt(this,U,!1);for(const F of P(this,b).values())F.disable()}},L=new WeakSet,ce=function(F){const ut=P(this,b).get(F.pageIndex);ut?ut.addOrRebuild(F):this.addEditor(F)},dt=new WeakSet,Qt=function(){if(P(this,T).size===0)return!0;if(P(this,T).size===1)for(const F of P(this,T).values())return F.isEmpty();return!1},at=new WeakSet,te=function(F){P(this,H).clear();for(const ut of F)ut.isEmpty()||(P(this,H).add(ut),ut.select());ht(this,I,Bt).call(this,{hasSelectedEditor:!0})},Mt(C,"_keyboardManager",new _([[["ctrl+a","mac+meta+a"],ct.prototype.selectAll],[["ctrl+c","mac+meta+c"],ct.prototype.copy],[["ctrl+v","mac+meta+v"],ct.prototype.paste],[["ctrl+x","mac+meta+x"],ct.prototype.cut],[["ctrl+z","mac+meta+z"],ct.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ct.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ct.prototype.delete],[["Escape","mac+Escape"],ct.prototype.unselectAll]])),f.AnnotationEditorUIManager=C},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.StatTimer=f.RenderingCancelledException=f.PixelsPerInch=f.PageViewport=f.PDFDateString=f.DOMStandardFontDataFactory=f.DOMSVGFactory=f.DOMCanvasFactory=f.DOMCMapReaderFactory=f.AnnotationPrefix=void 0,f.deprecated=n,f.getColorValues=x,f.getCurrentTransform=K,f.getCurrentTransformInverse=nt,f.getFilenameFromUrl=r,f.getPdfFilenameFromUrl=g,f.getRGB=u,f.getXfaPageViewport=b,f.isDataScheme=t,f.isPdfFile=s,f.isValidFetchUrl=a,f.loadScript=e;var S=Q(9),y=Q(1);const J="http://www.w3.org/2000/svg",X="pdfjs_internal_id_";f.AnnotationPrefix=X;const $=class{};let tt=$;Mt(tt,"CSS",96),Mt(tt,"PDF",72),Mt(tt,"PDF_TO_CSS_UNITS",$.CSS/$.PDF),f.PixelsPerInch=tt;class N extends S.BaseCanvasFactory{constructor({ownerDocument:U=globalThis.document}={}){super(),this._document=U}_createCanvas(U,W){const H=this._document.createElement("canvas");return H.width=U,H.height=W,H}}f.DOMCanvasFactory=N;async function _(z,U=!1){if(a(z,document.baseURI)){const W=await fetch(z);if(!W.ok)throw new Error(W.statusText);return U?new Uint8Array(await W.arrayBuffer()):(0,y.stringToBytes)(await W.text())}return new Promise((W,H)=>{const et=new XMLHttpRequest;et.open("GET",z,!0),U&&(et.responseType="arraybuffer"),et.onreadystatechange=()=>{if(et.readyState===XMLHttpRequest.DONE){if(et.status===200||et.status===0){let lt;if(U&&et.response?lt=new Uint8Array(et.response):!U&&et.responseText&&(lt=(0,y.stringToBytes)(et.responseText)),lt){W(lt);return}}H(new Error(et.statusText))}},et.send(null)})}class k extends S.BaseCMapReaderFactory{_fetchData(U,W){return _(U,this.isCompressed).then(H=>({cMapData:H,compressionType:W}))}}f.DOMCMapReaderFactory=k;class O extends S.BaseStandardFontDataFactory{_fetchData(U){return _(U,!0)}}f.DOMStandardFontDataFactory=O;class C extends S.BaseSVGFactory{_createSVG(U){return document.createElementNS(J,U)}}f.DOMSVGFactory=C;class v{constructor({viewBox:U,scale:W,rotation:H,offsetX:et=0,offsetY:lt=0,dontFlip:bt=!1}){this.viewBox=U,this.scale=W,this.rotation=H,this.offsetX=et,this.offsetY=lt;const D=(U[2]+U[0])/2,c=(U[3]+U[1])/2;let o,E,R,M;switch(H%=360,H<0&&(H+=360),H){case 180:o=-1,E=0,R=0,M=1;break;case 90:o=0,E=1,R=1,M=0;break;case 270:o=0,E=-1,R=-1,M=0;break;case 0:o=1,E=0,R=0,M=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}bt&&(R=-R,M=-M);let I,G,q,i;o===0?(I=Math.abs(c-U[1])*W+et,G=Math.abs(D-U[0])*W+lt,q=Math.abs(U[3]-U[1])*W,i=Math.abs(U[2]-U[0])*W):(I=Math.abs(D-U[0])*W+et,G=Math.abs(c-U[1])*W+lt,q=Math.abs(U[2]-U[0])*W,i=Math.abs(U[3]-U[1])*W),this.transform=[o*W,E*W,R*W,M*W,I-o*W*D-R*W*c,G-E*W*D-M*W*c],this.width=q,this.height=i}clone({scale:U=this.scale,rotation:W=this.rotation,offsetX:H=this.offsetX,offsetY:et=this.offsetY,dontFlip:lt=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:U,rotation:W,offsetX:H,offsetY:et,dontFlip:lt})}convertToViewportPoint(U,W){return y.Util.applyTransform([U,W],this.transform)}convertToViewportRectangle(U){const W=y.Util.applyTransform([U[0],U[1]],this.transform),H=y.Util.applyTransform([U[2],U[3]],this.transform);return[W[0],W[1],H[0],H[1]]}convertToPdfPoint(U,W){return y.Util.applyInverseTransform([U,W],this.transform)}}f.PageViewport=v;class l extends y.BaseException{constructor(U,W){super(U,"RenderingCancelledException"),this.type=W}}f.RenderingCancelledException=l;function t(z){const U=z.length;let W=0;for(;W<U&&z[W].trim()==="";)W++;return z.substring(W,W+5).toLowerCase()==="data:"}function s(z){return typeof z=="string"&&/\.pdf$/i.test(z)}function r(z){const U=z.indexOf("#"),W=z.indexOf("?"),H=Math.min(U>0?U:z.length,W>0?W:z.length);return z.substring(z.lastIndexOf("/",H)+1,H)}function g(z,U="document.pdf"){if(typeof z!="string")return U;if(t(z))return(0,y.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),U;const W=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,H=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,et=W.exec(z);let lt=H.exec(et[1])||H.exec(et[2])||H.exec(et[3]);if(lt&&(lt=lt[0],lt.includes("%")))try{lt=H.exec(decodeURIComponent(lt))[0]}catch{}return lt||U}class m{constructor(){this.started=Object.create(null),this.times=[]}time(U){U in this.started&&(0,y.warn)(`Timer is already running for ${U}`),this.started[U]=Date.now()}timeEnd(U){U in this.started||(0,y.warn)(`Timer has not been started for ${U}`),this.times.push({name:U,start:this.started[U],end:Date.now()}),delete this.started[U]}toString(){const U=[];let W=0;for(const H of this.times){const et=H.name;et.length>W&&(W=et.length)}for(const H of this.times){const et=H.end-H.start;U.push(`${H.name.padEnd(W)} ${et}ms
`)}return U.join("")}}f.StatTimer=m;function a(z,U){try{const{protocol:W}=U?new URL(z,U):new URL(z);return W==="http:"||W==="https:"}catch{return!1}}function e(z,U=!1){return new Promise((W,H)=>{const et=document.createElement("script");et.src=z,et.onload=function(lt){U&&et.remove(),W(lt)},et.onerror=function(){H(new Error(`Cannot load script at: ${et.src}`))},(document.head||document.documentElement).append(et)})}function n(z){console.log("Deprecated API usage: "+z)}let d;class T{static toDateObject(U){if(!U||typeof U!="string")return null;d||(d=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const W=d.exec(U);if(!W)return null;const H=parseInt(W[1],10);let et=parseInt(W[2],10);et=et>=1&&et<=12?et-1:0;let lt=parseInt(W[3],10);lt=lt>=1&&lt<=31?lt:1;let bt=parseInt(W[4],10);bt=bt>=0&&bt<=23?bt:0;let D=parseInt(W[5],10);D=D>=0&&D<=59?D:0;let c=parseInt(W[6],10);c=c>=0&&c<=59?c:0;const o=W[7]||"Z";let E=parseInt(W[8],10);E=E>=0&&E<=23?E:0;let R=parseInt(W[9],10)||0;return R=R>=0&&R<=59?R:0,o==="-"?(bt+=E,D+=R):o==="+"&&(bt-=E,D-=R),new Date(Date.UTC(H,et,lt,bt,D,c))}}f.PDFDateString=T;function b(z,{scale:U=1,rotation:W=0}){const{width:H,height:et}=z.attributes.style,lt=[0,0,parseInt(H),parseInt(et)];return new v({viewBox:lt,scale:U,rotation:W})}function u(z){if(z.startsWith("#")){const U=parseInt(z.slice(1),16);return[(U&16711680)>>16,(U&65280)>>8,U&255]}return z.startsWith("rgb(")?z.slice(4,-1).split(",").map(U=>parseInt(U)):z.startsWith("rgba(")?z.slice(5,-1).split(",").map(U=>parseInt(U)).slice(0,3):((0,y.warn)(`Not a valid color format: "${z}"`),[0,0,0])}function x(z){const U=document.createElement("span");U.style.visibility="hidden",document.body.append(U);for(const W of z.keys()){U.style.color=W;const H=window.getComputedStyle(U).color;z.set(W,u(H))}U.remove()}function K(z){const{a:U,b:W,c:H,d:et,e:lt,f:bt}=z.getTransform();return[U,W,H,et,lt,bt]}function nt(z){const{a:U,b:W,c:H,d:et,e:lt,f:bt}=z.getTransform().invertSelf();return[U,W,H,et,lt,bt]}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.BaseStandardFontDataFactory=f.BaseSVGFactory=f.BaseCanvasFactory=f.BaseCMapReaderFactory=void 0;var S=Q(1);class y{constructor(){this.constructor===y&&(0,S.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,k){if(_<=0||k<=0)throw new Error("Invalid canvas size");const O=this._createCanvas(_,k);return{canvas:O,context:O.getContext("2d")}}reset(_,k,O){if(!_.canvas)throw new Error("Canvas is not specified");if(k<=0||O<=0)throw new Error("Invalid canvas size");_.canvas.width=k,_.canvas.height=O}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,k){(0,S.unreachable)("Abstract method `_createCanvas` called.")}}f.BaseCanvasFactory=y;class J{constructor({baseUrl:_=null,isCompressed:k=!1}){this.constructor===J&&(0,S.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=k}async fetch({name:_}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const k=this.baseUrl+_+(this.isCompressed?".bcmap":""),O=this.isCompressed?S.CMapCompressionType.BINARY:S.CMapCompressionType.NONE;return this._fetchData(k,O).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${k}`)})}_fetchData(_,k){(0,S.unreachable)("Abstract method `_fetchData` called.")}}f.BaseCMapReaderFactory=J;class X{constructor({baseUrl:_=null}){this.constructor===X&&(0,S.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}async fetch({filename:_}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const k=`${this.baseUrl}${_}`;return this._fetchData(k).catch(O=>{throw new Error(`Unable to load font data at: ${k}`)})}_fetchData(_){(0,S.unreachable)("Abstract method `_fetchData` called.")}}f.BaseStandardFontDataFactory=X;class tt{constructor(){this.constructor===tt&&(0,S.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,k,O=!1){if(_<=0||k<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),O||(C.setAttribute("width",`${_}px`),C.setAttribute("height",`${k}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${_} ${k}`),C}createElement(_){if(typeof _!="string")throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,S.unreachable)("Abstract method `_createSVG` called.")}}f.BaseSVGFactory=tt},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.MurmurHash3_64=void 0;var S=Q(1);const y=3285377520,J=4294901760,X=65535;class tt{constructor(_){this.h1=_?_&4294967295:y,this.h2=_?_&4294967295:y}update(_){let k,O;if(typeof _=="string"){k=new Uint8Array(_.length*2),O=0;for(let d=0,T=_.length;d<T;d++){const b=_.charCodeAt(d);b<=255?k[O++]=b:(k[O++]=b>>>8,k[O++]=b&255)}}else if((0,S.isArrayBuffer)(_))k=_.slice(),O=k.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const C=O>>2,v=O-C*4,l=new Uint32Array(k.buffer,0,C);let t=0,s=0,r=this.h1,g=this.h2;const m=3432918353,a=461845907,e=m&X,n=a&X;for(let d=0;d<C;d++)d&1?(t=l[d],t=t*m&J|t*e&X,t=t<<15|t>>>17,t=t*a&J|t*n&X,r^=t,r=r<<13|r>>>19,r=r*5+3864292196):(s=l[d],s=s*m&J|s*e&X,s=s<<15|s>>>17,s=s*a&J|s*n&X,g^=s,g=g<<13|g>>>19,g=g*5+3864292196);switch(t=0,v){case 3:t^=k[C*4+2]<<16;case 2:t^=k[C*4+1]<<8;case 1:t^=k[C*4],t=t*m&J|t*e&X,t=t<<15|t>>>17,t=t*a&J|t*n&X,C&1?r^=t:g^=t}this.h1=r,this.h2=g}hexdigest(){let _=this.h1,k=this.h2;_^=k>>>1,_=_*3981806797&J|_*36045&X,k=k*4283543511&J|((k<<16|_>>>16)*2950163797&J)>>>16,_^=k>>>1,_=_*444984403&J|_*60499&X,k=k*3301882366&J|((k<<16|_>>>16)*3120437893&J)>>>16,_^=k>>>1;const O=(_>>>0).toString(16),C=(k>>>0).toString(16);return O.padStart(8,"0")+C.padStart(8,"0")}}f.MurmurHash3_64=tt},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.FontLoader=f.FontFaceObject=void 0;var S=Q(1);class y{constructor({docId:N,onUnsupportedFeature:_,ownerDocument:k=globalThis.document,styleElement:O=null}){this.constructor===y&&(0,S.unreachable)("Cannot initialize BaseFontLoader."),this.docId=N,this._onUnsupportedFeature=_,this._document=k,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(N){this.nativeFontFaces.push(N),this._document.fonts.add(N)}insertRule(N){let _=this.styleElement;_||(_=this.styleElement=this._document.createElement("style"),_.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(_));const k=_.sheet;k.insertRule(N,k.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(N){if(N.attached||N.missingFile)return;if(N.attached=!0,this.isFontLoadingAPISupported){const k=N.createNativeFontFace();if(k){this.addNativeFontFace(k);try{await k.loaded}catch(O){throw this._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,S.warn)(`Failed to load font '${k.family}': '${O}'.`),N.disableFontFace=!0,O}}return}const _=N.createFontFaceRule();if(_){if(this.insertRule(_),this.isSyncFontLoadingSupported)return;await new Promise(k=>{const O=this._queueLoadingCallback(k);this._prepareFontLoadEvent([_],[N],O)})}}_queueLoadingCallback(N){(0,S.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var _;const N=!!((_=this._document)!=null&&_.fonts);return(0,S.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){(0,S.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,S.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(N,_,k){(0,S.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let J;f.FontLoader=J,f.FontLoader=J=class extends y{constructor(N){super(N),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let N=!1;if(typeof navigator>"u")N=!0;else{const _=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(_==null?void 0:_[1])>=14&&(N=!0)}return(0,S.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){function _(){for((0,S.assert)(!O.done,"completeRequest() cannot be called twice."),O.done=!0;k.requests.length>0&&k.requests[0].done;){const C=k.requests.shift();setTimeout(C.callback,0)}}const k=this.loadingContext,O={id:`pdfjs-font-loading-${k.nextRequestId++}`,done:!1,complete:_,callback:N};return k.requests.push(O),O}get _loadTestFont(){const N=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,S.shadow)(this,"_loadTestFont",N())}_prepareFontLoadEvent(N,_,k){function O(nt,$){return nt.charCodeAt($)<<24|nt.charCodeAt($+1)<<16|nt.charCodeAt($+2)<<8|nt.charCodeAt($+3)&255}function C(nt,$,z,U){const W=nt.substring(0,$),H=nt.substring($+z);return W+U+H}let v,l;const t=this._document.createElement("canvas");t.width=1,t.height=1;const s=t.getContext("2d");let r=0;function g(nt,$){if(r++,r>30){(0,S.warn)("Load test font never loaded."),$();return}if(s.font="30px "+nt,s.fillText(".",0,20),s.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(g.bind(null,nt,$))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let a=this._loadTestFont;a=C(a,976,m.length,m);const n=16,d=1482184792;let T=O(a,n);for(v=0,l=m.length-3;v<l;v+=4)T=T-d+O(m,v)|0;v<m.length&&(T=T-d+O(m+"XXX",v)|0),a=C(a,n,4,(0,S.string32)(T));const b=`url(data:font/opentype;base64,${btoa(a)});`,u=`@font-face {font-family:"${m}";src:${b}}`;this.insertRule(u);const x=[];for(const nt of _)x.push(nt.loadedName);x.push(m);const K=this._document.createElement("div");K.style.visibility="hidden",K.style.width=K.style.height="10px",K.style.position="absolute",K.style.top=K.style.left="0px";for(const nt of x){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=nt,K.append($)}this._document.body.append(K),g(m,()=>{K.remove(),k.complete()})}};class X{constructor(N,{isEvalSupported:_=!0,disableFontFace:k=!1,ignoreErrors:O=!1,onUnsupportedFeature:C,fontRegistry:v=null}){this.compiledGlyphs=Object.create(null);for(const l in N)this[l]=N[l];this.isEvalSupported=_!==!1,this.disableFontFace=k===!0,this.ignoreErrors=O===!0,this._onUnsupportedFeature=C,this.fontRegistry=v}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let N;if(!this.cssFontInfo)N=new FontFace(this.loadedName,this.data,{});else{const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}return this.fontRegistry&&this.fontRegistry.registerFont(this),N}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const N=(0,S.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(N)});`;let k;if(!this.cssFontInfo)k=`@font-face {font-family:"${this.loadedName}";src:${_}}`;else{let O=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(O+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),k=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${O}src:${_}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,_),k}getPathGenerator(N,_){if(this.compiledGlyphs[_]!==void 0)return this.compiledGlyphs[_];let k;try{k=N.get(this.loadedName+"_path_"+_)}catch(O){if(!this.ignoreErrors)throw O;return this._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,S.warn)(`getPathGenerator - ignoring character: "${O}".`),this.compiledGlyphs[_]=function(C,v){}}if(this.isEvalSupported&&S.FeatureTest.isEvalSupported){const O=[];for(const C of k){const v=C.args!==void 0?C.args.join(","):"";O.push("c.",C.cmd,"(",v,`);
`)}return this.compiledGlyphs[_]=new Function("c","size",O.join(""))}return this.compiledGlyphs[_]=function(O,C){for(const v of k)v.cmd==="scale"&&(v.args=[C,-C]),O[v.cmd].apply(O,v.args)}}}f.FontFaceObject=X},(ot,f,Q)=>{var et,he;Object.defineProperty(f,"__esModule",{value:!0}),f.CanvasGraphics=void 0;var S=Q(8),y=Q(1),J=Q(13),X=Q(14),tt=Q(3);const N=16,_=100,k=4096,O=15,C=10,v=tt.isNodeJS&&typeof Path2D>"u"?-1:1e3,l=16;function t(D,c){if(D._removeMirroring)throw new Error("Context is already forwarding operations.");D.__originalSave=D.save,D.__originalRestore=D.restore,D.__originalRotate=D.rotate,D.__originalScale=D.scale,D.__originalTranslate=D.translate,D.__originalTransform=D.transform,D.__originalSetTransform=D.setTransform,D.__originalResetTransform=D.resetTransform,D.__originalClip=D.clip,D.__originalMoveTo=D.moveTo,D.__originalLineTo=D.lineTo,D.__originalBezierCurveTo=D.bezierCurveTo,D.__originalRect=D.rect,D.__originalClosePath=D.closePath,D.__originalBeginPath=D.beginPath,D._removeMirroring=()=>{D.save=D.__originalSave,D.restore=D.__originalRestore,D.rotate=D.__originalRotate,D.scale=D.__originalScale,D.translate=D.__originalTranslate,D.transform=D.__originalTransform,D.setTransform=D.__originalSetTransform,D.resetTransform=D.__originalResetTransform,D.clip=D.__originalClip,D.moveTo=D.__originalMoveTo,D.lineTo=D.__originalLineTo,D.bezierCurveTo=D.__originalBezierCurveTo,D.rect=D.__originalRect,D.closePath=D.__originalClosePath,D.beginPath=D.__originalBeginPath,delete D._removeMirroring},D.save=function(){c.save(),this.__originalSave()},D.restore=function(){c.restore(),this.__originalRestore()},D.translate=function(E,R){c.translate(E,R),this.__originalTranslate(E,R)},D.scale=function(E,R){c.scale(E,R),this.__originalScale(E,R)},D.transform=function(E,R,M,I,G,q){c.transform(E,R,M,I,G,q),this.__originalTransform(E,R,M,I,G,q)},D.setTransform=function(E,R,M,I,G,q){c.setTransform(E,R,M,I,G,q),this.__originalSetTransform(E,R,M,I,G,q)},D.resetTransform=function(){c.resetTransform(),this.__originalResetTransform()},D.rotate=function(E){c.rotate(E),this.__originalRotate(E)},D.clip=function(E){c.clip(E),this.__originalClip(E)},D.moveTo=function(o,E){c.moveTo(o,E),this.__originalMoveTo(o,E)},D.lineTo=function(o,E){c.lineTo(o,E),this.__originalLineTo(o,E)},D.bezierCurveTo=function(o,E,R,M,I,G){c.bezierCurveTo(o,E,R,M,I,G),this.__originalBezierCurveTo(o,E,R,M,I,G)},D.rect=function(o,E,R,M){c.rect(o,E,R,M),this.__originalRect(o,E,R,M)},D.closePath=function(){c.closePath(),this.__originalClosePath()},D.beginPath=function(){c.beginPath(),this.__originalBeginPath()}}class s{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,o,E){let R;return this.cache[c]!==void 0?(R=this.cache[c],this.canvasFactory.reset(R,o,E)):(R=this.canvasFactory.create(o,E),this.cache[c]=R),R}delete(c){delete this.cache[c]}clear(){for(const c in this.cache){const o=this.cache[c];this.canvasFactory.destroy(o),delete this.cache[c]}}}function r(D,c,o,E,R,M,I,G,q,i){const[h,p,A,w,L,st]=(0,S.getCurrentTransform)(D);if(p===0&&A===0){const at=I*h+L,Z=Math.round(at),ct=G*w+st,ft=Math.round(ct),F=(I+q)*h+L,ut=Math.abs(Math.round(F)-Z)||1,At=(G+i)*w+st,vt=Math.abs(Math.round(At)-ft)||1;return D.setTransform(Math.sign(h),0,0,Math.sign(w),Z,ft),D.drawImage(c,o,E,R,M,0,0,ut,vt),D.setTransform(h,p,A,w,L,st),[ut,vt]}if(h===0&&w===0){const at=G*A+L,Z=Math.round(at),ct=I*p+st,ft=Math.round(ct),F=(G+i)*A+L,ut=Math.abs(Math.round(F)-Z)||1,At=(I+q)*p+st,vt=Math.abs(Math.round(At)-ft)||1;return D.setTransform(0,Math.sign(p),Math.sign(A),0,Z,ft),D.drawImage(c,o,E,R,M,0,0,vt,ut),D.setTransform(h,p,A,w,L,st),[vt,ut]}D.drawImage(c,o,E,R,M,I,G,q,i);const dt=Math.hypot(h,p),Y=Math.hypot(A,w);return[dt*q,Y*i]}function g(D){const{width:c,height:o}=D;if(c>v||o>v)return null;const E=1e3,R=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),M=c+1;let I=new Uint8Array(M*(o+1)),G,q,i;const h=c+7&-8;let p=new Uint8Array(h*o),A=0;for(const Y of D.data){let at=128;for(;at>0;)p[A++]=Y&at?0:255,at>>=1}let w=0;for(A=0,p[A]!==0&&(I[0]=1,++w),q=1;q<c;q++)p[A]!==p[A+1]&&(I[q]=p[A]?2:1,++w),A++;for(p[A]!==0&&(I[q]=2,++w),G=1;G<o;G++){A=G*h,i=G*M,p[A-h]!==p[A]&&(I[i]=p[A]?1:8,++w);let Y=(p[A]?4:0)+(p[A-h]?8:0);for(q=1;q<c;q++)Y=(Y>>2)+(p[A+1]?4:0)+(p[A-h+1]?8:0),R[Y]&&(I[i+q]=R[Y],++w),A++;if(p[A-h]!==p[A]&&(I[i+q]=p[A]?2:4,++w),w>E)return null}for(A=h*(o-1),i=G*M,p[A]!==0&&(I[i]=8,++w),q=1;q<c;q++)p[A]!==p[A+1]&&(I[i+q]=p[A]?4:8,++w),A++;if(p[A]!==0&&(I[i+q]=4,++w),w>E)return null;const L=new Int32Array([0,M,-1,0,-M,0,0,0,1]),st=new Path2D;for(G=0;w&&G<=o;G++){let Y=G*M;const at=Y+c;for(;Y<at&&!I[Y];)Y++;if(Y===at)continue;st.moveTo(Y%M,G);const Z=Y;let ct=I[Y];do{const ft=L[ct];do Y+=ft;while(!I[Y]);const F=I[Y];F!==5&&F!==10?(ct=F,I[Y]=0):(ct=F&51*ct>>4,I[Y]&=ct>>2|ct<<2),st.lineTo(Y%M,Y/M|0),I[Y]||--w}while(Z!==Y);--G}return p=null,I=null,function(Y){Y.save(),Y.scale(1/c,-1/o),Y.translate(0,-o),Y.fill(st),Y.beginPath(),Y.restore()}}class m{constructor(c,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=y.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=y.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=y.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,c,o])}clone(){const c=Object.create(this);return c.clipBox=this.clipBox.slice(),c}setCurrentPoint(c,o){this.x=c,this.y=o}updatePathMinMax(c,o,E){[o,E]=y.Util.applyTransform([o,E],c),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,E),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,E)}updateRectMinMax(c,o){const E=y.Util.applyTransform(o,c),R=y.Util.applyTransform(o.slice(2),c);this.minX=Math.min(this.minX,E[0],R[0]),this.minY=Math.min(this.minY,E[1],R[1]),this.maxX=Math.max(this.maxX,E[0],R[0]),this.maxY=Math.max(this.maxY,E[1],R[1])}updateScalingPathMinMax(c,o){y.Util.scaleMinMax(c,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(c,o,E,R,M,I,G,q,i,h){const p=y.Util.bezierBoundingBox(o,E,R,M,I,G,q,i);if(h){h[0]=Math.min(h[0],p[0],p[2]),h[1]=Math.max(h[1],p[0],p[2]),h[2]=Math.min(h[2],p[1],p[3]),h[3]=Math.max(h[3],p[1],p[3]);return}this.updateRectMinMax(c,p)}getPathBoundingBox(c=J.PathType.FILL,o=null){const E=[this.minX,this.minY,this.maxX,this.maxY];if(c===J.PathType.STROKE){o||(0,y.unreachable)("Stroke bounding box must include transform.");const R=y.Util.singularValueDecompose2dScale(o),M=R[0]*this.lineWidth/2,I=R[1]*this.lineWidth/2;E[0]-=M,E[1]-=I,E[2]+=M,E[3]+=I}return E}updateClipFromPath(){const c=y.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(c||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(c){this.clipBox=c,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(c=J.PathType.FILL,o=null){return y.Util.intersect(this.clipBox,this.getPathBoundingBox(c,o))}}function a(D,c,o=null){if(typeof ImageData<"u"&&c instanceof ImageData){D.putImageData(c,0,0);return}const E=c.height,R=c.width,M=E%l,I=(E-M)/l,G=M===0?I:I+1,q=D.createImageData(R,l);let i=0,h;const p=c.data,A=q.data;let w,L,st,dt,Y,at,Z,ct;if(o)switch(o.length){case 1:Y=o[0],at=o[0],Z=o[0],ct=o[0];break;case 4:Y=o[0],at=o[1],Z=o[2],ct=o[3];break}if(c.kind===y.ImageKind.GRAYSCALE_1BPP){const ft=p.byteLength,F=new Uint32Array(A.buffer,0,A.byteLength>>2),ut=F.length,At=R+7>>3;let vt=4294967295,Et=y.FeatureTest.isLittleEndian?4278190080:255;for(ct&&ct[0]===255&&ct[255]===0&&([vt,Et]=[Et,vt]),w=0;w<G;w++){for(st=w<I?l:M,h=0,L=0;L<st;L++){const Tt=ft-i;let Rt=0;const Ft=Tt>At?R:Tt*8-7,Xt=Ft&-8;let xt=0,Ot=0;for(;Rt<Xt;Rt+=8)Ot=p[i++],F[h++]=Ot&128?vt:Et,F[h++]=Ot&64?vt:Et,F[h++]=Ot&32?vt:Et,F[h++]=Ot&16?vt:Et,F[h++]=Ot&8?vt:Et,F[h++]=Ot&4?vt:Et,F[h++]=Ot&2?vt:Et,F[h++]=Ot&1?vt:Et;for(;Rt<Ft;Rt++)xt===0&&(Ot=p[i++],xt=128),F[h++]=Ot&xt?vt:Et,xt>>=1}for(;h<ut;)F[h++]=0;D.putImageData(q,0,w*l)}}else if(c.kind===y.ImageKind.RGBA_32BPP){const ft=!!(Y||at||Z);for(L=0,dt=R*l*4,w=0;w<I;w++){if(A.set(p.subarray(i,i+dt)),i+=dt,ft)for(let F=0;F<dt;F+=4)Y&&(A[F+0]=Y[A[F+0]]),at&&(A[F+1]=at[A[F+1]]),Z&&(A[F+2]=Z[A[F+2]]);D.putImageData(q,0,L),L+=l}if(w<G){if(dt=R*M*4,A.set(p.subarray(i,i+dt)),ft)for(let F=0;F<dt;F+=4)Y&&(A[F+0]=Y[A[F+0]]),at&&(A[F+1]=at[A[F+1]]),Z&&(A[F+2]=Z[A[F+2]]);D.putImageData(q,0,L)}}else if(c.kind===y.ImageKind.RGB_24BPP){const ft=!!(Y||at||Z);for(st=l,dt=R*st,w=0;w<G;w++){for(w>=I&&(st=M,dt=R*st),h=0,L=dt;L--;)A[h++]=p[i++],A[h++]=p[i++],A[h++]=p[i++],A[h++]=255;if(ft)for(let F=0;F<h;F+=4)Y&&(A[F+0]=Y[A[F+0]]),at&&(A[F+1]=at[A[F+1]]),Z&&(A[F+2]=Z[A[F+2]]);D.putImageData(q,0,w*l)}}else throw new Error(`bad image kind: ${c.kind}`)}function e(D,c){if(c.bitmap){D.drawImage(c.bitmap,0,0);return}const o=c.height,E=c.width,R=o%l,M=(o-R)/l,I=R===0?M:M+1,G=D.createImageData(E,l);let q=0;const i=c.data,h=G.data;for(let p=0;p<I;p++){const A=p<M?l:R;({srcPos:q}=(0,X.applyMaskImageData)({src:i,srcPos:q,dest:h,width:E,height:A})),D.putImageData(G,0,p*l)}}function n(D,c){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let E=0,R=o.length;E<R;E++){const M=o[E];D[M]!==void 0&&(c[M]=D[M])}D.setLineDash!==void 0&&(c.setLineDash(D.getLineDash()),c.lineDashOffset=D.lineDashOffset)}function d(D,c){D.strokeStyle=D.fillStyle=c||"#000000",D.fillRule="nonzero",D.globalAlpha=1,D.lineWidth=1,D.lineCap="butt",D.lineJoin="miter",D.miterLimit=10,D.globalCompositeOperation="source-over",D.font="10px sans-serif",D.setLineDash!==void 0&&(D.setLineDash([]),D.lineDashOffset=0)}function T(D,c,o,E){const R=D.length;for(let M=3;M<R;M+=4){const I=D[M];if(I===0)D[M-3]=c,D[M-2]=o,D[M-1]=E;else if(I<255){const G=255-I;D[M-3]=D[M-3]*I+c*G>>8,D[M-2]=D[M-2]*I+o*G>>8,D[M-1]=D[M-1]*I+E*G>>8}}}function b(D,c,o){const E=D.length,R=1/255;for(let M=3;M<E;M+=4){const I=o?o[D[M]]:D[M];c[M]=c[M]*I*R|0}}function u(D,c,o){const E=D.length;for(let R=3;R<E;R+=4){const M=D[R-3]*77+D[R-2]*152+D[R-1]*28;c[R]=o?c[R]*o[M>>8]>>8:c[R]*M>>16}}function x(D,c,o,E,R,M,I,G,q,i,h){const p=!!M,A=p?M[0]:0,w=p?M[1]:0,L=p?M[2]:0;let st;R==="Luminosity"?st=u:st=b;const Y=Math.min(E,Math.ceil(1048576/o));for(let at=0;at<E;at+=Y){const Z=Math.min(Y,E-at),ct=D.getImageData(G-i,at+(q-h),o,Z),ft=c.getImageData(G,at+q,o,Z);p&&T(ct.data,A,w,L),st(ct.data,ft.data,I),c.putImageData(ft,G,at+q)}}function K(D,c,o,E){const R=E[0],M=E[1],I=E[2]-R,G=E[3]-M;I===0||G===0||(x(c.context,o,I,G,c.subtype,c.backdrop,c.transferMap,R,M,c.offsetX,c.offsetY),D.save(),D.globalAlpha=1,D.globalCompositeOperation="source-over",D.setTransform(1,0,0,1,0,0),D.drawImage(o.canvas,0,0),D.restore())}function nt(D,c){const o=y.Util.singularValueDecompose2dScale(D);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const E=Math.fround((globalThis.devicePixelRatio||1)*S.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:o[0]<=E||o[1]<=E}const $=["butt","round","square"],z=["miter","round","bevel"],U={},W={},bt=class{constructor(c,o,E,R,M,I,G,q){rt(this,et);this.ctx=c,this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=E,this.canvasFactory=R,this.imageLayer=M,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=I,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=G,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(q==null?void 0:q.background)||null,this.foregroundColor=(q==null?void 0:q.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(c,o=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):o}beginDrawing({transform:c,viewport:o,transparency:E=!1,background:R=null}){const M=this.ctx.canvas.width,I=this.ctx.canvas.height,G=R||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const q=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const i=this.backgroundColor=this.ctx.fillStyle;let h=!0,p=G;if(this.ctx.fillStyle=G,p=this.ctx.fillStyle,h=typeof p=="string"&&/^#[0-9A-Fa-f]{6}$/.test(p),q==="#000000"&&i==="#ffffff"||q===i||!h)this.foregroundColor=this.backgroundColor=null;else{const[A,w,L]=(0,S.getRGB)(p),st=Y=>(Y/=255,Y<=.03928?Y/12.92:((Y+.055)/1.055)**2.4),dt=Math.round(.2126*st(A)+.7152*st(w)+.0722*st(L));this.selectColor=(Y,at,Z)=>{const ct=.2126*st(Y)+.7152*st(at)+.0722*st(Z);return Math.round(ct)===dt?i:q}}}if(this.ctx.fillStyle=this.backgroundColor||G,this.ctx.fillRect(0,0,M,I),this.ctx.restore(),E){const q=this.cachedCanvases.getCanvas("transparent",M,I);this.compositeCtx=this.ctx,this.transparentCanvas=q.canvas,this.ctx=q.context,this.ctx.save(),this.ctx.transform(...(0,S.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx,this.foregroundColor),c&&(this.ctx.transform(...c),this.outputScaleX=c[0],this.outputScaleY=c[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,S.getCurrentTransform)(this.ctx),this.imageLayer&&((0,S.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(c,o,E,R){const M=c.argsArray,I=c.fnArray;let G=o||0;const q=M.length;if(q===G)return G;const i=q-G>C&&typeof E=="function",h=i?Date.now()+O:0;let p=0;const A=this.commonObjs,w=this.objs;let L;for(;;){if(R!==void 0&&G===R.nextBreakPoint)return R.breakIt(G,E),G;if(L=I[G],L!==y.OPS.dependency)this[L].apply(this,M[G]);else for(const st of M[G]){const dt=st.startsWith("g_")?A:w;if(!dt.has(st))return dt.get(st,E),G}if(G++,G===q)return G;if(i&&++p>C){if(Date.now()>h)return E(),G;p=0}}}endDrawing(){ht(this,et,he).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const c of this._cachedBitmapsMap.values()){for(const o of c.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);c.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(c,o){const E=c.width,R=c.height;let M=Math.max(Math.hypot(o[0],o[1]),1),I=Math.max(Math.hypot(o[2],o[3]),1),G=E,q=R,i="prescale1",h,p;for(;M>2&&G>1||I>2&&q>1;){let A=G,w=q;M>2&&G>1&&(A=Math.ceil(G/2),M/=G/A),I>2&&q>1&&(w=Math.ceil(q/2),I/=q/w),h=this.cachedCanvases.getCanvas(i,A,w),p=h.context,p.clearRect(0,0,A,w),p.drawImage(c,0,0,G,q,0,0,A,w),c=h.canvas,G=A,q=w,i=i==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:G,paintHeight:q}}_createMaskCanvas(c){const o=this.ctx,{width:E,height:R}=c,M=this.current.fillColor,I=this.current.patternFill,G=(0,S.getCurrentTransform)(o);let q,i,h,p;if((c.bitmap||c.data)&&c.count>1){const ut=c.bitmap||c.data.buffer,At=G.slice(0,4);i=JSON.stringify(I?At:[At,M]),q=this._cachedBitmapsMap.get(ut),q||(q=new Map,this._cachedBitmapsMap.set(ut,q));const vt=q.get(i);if(vt&&!I){const Et=Math.round(Math.min(G[0],G[2])+G[4]),Tt=Math.round(Math.min(G[1],G[3])+G[5]);return{canvas:vt,offsetX:Et,offsetY:Tt}}h=vt}h||(p=this.cachedCanvases.getCanvas("maskCanvas",E,R),e(p.context,c));let A=y.Util.transform(G,[1/E,0,0,-1/R,0,0]);A=y.Util.transform(A,[1,0,0,1,0,-R]);const w=y.Util.applyTransform([0,0],A),L=y.Util.applyTransform([E,R],A),st=y.Util.normalizeRect([w[0],w[1],L[0],L[1]]),dt=Math.round(st[2]-st[0])||1,Y=Math.round(st[3]-st[1])||1,at=this.cachedCanvases.getCanvas("fillCanvas",dt,Y),Z=at.context,ct=Math.min(w[0],L[0]),ft=Math.min(w[1],L[1]);Z.translate(-ct,-ft),Z.transform(...A),h||(h=this._scaleImage(p.canvas,(0,S.getCurrentTransformInverse)(Z)),h=h.img,q&&I&&q.set(i,h)),Z.imageSmoothingEnabled=nt((0,S.getCurrentTransform)(Z),c.interpolate),r(Z,h,0,0,h.width,h.height,0,0,E,R),Z.globalCompositeOperation="source-in";const F=y.Util.transform((0,S.getCurrentTransformInverse)(Z),[1,0,0,1,-ct,-ft]);return Z.fillStyle=I?M.getPattern(o,this,F,J.PathType.FILL):M,Z.fillRect(0,0,E,R),q&&!I&&(this.cachedCanvases.delete("fillCanvas"),q.set(i,at.canvas)),{canvas:at.canvas,offsetX:Math.round(ct),offsetY:Math.round(ft)}}setLineWidth(c){c!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=$[c]}setLineJoin(c){this.ctx.lineJoin=z[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,o){const E=this.ctx;E.setLineDash!==void 0&&(E.setLineDash(c),E.lineDashOffset=o)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let o=0,E=c.length;o<E;o++){const R=c[o],M=R[0],I=R[1];switch(M){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I[0],I[1]);break;case"CA":this.current.strokeAlpha=R[1];break;case"ca":this.current.fillAlpha=R[1],this.ctx.globalAlpha=R[1];break;case"BM":this.ctx.globalCompositeOperation=I;break;case"SMask":this.current.activeSMask=I?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=I}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const c=this.inSMaskMode;this.current.activeSMask&&!c?this.beginSMaskMode():!this.current.activeSMask&&c&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const c=this.ctx.canvas.width,o=this.ctx.canvas.height,E="smaskGroupAt"+this.groupLevel,R=this.cachedCanvases.getCanvas(E,c,o);this.suspendedCtx=this.ctx,this.ctx=R.context;const M=this.ctx;M.setTransform(...(0,S.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,M),t(M,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(c){if(!this.current.activeSMask)return;c?(c[0]=Math.floor(c[0]),c[1]=Math.floor(c[1]),c[2]=Math.ceil(c[2]),c[3]=Math.ceil(c[3])):c=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,E=this.suspendedCtx;K(E,o,this.ctx,c),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(c,o,E,R,M,I){this.ctx.transform(c,o,E,R,M,I),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(c,o,E){const R=this.ctx,M=this.current;let I=M.x,G=M.y,q,i;const h=(0,S.getCurrentTransform)(R),p=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,A=p?E.slice(0):null;for(let w=0,L=0,st=c.length;w<st;w++)switch(c[w]|0){case y.OPS.rectangle:I=o[L++],G=o[L++];const dt=o[L++],Y=o[L++],at=I+dt,Z=G+Y;R.moveTo(I,G),dt===0||Y===0?R.lineTo(at,Z):(R.lineTo(at,G),R.lineTo(at,Z),R.lineTo(I,Z)),p||M.updateRectMinMax(h,[I,G,at,Z]),R.closePath();break;case y.OPS.moveTo:I=o[L++],G=o[L++],R.moveTo(I,G),p||M.updatePathMinMax(h,I,G);break;case y.OPS.lineTo:I=o[L++],G=o[L++],R.lineTo(I,G),p||M.updatePathMinMax(h,I,G);break;case y.OPS.curveTo:q=I,i=G,I=o[L+4],G=o[L+5],R.bezierCurveTo(o[L],o[L+1],o[L+2],o[L+3],I,G),M.updateCurvePathMinMax(h,q,i,o[L],o[L+1],o[L+2],o[L+3],I,G,A),L+=6;break;case y.OPS.curveTo2:q=I,i=G,R.bezierCurveTo(I,G,o[L],o[L+1],o[L+2],o[L+3]),M.updateCurvePathMinMax(h,q,i,I,G,o[L],o[L+1],o[L+2],o[L+3],A),I=o[L+2],G=o[L+3],L+=4;break;case y.OPS.curveTo3:q=I,i=G,I=o[L+2],G=o[L+3],R.bezierCurveTo(o[L],o[L+1],I,G,I,G),M.updateCurvePathMinMax(h,q,i,o[L],o[L+1],I,G,I,G,A),L+=4;break;case y.OPS.closePath:R.closePath();break}p&&M.updateScalingPathMinMax(h,A),M.setCurrentPoint(I,G)}closePath(){this.ctx.closePath()}stroke(c){c=typeof c<"u"?c:!0;const o=this.ctx,E=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof E=="object"&&(E!=null&&E.getPattern)?(o.save(),o.strokeStyle=E.getPattern(o,this,(0,S.getCurrentTransformInverse)(o),J.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),c&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c){c=typeof c<"u"?c:!0;const o=this.ctx,E=this.current.fillColor,R=this.current.patternFill;let M=!1;R&&(o.save(),o.fillStyle=E.getPattern(o,this,(0,S.getCurrentTransformInverse)(o),J.PathType.FILL),M=!0);const I=this.current.getClippedPathBoundingBox();this.contentVisible&&I!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),M&&o.restore(),c&&this.consumePath(I)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=U}eoClip(){this.pendingClip=W}beginText(){this.current.textMatrix=y.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,o=this.ctx;if(c===void 0){o.beginPath();return}o.save(),o.beginPath();for(const E of c)o.setTransform(...E.transform),o.translate(E.x,E.y),E.addToPath(o,E.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,o){const E=this.commonObjs.get(c),R=this.current;if(!E)throw new Error(`Can't find font for ${c}`);if(R.fontMatrix=E.fontMatrix||y.FONT_IDENTITY_MATRIX,(R.fontMatrix[0]===0||R.fontMatrix[3]===0)&&(0,y.warn)("Invalid font matrix for font "+c),o<0?(o=-o,R.fontDirection=-1):R.fontDirection=1,this.current.font=E,this.current.fontSize=o,E.isType3Font)return;const M=E.loadedName||"sans-serif";let I="normal";E.black?I="900":E.bold&&(I="bold");const G=E.italic?"italic":"normal",q=`"${M}", ${E.fallbackName}`;let i=o;o<N?i=N:o>_&&(i=_),this.current.fontSizeScale=o/i,this.ctx.font=`${G} ${I} ${i}px ${q}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,o){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=o}setLeadingMoveText(c,o){this.setLeading(-o),this.moveText(c,o)}setTextMatrix(c,o,E,R,M,I){this.current.textMatrix=[c,o,E,R,M,I],this.current.textMatrixScale=Math.hypot(c,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,o,E,R){const M=this.ctx,I=this.current,G=I.font,q=I.textRenderingMode,i=I.fontSize/I.fontSizeScale,h=q&y.TextRenderingMode.FILL_STROKE_MASK,p=!!(q&y.TextRenderingMode.ADD_TO_PATH_FLAG),A=I.patternFill&&!G.missingFile;let w;(G.disableFontFace||p||A)&&(w=G.getPathGenerator(this.commonObjs,c)),G.disableFontFace||A?(M.save(),M.translate(o,E),M.beginPath(),w(M,i),R&&M.setTransform(...R),(h===y.TextRenderingMode.FILL||h===y.TextRenderingMode.FILL_STROKE)&&M.fill(),(h===y.TextRenderingMode.STROKE||h===y.TextRenderingMode.FILL_STROKE)&&M.stroke(),M.restore()):((h===y.TextRenderingMode.FILL||h===y.TextRenderingMode.FILL_STROKE)&&M.fillText(c,o,E),(h===y.TextRenderingMode.STROKE||h===y.TextRenderingMode.FILL_STROKE)&&M.strokeText(c,o,E)),p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,S.getCurrentTransform)(M),x:o,y:E,fontSize:i,addToPath:w})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const o=c.getImageData(0,0,10,10).data;let E=!1;for(let R=3;R<o.length;R+=4)if(o[R]>0&&o[R]<255){E=!0;break}return(0,y.shadow)(this,"isFontSubpixelAAEnabled",E)}showText(c){const o=this.current,E=o.font;if(E.isType3Font)return this.showType3Text(c);const R=o.fontSize;if(R===0)return;const M=this.ctx,I=o.fontSizeScale,G=o.charSpacing,q=o.wordSpacing,i=o.fontDirection,h=o.textHScale*i,p=c.length,A=E.vertical,w=A?1:-1,L=E.defaultVMetrics,st=R*o.fontMatrix[0],dt=o.textRenderingMode===y.TextRenderingMode.FILL&&!E.disableFontFace&&!o.patternFill;M.save(),M.transform(...o.textMatrix),M.translate(o.x,o.y+o.textRise),i>0?M.scale(h,-1):M.scale(h,1);let Y;if(o.patternFill){M.save();const F=o.fillColor.getPattern(M,this,(0,S.getCurrentTransformInverse)(M),J.PathType.FILL);Y=(0,S.getCurrentTransform)(M),M.restore(),M.fillStyle=F}let at=o.lineWidth;const Z=o.textMatrixScale;if(Z===0||at===0){const F=o.textRenderingMode&y.TextRenderingMode.FILL_STROKE_MASK;(F===y.TextRenderingMode.STROKE||F===y.TextRenderingMode.FILL_STROKE)&&(at=this.getSinglePixelWidth())}else at/=Z;I!==1&&(M.scale(I,I),at/=I),M.lineWidth=at;let ct=0,ft;for(ft=0;ft<p;++ft){const F=c[ft];if(typeof F=="number"){ct+=w*F*R/1e3;continue}let ut=!1;const At=(F.isSpace?q:0)+G,vt=F.fontChar,Et=F.accent;let Tt,Rt,Ft=F.width;if(A){const xt=F.vmetric||L,Ot=-(F.vmetric?xt[1]:Ft*.5)*st,Zt=xt[2]*st;Ft=xt?-xt[0]:Ft,Tt=Ot/I,Rt=(ct+Zt)/I}else Tt=ct/I,Rt=0;if(E.remeasure&&Ft>0){const xt=M.measureText(vt).width*1e3/R*I;if(Ft<xt&&this.isFontSubpixelAAEnabled){const Ot=Ft/xt;ut=!0,M.save(),M.scale(Ot,1),Tt/=Ot}else Ft!==xt&&(Tt+=(Ft-xt)/2e3*R/I)}if(this.contentVisible&&(F.isInFont||E.missingFile)){if(dt&&!Et)M.fillText(vt,Tt,Rt);else if(this.paintChar(vt,Tt,Rt,Y),Et){const xt=Tt+R*Et.offset.x/I,Ot=Rt-R*Et.offset.y/I;this.paintChar(Et.fontChar,xt,Ot,Y)}}let Xt;A?Xt=Ft*st-At*i:Xt=Ft*st+At*i,ct+=Xt,ut&&M.restore()}A?o.y-=ct:o.x+=ct*h,M.restore(),this.compose()}showType3Text(c){const o=this.ctx,E=this.current,R=E.font,M=E.fontSize,I=E.fontDirection,G=R.vertical?1:-1,q=E.charSpacing,i=E.wordSpacing,h=E.textHScale*I,p=E.fontMatrix||y.FONT_IDENTITY_MATRIX,A=c.length,w=E.textRenderingMode===y.TextRenderingMode.INVISIBLE;let L,st,dt,Y;if(!(w||M===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...E.textMatrix),o.translate(E.x,E.y),o.scale(h,I),L=0;L<A;++L){if(st=c[L],typeof st=="number"){Y=G*st*M/1e3,this.ctx.translate(Y,0),E.x+=Y*h;continue}const at=(st.isSpace?i:0)+q,Z=R.charProcOperatorList[st.operatorListId];if(!Z){(0,y.warn)(`Type3 character "${st.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=st,this.save(),o.scale(M,M),o.transform(...p),this.executeOperatorList(Z),this.restore()),dt=y.Util.applyTransform([st.width,0],p)[0]*M+at,o.translate(dt,0),E.x+=dt*h}o.restore(),this.processingType3=null}}setCharWidth(c,o){}setCharWidthAndBounds(c,o,E,R,M,I){this.ctx.rect(E,R,M-E,I-R),this.ctx.clip(),this.endPath()}getColorN_Pattern(c){let o;if(c[0]==="TilingPattern"){const E=c[1],R=this.baseTransform||(0,S.getCurrentTransform)(this.ctx),M={createCanvasGraphics:I=>new bt(I,this.commonObjs,this.objs,this.canvasFactory)};o=new J.TilingPattern(c,E,this.ctx,M,R)}else o=this._getPattern(c[1],c[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,o,E){var M;const R=((M=this.selectColor)==null?void 0:M.call(this,c,o,E))||y.Util.makeHexColor(c,o,E);this.ctx.strokeStyle=R,this.current.strokeColor=R}setFillRGBColor(c,o,E){var M;const R=((M=this.selectColor)==null?void 0:M.call(this,c,o,E))||y.Util.makeHexColor(c,o,E);this.ctx.fillStyle=R,this.current.fillColor=R,this.current.patternFill=!1}_getPattern(c,o=null){let E;return this.cachedPatterns.has(c)?E=this.cachedPatterns.get(c):(E=(0,J.getShadingPattern)(this.objs.get(c)),this.cachedPatterns.set(c,E)),o&&(E.matrix=o),E}shadingFill(c){if(!this.contentVisible)return;const o=this.ctx;this.save();const E=this._getPattern(c);o.fillStyle=E.getPattern(o,this,(0,S.getCurrentTransformInverse)(o),J.PathType.SHADING);const R=(0,S.getCurrentTransformInverse)(o);if(R){const M=o.canvas,I=M.width,G=M.height,q=y.Util.applyTransform([0,0],R),i=y.Util.applyTransform([0,G],R),h=y.Util.applyTransform([I,0],R),p=y.Util.applyTransform([I,G],R),A=Math.min(q[0],i[0],h[0],p[0]),w=Math.min(q[1],i[1],h[1],p[1]),L=Math.max(q[0],i[0],h[0],p[0]),st=Math.max(q[1],i[1],h[1],p[1]);this.ctx.fillRect(A,w,L-A,st-w)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,y.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,y.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform(...c),this.baseTransform=(0,S.getCurrentTransform)(this.ctx),o)){const E=o[2]-o[0],R=o[3]-o[1];this.ctx.rect(o[0],o[1],E,R),this.current.updateRectMinMax((0,S.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;c.isolated||(0,y.info)("TODO: Support non-isolated groups."),c.knockout&&(0,y.warn)("Knockout groups not supported.");const E=(0,S.getCurrentTransform)(o);if(c.matrix&&o.transform(...c.matrix),!c.bbox)throw new Error("Bounding box is required.");let R=y.Util.getAxialAlignedBoundingBox(c.bbox,(0,S.getCurrentTransform)(o));const M=[0,0,o.canvas.width,o.canvas.height];R=y.Util.intersect(R,M)||[0,0,0,0];const I=Math.floor(R[0]),G=Math.floor(R[1]);let q=Math.max(Math.ceil(R[2])-I,1),i=Math.max(Math.ceil(R[3])-G,1),h=1,p=1;q>k&&(h=q/k,q=k),i>k&&(p=i/k,i=k),this.current.startNewPathAndClipBox([0,0,q,i]);let A="groupAt"+this.groupLevel;c.smask&&(A+="_smask_"+this.smaskCounter++%2);const w=this.cachedCanvases.getCanvas(A,q,i),L=w.context;L.scale(1/h,1/p),L.translate(-I,-G),L.transform(...E),c.smask?this.smaskStack.push({canvas:w.canvas,context:L,offsetX:I,offsetY:G,scaleX:h,scaleY:p,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(I,G),o.scale(h,p),o.save()),n(o,L),this.ctx=L,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,E=this.groupStack.pop();if(this.ctx=E,this.ctx.imageSmoothingEnabled=!1,c.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const R=(0,S.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...R);const M=y.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],R);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(M)}}beginAnnotation(c,o,E,R,M){if(ht(this,et,he).call(this),d(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const I=o[2]-o[0],G=o[3]-o[1];if(M&&this.annotationCanvasMap){E=E.slice(),E[4]-=o[0],E[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=I,o[3]=G;const[q,i]=y.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(this.ctx)),{viewportScale:h}=this,p=Math.ceil(I*this.outputScaleX*h),A=Math.ceil(G*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,A);const{canvas:w,context:L}=this.annotationCanvas;this.annotationCanvasMap.set(c,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=L,this.ctx.setTransform(q,0,0,-i,0,G*i),d(this.ctx,this.foregroundColor)}else d(this.ctx,this.foregroundColor),this.ctx.rect(o[0],o[1],I,G),this.ctx.clip(),this.endPath()}this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...E),this.transform(...R)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(c){if(!this.contentVisible)return;const o=c.count;c=this.getObject(c.data,c),c.count=o;const E=this.ctx,R=this.processingType3;if(R&&(R.compiled===void 0&&(R.compiled=g(c)),R.compiled)){R.compiled(E);return}const M=this._createMaskCanvas(c),I=M.canvas;E.save(),E.setTransform(1,0,0,1,0,0),E.drawImage(I,M.offsetX,M.offsetY),E.restore(),this.compose()}paintImageMaskXObjectRepeat(c,o,E=0,R=0,M,I){if(!this.contentVisible)return;c=this.getObject(c.data,c);const G=this.ctx;G.save();const q=(0,S.getCurrentTransform)(G);G.transform(o,E,R,M,0,0);const i=this._createMaskCanvas(c);G.setTransform(1,0,0,1,0,0);for(let h=0,p=I.length;h<p;h+=2){const A=y.Util.transform(q,[o,E,R,M,I[h],I[h+1]]),[w,L]=y.Util.applyTransform([0,0],A);G.drawImage(i.canvas,w,L)}G.restore(),this.compose()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const o=this.ctx,E=this.current.fillColor,R=this.current.patternFill;for(const M of c){const{data:I,width:G,height:q,transform:i}=M,h=this.cachedCanvases.getCanvas("maskCanvas",G,q),p=h.context;p.save();const A=this.getObject(I,M);e(p,A),p.globalCompositeOperation="source-in",p.fillStyle=R?E.getPattern(p,this,(0,S.getCurrentTransformInverse)(o),J.PathType.FILL):E,p.fillRect(0,0,G,q),p.restore(),o.save(),o.transform(...i),o.scale(1,-1),r(o,h.canvas,0,0,G,q,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(c){if(!this.contentVisible)return;const o=this.getObject(c);if(!o){(0,y.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(c,o,E,R){if(!this.contentVisible)return;const M=this.getObject(c);if(!M){(0,y.warn)("Dependent image isn't ready yet");return}const I=M.width,G=M.height,q=[];for(let i=0,h=R.length;i<h;i+=2)q.push({transform:[o,0,0,E,R[i],R[i+1]],x:0,y:0,w:I,h:G});this.paintInlineImageXObjectGroup(M,q)}paintInlineImageXObject(c){if(!this.contentVisible)return;const o=c.width,E=c.height,R=this.ctx;this.save(),R.scale(1/o,-1/E);let M;if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)M=c;else{const i=this.cachedCanvases.getCanvas("inlineImage",o,E),h=i.context;a(h,c,this.current.transferMaps),M=i.canvas}const I=this._scaleImage(M,(0,S.getCurrentTransformInverse)(R));R.imageSmoothingEnabled=nt((0,S.getCurrentTransform)(R),c.interpolate);const[G,q]=r(R,I.img,0,0,I.paintWidth,I.paintHeight,0,-E,o,E);if(this.imageLayer){const[i,h]=y.Util.applyTransform([0,-E],(0,S.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:c,left:i,top:h,width:G,height:q})}this.compose(),this.restore()}paintInlineImageXObjectGroup(c,o){if(!this.contentVisible)return;const E=this.ctx,R=c.width,M=c.height,I=this.cachedCanvases.getCanvas("inlineImage",R,M),G=I.context;a(G,c,this.current.transferMaps);for(const q of o){if(E.save(),E.transform(...q.transform),E.scale(1,-1),r(E,I.canvas,q.x,q.y,q.w,q.h,0,-1,1,1),this.imageLayer){const[i,h]=y.Util.applyTransform([q.x,q.y],(0,S.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:c,left:i,top:h,width:R,height:M})}E.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(c){}markPointProps(c,o){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,o){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(c){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(c);const E=this.ctx;this.pendingClip&&(o||(this.pendingClip===W?E.clip("evenodd"):E.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),E.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const c=(0,S.getCurrentTransform)(this.ctx);if(c[1]===0&&c[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(c[0]),Math.abs(c[3]));else{const o=Math.abs(c[0]*c[3]-c[2]*c[1]),E=Math.hypot(c[0],c[2]),R=Math.hypot(c[1],c[3]);this._cachedGetSinglePixelWidth=Math.max(E,R)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:c}=this.current,o=(0,S.getCurrentTransform)(this.ctx);let E,R;if(o[1]===0&&o[2]===0){const M=Math.abs(o[0]),I=Math.abs(o[3]);if(c===0)E=1/M,R=1/I;else{const G=M*c,q=I*c;E=G<1?1/G:1,R=q<1?1/q:1}}else{const M=Math.abs(o[0]*o[3]-o[2]*o[1]),I=Math.hypot(o[0],o[1]),G=Math.hypot(o[2],o[3]);if(c===0)E=G/M,R=I/M;else{const q=c*M;E=G>q?G/q:1,R=I>q?I/q:1}}this._cachedScaleForStroking=[E,R]}return this._cachedScaleForStroking}rescaleAndStroke(c){const{ctx:o}=this,{lineWidth:E}=this.current,[R,M]=this.getScaleForStroking();if(o.lineWidth=E||1,R===1&&M===1){o.stroke();return}let I,G,q;c&&(I=(0,S.getCurrentTransform)(o),G=o.getLineDash().slice(),q=o.lineDashOffset),o.scale(R,M);const i=Math.max(R,M);o.setLineDash(o.getLineDash().map(h=>h/i)),o.lineDashOffset/=i,o.stroke(),c&&(o.setTransform(...I),o.setLineDash(G),o.lineDashOffset=q)}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}};let H=bt;et=new WeakSet,he=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},f.CanvasGraphics=H;for(const D in y.OPS)H.prototype[D]!==void 0&&(H.prototype[y.OPS[D]]=H.prototype[D])},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.TilingPattern=f.PathType=void 0,f.getShadingPattern=l;var S=Q(1),y=Q(8),J=Q(3);const X={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};f.PathType=X;function tt(r,g){if(!g||J.isNodeJS)return;const m=g[2]-g[0],a=g[3]-g[1],e=new Path2D;e.rect(g[0],g[1],m,a),r.clip(e)}class N{constructor(){this.constructor===N&&(0,S.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,S.unreachable)("Abstract method `getPattern` called.")}}class _ extends N{constructor(g){super(),this._type=g[1],this._bbox=g[2],this._colorStops=g[3],this._p0=g[4],this._p1=g[5],this._r0=g[6],this._r1=g[7],this.matrix=null}_createGradient(g){let m;this._type==="axial"?m=g.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(m=g.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)m.addColorStop(a[0],a[1]);return m}getPattern(g,m,a,e){let n;if(e===X.STROKE||e===X.FILL){const d=m.current.getClippedPathBoundingBox(e,(0,y.getCurrentTransform)(g))||[0,0,0,0],T=Math.ceil(d[2]-d[0])||1,b=Math.ceil(d[3]-d[1])||1,u=m.cachedCanvases.getCanvas("pattern",T,b,!0),x=u.context;x.clearRect(0,0,x.canvas.width,x.canvas.height),x.beginPath(),x.rect(0,0,x.canvas.width,x.canvas.height),x.translate(-d[0],-d[1]),a=S.Util.transform(a,[1,0,0,1,d[0],d[1]]),x.transform(...m.baseTransform),this.matrix&&x.transform(...this.matrix),tt(x,this._bbox),x.fillStyle=this._createGradient(x),x.fill(),n=g.createPattern(u.canvas,"no-repeat");const K=new DOMMatrix(a);try{n.setTransform(K)}catch(nt){(0,S.warn)(`RadialAxialShadingPattern.getPattern: "${nt==null?void 0:nt.message}".`)}}else tt(g,this._bbox),n=this._createGradient(g);return n}}function k(r,g,m,a,e,n,d,T){const b=g.coords,u=g.colors,x=r.data,K=r.width*4;let nt;b[m+1]>b[a+1]&&(nt=m,m=a,a=nt,nt=n,n=d,d=nt),b[a+1]>b[e+1]&&(nt=a,a=e,e=nt,nt=d,d=T,T=nt),b[m+1]>b[a+1]&&(nt=m,m=a,a=nt,nt=n,n=d,d=nt);const $=(b[m]+g.offsetX)*g.scaleX,z=(b[m+1]+g.offsetY)*g.scaleY,U=(b[a]+g.offsetX)*g.scaleX,W=(b[a+1]+g.offsetY)*g.scaleY,H=(b[e]+g.offsetX)*g.scaleX,et=(b[e+1]+g.offsetY)*g.scaleY;if(z>=et)return;const lt=u[n],bt=u[n+1],D=u[n+2],c=u[d],o=u[d+1],E=u[d+2],R=u[T],M=u[T+1],I=u[T+2],G=Math.round(z),q=Math.round(et);let i,h,p,A,w,L,st,dt;for(let Y=G;Y<=q;Y++){if(Y<W){let F;Y<z?F=0:F=(z-Y)/(z-W),i=$-($-U)*F,h=lt-(lt-c)*F,p=bt-(bt-o)*F,A=D-(D-E)*F}else{let F;Y>et?F=1:W===et?F=0:F=(W-Y)/(W-et),i=U-(U-H)*F,h=c-(c-R)*F,p=o-(o-M)*F,A=E-(E-I)*F}let at;Y<z?at=0:Y>et?at=1:at=(z-Y)/(z-et),w=$-($-H)*at,L=lt-(lt-R)*at,st=bt-(bt-M)*at,dt=D-(D-I)*at;const Z=Math.round(Math.min(i,w)),ct=Math.round(Math.max(i,w));let ft=K*Y+Z*4;for(let F=Z;F<=ct;F++)at=(i-F)/(i-w),at<0?at=0:at>1&&(at=1),x[ft++]=h-(h-L)*at|0,x[ft++]=p-(p-st)*at|0,x[ft++]=A-(A-dt)*at|0,x[ft++]=255}}function O(r,g,m){const a=g.coords,e=g.colors;let n,d;switch(g.type){case"lattice":const T=g.verticesPerRow,b=Math.floor(a.length/T)-1,u=T-1;for(n=0;n<b;n++){let x=n*T;for(let K=0;K<u;K++,x++)k(r,m,a[x],a[x+1],a[x+T],e[x],e[x+1],e[x+T]),k(r,m,a[x+T+1],a[x+1],a[x+T],e[x+T+1],e[x+1],e[x+T])}break;case"triangles":for(n=0,d=a.length;n<d;n+=3)k(r,m,a[n],a[n+1],a[n+2],e[n],e[n+1],e[n+2]);break;default:throw new Error("illegal figure")}}class C extends N{constructor(g){super(),this._coords=g[2],this._colors=g[3],this._figures=g[4],this._bounds=g[5],this._bbox=g[7],this._background=g[8],this.matrix=null}_createMeshCanvas(g,m,a){const T=Math.floor(this._bounds[0]),b=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-T,x=Math.ceil(this._bounds[3])-b,K=Math.min(Math.ceil(Math.abs(u*g[0]*1.1)),3e3),nt=Math.min(Math.ceil(Math.abs(x*g[1]*1.1)),3e3),$=u/K,z=x/nt,U={coords:this._coords,colors:this._colors,offsetX:-T,offsetY:-b,scaleX:1/$,scaleY:1/z},W=K+2*2,H=nt+2*2,et=a.getCanvas("mesh",W,H,!1),lt=et.context,bt=lt.createImageData(K,nt);if(m){const c=bt.data;for(let o=0,E=c.length;o<E;o+=4)c[o]=m[0],c[o+1]=m[1],c[o+2]=m[2],c[o+3]=255}for(const c of this._figures)O(bt,c,U);return lt.putImageData(bt,2,2),{canvas:et.canvas,offsetX:T-2*$,offsetY:b-2*z,scaleX:$,scaleY:z}}getPattern(g,m,a,e){tt(g,this._bbox);let n;if(e===X.SHADING)n=S.Util.singularValueDecompose2dScale((0,y.getCurrentTransform)(g));else if(n=S.Util.singularValueDecompose2dScale(m.baseTransform),this.matrix){const T=S.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*T[0],n[1]*T[1]]}const d=this._createMeshCanvas(n,e===X.SHADING?null:this._background,m.cachedCanvases);return e!==X.SHADING&&(g.setTransform(...m.baseTransform),this.matrix&&g.transform(...this.matrix)),g.translate(d.offsetX,d.offsetY),g.scale(d.scaleX,d.scaleY),g.createPattern(d.canvas,"no-repeat")}}class v extends N{getPattern(){return"hotpink"}}function l(r){switch(r[0]){case"RadialAxial":return new _(r);case"Mesh":return new C(r);case"Dummy":return new v}throw new Error(`Unknown IR type: ${r[0]}`)}const t={COLORED:1,UNCOLORED:2};class s{static get MAX_PATTERN_SIZE(){return(0,S.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(g,m,a,e,n){this.operatorList=g[2],this.matrix=g[3]||[1,0,0,1,0,0],this.bbox=g[4],this.xstep=g[5],this.ystep=g[6],this.paintType=g[7],this.tilingType=g[8],this.color=m,this.ctx=a,this.canvasGraphicsFactory=e,this.baseTransform=n}createPatternCanvas(g){const m=this.operatorList,a=this.bbox,e=this.xstep,n=this.ystep,d=this.paintType,T=this.tilingType,b=this.color,u=this.canvasGraphicsFactory;(0,S.info)("TilingType: "+T);const x=a[0],K=a[1],nt=a[2],$=a[3],z=S.Util.singularValueDecompose2dScale(this.matrix),U=S.Util.singularValueDecompose2dScale(this.baseTransform),W=[z[0]*U[0],z[1]*U[1]],H=this.getSizeAndScale(e,this.ctx.canvas.width,W[0]),et=this.getSizeAndScale(n,this.ctx.canvas.height,W[1]),lt=g.cachedCanvases.getCanvas("pattern",H.size,et.size,!0),bt=lt.context,D=u.createCanvasGraphics(bt);D.groupLevel=g.groupLevel,this.setFillAndStrokeStyleToContext(D,d,b);let c=x,o=K,E=nt,R=$;return x<0&&(c=0,E+=Math.abs(x)),K<0&&(o=0,R+=Math.abs(K)),bt.translate(-(H.scale*c),-(et.scale*o)),D.transform(H.scale,0,0,et.scale,0,0),bt.save(),this.clipBbox(D,c,o,E,R),D.baseTransform=(0,y.getCurrentTransform)(D.ctx),D.executeOperatorList(m),D.endDrawing(),{canvas:lt.canvas,scaleX:H.scale,scaleY:et.scale,offsetX:c,offsetY:o}}getSizeAndScale(g,m,a){g=Math.abs(g);const e=Math.max(s.MAX_PATTERN_SIZE,m);let n=Math.ceil(g*a);return n>=e?n=e:a=n/g,{scale:a,size:n}}clipBbox(g,m,a,e,n){const d=e-m,T=n-a;g.ctx.rect(m,a,d,T),g.current.updateRectMinMax((0,y.getCurrentTransform)(g.ctx),[m,a,e,n]),g.clip(),g.endPath()}setFillAndStrokeStyleToContext(g,m,a){const e=g.ctx,n=g.current;switch(m){case t.COLORED:const d=this.ctx;e.fillStyle=d.fillStyle,e.strokeStyle=d.strokeStyle,n.fillColor=d.fillStyle,n.strokeColor=d.strokeStyle;break;case t.UNCOLORED:const T=S.Util.makeHexColor(a[0],a[1],a[2]);e.fillStyle=T,e.strokeStyle=T,n.fillColor=T,n.strokeColor=T;break;default:throw new S.FormatError(`Unsupported paint type: ${m}`)}}getPattern(g,m,a,e){let n=a;e!==X.SHADING&&(n=S.Util.transform(n,m.baseTransform),this.matrix&&(n=S.Util.transform(n,this.matrix)));const d=this.createPatternCanvas(m);let T=new DOMMatrix(n);T=T.translate(d.offsetX,d.offsetY),T=T.scale(1/d.scaleX,1/d.scaleY);const b=g.createPattern(d.canvas,"repeat");try{b.setTransform(T)}catch(u){(0,S.warn)(`TilingPattern.getPattern: "${u==null?void 0:u.message}".`)}return b}}f.TilingPattern=s},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.applyMaskImageData=y;var S=Q(1);function y({src:J,srcPos:X=0,dest:tt,destPos:N=0,width:_,height:k,inverseDecode:O=!1}){const C=S.FeatureTest.isLittleEndian?4278190080:255,[v,l]=O?[0,C]:[C,0],t=_>>3,s=_&7,r=J.length;tt=new Uint32Array(tt.buffer);for(let g=0;g<k;g++){for(const a=X+t;X<a;X++){const e=X<r?J[X]:255;tt[N++]=e&128?l:v,tt[N++]=e&64?l:v,tt[N++]=e&32?l:v,tt[N++]=e&16?l:v,tt[N++]=e&8?l:v,tt[N++]=e&4?l:v,tt[N++]=e&2?l:v,tt[N++]=e&1?l:v}if(s===0)continue;const m=X<r?J[X++]:255;for(let a=0;a<s;a++)tt[N++]=m&1<<7-a?l:v}return{srcPos:X,destPos:N}}},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.GlobalWorkerOptions=void 0;const Q=Object.create(null);f.GlobalWorkerOptions=Q,Q.workerPort=Q.workerPort===void 0?null:Q.workerPort,Q.workerSrc=Q.workerSrc===void 0?"":Q.workerSrc},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.MessageHandler=void 0;var S=Q(1);const y={UNKNOWN:0,DATA:1,ERROR:2},J={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function X(N){switch(N instanceof Error||typeof N=="object"&&N!==null||(0,S.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),N.name){case"AbortException":return new S.AbortException(N.message);case"MissingPDFException":return new S.MissingPDFException(N.message);case"PasswordException":return new S.PasswordException(N.message,N.code);case"UnexpectedResponseException":return new S.UnexpectedResponseException(N.message,N.status);case"UnknownErrorException":return new S.UnknownErrorException(N.message,N.details);default:return new S.UnknownErrorException(N.message,N.toString())}}class tt{constructor(_,k,O){this.sourceName=_,this.targetName=k,this.comObj=O,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const v=C.data;if(v.targetName!==this.sourceName)return;if(v.stream){this._processStreamMessage(v);return}if(v.callback){const t=v.callbackId,s=this.callbackCapabilities[t];if(!s)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],v.callback===y.DATA)s.resolve(v.data);else if(v.callback===y.ERROR)s.reject(X(v.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[v.action];if(!l)throw new Error(`Unknown action from worker: ${v.action}`);if(v.callbackId){const t=this.sourceName,s=v.sourceName;new Promise(function(r){r(l(v.data))}).then(function(r){O.postMessage({sourceName:t,targetName:s,callback:y.DATA,callbackId:v.callbackId,data:r})},function(r){O.postMessage({sourceName:t,targetName:s,callback:y.ERROR,callbackId:v.callbackId,reason:X(r)})});return}if(v.streamId){this._createStreamSink(v);return}l(v.data)},O.addEventListener("message",this._onComObjOnMessage)}on(_,k){const O=this.actionHandler;if(O[_])throw new Error(`There is already an actionName called "${_}"`);O[_]=k}send(_,k,O){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,data:k},O)}sendWithPromise(_,k,O){const C=this.callbackId++,v=(0,S.createPromiseCapability)();this.callbackCapabilities[C]=v;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,callbackId:C,data:k},O)}catch(l){v.reject(l)}return v.promise}sendWithStream(_,k,O,C){const v=this.streamId++,l=this.sourceName,t=this.targetName,s=this.comObj;return new ReadableStream({start:r=>{const g=(0,S.createPromiseCapability)();return this.streamControllers[v]={controller:r,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:l,targetName:t,action:_,streamId:v,data:k,desiredSize:r.desiredSize},C),g.promise},pull:r=>{const g=(0,S.createPromiseCapability)();return this.streamControllers[v].pullCall=g,s.postMessage({sourceName:l,targetName:t,stream:J.PULL,streamId:v,desiredSize:r.desiredSize}),g.promise},cancel:r=>{(0,S.assert)(r instanceof Error,"cancel must have a valid reason");const g=(0,S.createPromiseCapability)();return this.streamControllers[v].cancelCall=g,this.streamControllers[v].isClosed=!0,s.postMessage({sourceName:l,targetName:t,stream:J.CANCEL,streamId:v,reason:X(r)}),g.promise}},O)}_createStreamSink(_){const k=_.streamId,O=this.sourceName,C=_.sourceName,v=this.comObj,l=this,t=this.actionHandler[_.action],s={enqueue(r,g=1,m){if(this.isCancelled)return;const a=this.desiredSize;this.desiredSize-=g,a>0&&this.desiredSize<=0&&(this.sinkCapability=(0,S.createPromiseCapability)(),this.ready=this.sinkCapability.promise),v.postMessage({sourceName:O,targetName:C,stream:J.ENQUEUE,streamId:k,chunk:r},m)},close(){this.isCancelled||(this.isCancelled=!0,v.postMessage({sourceName:O,targetName:C,stream:J.CLOSE,streamId:k}),delete l.streamSinks[k])},error(r){(0,S.assert)(r instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,v.postMessage({sourceName:O,targetName:C,stream:J.ERROR,streamId:k,reason:X(r)}))},sinkCapability:(0,S.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:_.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[k]=s,new Promise(function(r){r(t(_.data,s))}).then(function(){v.postMessage({sourceName:O,targetName:C,stream:J.START_COMPLETE,streamId:k,success:!0})},function(r){v.postMessage({sourceName:O,targetName:C,stream:J.START_COMPLETE,streamId:k,reason:X(r)})})}_processStreamMessage(_){const k=_.streamId,O=this.sourceName,C=_.sourceName,v=this.comObj,l=this.streamControllers[k],t=this.streamSinks[k];switch(_.stream){case J.START_COMPLETE:_.success?l.startCall.resolve():l.startCall.reject(X(_.reason));break;case J.PULL_COMPLETE:_.success?l.pullCall.resolve():l.pullCall.reject(X(_.reason));break;case J.PULL:if(!t){v.postMessage({sourceName:O,targetName:C,stream:J.PULL_COMPLETE,streamId:k,success:!0});break}t.desiredSize<=0&&_.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=_.desiredSize,new Promise(function(s){s(t.onPull&&t.onPull())}).then(function(){v.postMessage({sourceName:O,targetName:C,stream:J.PULL_COMPLETE,streamId:k,success:!0})},function(s){v.postMessage({sourceName:O,targetName:C,stream:J.PULL_COMPLETE,streamId:k,reason:X(s)})});break;case J.ENQUEUE:if((0,S.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(_.chunk);break;case J.CLOSE:if((0,S.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this._deleteStreamController(l,k);break;case J.ERROR:(0,S.assert)(l,"error should have stream controller"),l.controller.error(X(_.reason)),this._deleteStreamController(l,k);break;case J.CANCEL_COMPLETE:_.success?l.cancelCall.resolve():l.cancelCall.reject(X(_.reason)),this._deleteStreamController(l,k);break;case J.CANCEL:if(!t)break;new Promise(function(s){s(t.onCancel&&t.onCancel(X(_.reason)))}).then(function(){v.postMessage({sourceName:O,targetName:C,stream:J.CANCEL_COMPLETE,streamId:k,success:!0})},function(s){v.postMessage({sourceName:O,targetName:C,stream:J.CANCEL_COMPLETE,streamId:k,reason:X(s)})}),t.sinkCapability.reject(X(_.reason)),t.isCancelled=!0,delete this.streamSinks[k];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(_,k){await Promise.allSettled([_.startCall&&_.startCall.promise,_.pullCall&&_.pullCall.promise,_.cancelCall&&_.cancelCall.promise]),delete this.streamControllers[k]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}f.MessageHandler=tt},(ot,f,Q)=>{var J,X;Object.defineProperty(f,"__esModule",{value:!0}),f.Metadata=void 0;var S=Q(1);class y{constructor({parsedData:N,rawData:_}){rt(this,J,void 0);rt(this,X,void 0);mt(this,J,N),mt(this,X,_)}getRaw(){return P(this,X)}get(N){return P(this,J).get(N)??null}getAll(){return(0,S.objectFromMap)(P(this,J))}has(N){return P(this,J).has(N)}}J=new WeakMap,X=new WeakMap,f.Metadata=y},(ot,f,Q)=>{var tt,N,_,k,O,C,de;Object.defineProperty(f,"__esModule",{value:!0}),f.OptionalContentConfig=void 0;var S=Q(1);const y=Symbol("INTERNAL");class J{constructor(t,s){rt(this,tt,!0);this.name=t,this.intent=s}get visible(){return P(this,tt)}_setVisible(t,s){t!==y&&(0,S.unreachable)("Internal method `_setVisible` called."),mt(this,tt,s)}}tt=new WeakMap;class X{constructor(t){rt(this,C);rt(this,N,!0);rt(this,_,new Map);rt(this,k,null);rt(this,O,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,mt(this,O,t.order);for(const s of t.groups)P(this,_).set(s.id,new J(s.name,s.intent));if(t.baseState==="OFF")for(const s of P(this,_).values())s._setVisible(y,!1);for(const s of t.on)P(this,_).get(s)._setVisible(y,!0);for(const s of t.off)P(this,_).get(s)._setVisible(y,!1);mt(this,k,new Map);for(const[s,r]of P(this,_))P(this,k).set(s,r.visible)}}isVisible(t){if(P(this,_).size===0)return!0;if(!t)return(0,S.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return P(this,_).has(t.id)?P(this,_).get(t.id).visible:((0,S.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return ht(this,C,de).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!P(this,_).has(s))return(0,S.warn)(`Optional content group not found: ${s}`),!0;if(P(this,_).get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!P(this,_).has(s))return(0,S.warn)(`Optional content group not found: ${s}`),!0;if(!P(this,_).get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!P(this,_).has(s))return(0,S.warn)(`Optional content group not found: ${s}`),!0;if(!P(this,_).get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!P(this,_).has(s))return(0,S.warn)(`Optional content group not found: ${s}`),!0;if(P(this,_).get(s).visible)return!1}return!0}return(0,S.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,S.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0){if(!P(this,_).has(t)){(0,S.warn)(`Optional content group not found: ${t}`);return}P(this,_).get(t)._setVisible(y,!!s),mt(this,N,null)}get hasInitialVisibility(){if(P(this,N)!==null)return P(this,N);for(const[t,s]of P(this,_)){const r=P(this,k).get(t);if(s.visible!==r)return mt(this,N,!1)}return mt(this,N,!0)}getOrder(){return P(this,_).size?P(this,O)?P(this,O).slice():[...P(this,_).keys()]:null}getGroups(){return P(this,_).size>0?(0,S.objectFromMap)(P(this,_)):null}getGroup(t){return P(this,_).get(t)||null}}N=new WeakMap,_=new WeakMap,k=new WeakMap,O=new WeakMap,C=new WeakSet,de=function(t){const s=t.length;if(s<2)return!0;const r=t[0];for(let g=1;g<s;g++){const m=t[g];let a;if(Array.isArray(m))a=ht(this,C,de).call(this,m);else if(P(this,_).has(m))a=P(this,_).get(m).visible;else return(0,S.warn)(`Optional content group not found: ${m}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"},f.OptionalContentConfig=X},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFDataTransportStream=void 0;var S=Q(1),y=Q(8);class J{constructor(_,k){(0,S.assert)(k,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=_.progressiveDone||!1,this._contentDispositionFilename=_.contentDispositionFilename||null;const O=_.initialData;if((O==null?void 0:O.length)>0){const C=new Uint8Array(O).buffer;this._queuedChunks.push(C)}this._pdfDataRangeTransport=k,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._contentLength=_.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((C,v)=>{this._onReceiveData({begin:C,chunk:v})}),this._pdfDataRangeTransport.addProgressListener((C,v)=>{this._onProgress({loaded:C,total:v})}),this._pdfDataRangeTransport.addProgressiveReadListener(C=>{this._onReceiveData({chunk:C})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(_){const k=new Uint8Array(_.chunk).buffer;if(_.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(k):this._queuedChunks.push(k);else{const O=this._rangeReaders.some(function(C){return C._begin!==_.begin?!1:(C._enqueue(k),!0)});(0,S.assert)(O,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _;return((_=this._fullRequestReader)==null?void 0:_._loaded)??0}_onProgress(_){if(_.total===void 0){const k=this._rangeReaders[0];k!=null&&k.onProgress&&k.onProgress({loaded:_.loaded})}else{const k=this._fullRequestReader;k!=null&&k.onProgress&&k.onProgress({loaded:_.loaded,total:_.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const k=this._rangeReaders.indexOf(_);k>=0&&this._rangeReaders.splice(k,1)}getFullReader(){(0,S.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new X(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,k){if(k<=this._progressiveDataLength)return null;const O=new tt(this,_,k);return this._pdfDataRangeTransport.requestDataRange(_,k),this._rangeReaders.push(O),O}cancelAllRequests(_){this._fullRequestReader&&this._fullRequestReader.cancel(_);for(const k of this._rangeReaders.slice(0))k.cancel(_);this._pdfDataRangeTransport.abort()}}f.PDFDataTransportStream=J;class X{constructor(_,k,O=!1,C=null){this._stream=_,this._done=O||!1,this._filename=(0,y.isPdfFile)(C)?C:null,this._queuedChunks=k||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=(0,S.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(_,k,O){this._stream=_,this._begin=k,this._end=O,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(this._requests.length===0)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const O of this._requests)O.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const k=this._queuedChunk;return this._queuedChunk=null,{value:k,done:!1}}if(this._done)return{value:void 0,done:!0};const _=(0,S.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.XfaText=void 0;class Q{static textContent(y){const J=[],X={items:J,styles:Object.create(null)};function tt(N){var O;if(!N)return;let _=null;const k=N.name;if(k==="#text")_=N.value;else if(Q.shouldBuildText(k))(O=N==null?void 0:N.attributes)!=null&&O.textContent?_=N.attributes.textContent:N.value&&(_=N.value);else return;if(_!==null&&J.push({str:_}),!!N.children)for(const C of N.children)tt(C)}return tt(y),X}static shouldBuildText(y){return!(y==="textarea"||y==="input"||y==="option"||y==="select")}}f.XfaText=Q},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.NodeStandardFontDataFactory=f.NodeCanvasFactory=f.NodeCMapReaderFactory=void 0;var S=Q(9);const y=function(N){return new Promise((_,k)=>{require$$5.readFile(N,(C,v)=>{if(C||!v){k(new Error(C));return}_(new Uint8Array(v))})})};class J extends S.BaseCanvasFactory{_createCanvas(_,k){return require$$5.createCanvas(_,k)}}f.NodeCanvasFactory=J;class X extends S.BaseCMapReaderFactory{_fetchData(_,k){return y(_).then(O=>({cMapData:O,compressionType:k}))}}f.NodeCMapReaderFactory=X;class tt extends S.BaseStandardFontDataFactory{_fetchData(_){return y(_)}}f.NodeStandardFontDataFactory=tt},(ot,f,Q)=>{var N,_,k,O,C,v,l,t,s,ue,g,ke,a,fe,n,Fe;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationEditorLayer=void 0;var S=Q(7),y=Q(1),J=Q(23),X=Q(24);const T=class{constructor(u){rt(this,s);rt(this,g);rt(this,a);rt(this,n);rt(this,N,void 0);rt(this,_,!1);rt(this,k,this.pointerup.bind(this));rt(this,O,this.pointerdown.bind(this));rt(this,C,new Map);rt(this,v,!1);rt(this,l,!1);rt(this,t,void 0);T._initialized||(T._initialized=!0,J.FreeTextEditor.initialize(u.l10n),X.InkEditor.initialize(u.l10n),u.uiManager.registerEditorTypes([J.FreeTextEditor,X.InkEditor])),mt(this,t,u.uiManager),this.annotationStorage=u.annotationStorage,this.pageIndex=u.pageIndex,this.div=u.div,mt(this,N,u.accessibilityManager),P(this,t).addLayer(this)}updateToolbar(u){P(this,t).updateToolbar(u)}updateMode(u=P(this,t).getMode()){ht(this,n,Fe).call(this),u===y.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),P(this,t).unselectAll()}addInkEditorIfNeeded(u){if(!u&&P(this,t).getMode()!==y.AnnotationEditorType.INK)return;if(!u){for(const K of P(this,C).values())if(K.isEmpty()){K.setInBackground();return}}ht(this,a,fe).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(u){P(this,t).setEditingState(u)}addCommands(u){P(this,t).addCommands(u)}enable(){this.div.style.pointerEvents="auto";for(const u of P(this,C).values())u.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const u of P(this,C).values())u.disableEditing()}setActiveEditor(u){P(this,t).getActive()!==u&&P(this,t).setActiveEditor(u)}enableClick(){this.div.addEventListener("pointerdown",P(this,O)),this.div.addEventListener("pointerup",P(this,k))}disableClick(){this.div.removeEventListener("pointerdown",P(this,O)),this.div.removeEventListener("pointerup",P(this,k))}attach(u){P(this,C).set(u.id,u)}detach(u){var x;P(this,C).delete(u.id),(x=P(this,N))==null||x.removePointerInTextLayer(u.contentDiv)}remove(u){P(this,t).removeEditor(u),this.detach(u),this.annotationStorage.remove(u.id),u.div.style.display="none",setTimeout(()=>{u.div.style.display="",u.div.remove(),u.isAttachedToDOM=!1,document.activeElement===document.body&&P(this,t).focusMainContainer()},0),P(this,l)||this.addInkEditorIfNeeded(!1)}add(u){if(ht(this,s,ue).call(this,u),P(this,t).addEditor(u),this.attach(u),!u.isAttachedToDOM){const x=u.render();this.div.append(x),u.isAttachedToDOM=!0}this.moveEditorInDOM(u),u.onceAdded(),this.addToAnnotationStorage(u)}moveEditorInDOM(u){var x;(x=P(this,N))==null||x.moveElementInDOM(this.div,u.div,u.contentDiv,!0)}addToAnnotationStorage(u){!u.isEmpty()&&!this.annotationStorage.has(u.id)&&this.annotationStorage.setValue(u.id,u)}addOrRebuild(u){u.needsToBeRebuilt()?u.rebuild():this.add(u)}addANewEditor(u){const x=()=>{this.addOrRebuild(u)},K=()=>{u.remove()};this.addCommands({cmd:x,undo:K,mustExec:!0})}addUndoableEditor(u){const x=()=>{this.addOrRebuild(u)},K=()=>{u.remove()};this.addCommands({cmd:x,undo:K,mustExec:!1})}getNextId(){return P(this,t).getId()}deserialize(u){switch(u.annotationType){case y.AnnotationEditorType.FREETEXT:return J.FreeTextEditor.deserialize(u,this);case y.AnnotationEditorType.INK:return X.InkEditor.deserialize(u,this)}return null}setSelected(u){P(this,t).setSelected(u)}toggleSelected(u){P(this,t).toggleSelected(u)}isSelected(u){return P(this,t).isSelected(u)}unselect(u){P(this,t).unselect(u)}pointerup(u){const x=S.KeyboardManager.platform.isMac;if(!(u.button!==0||u.ctrlKey&&x)&&u.target===this.div&&P(this,v)){if(mt(this,v,!1),!P(this,_)){mt(this,_,!0);return}ht(this,a,fe).call(this,u)}}pointerdown(u){const x=S.KeyboardManager.platform.isMac;if(u.button!==0||u.ctrlKey&&x||u.target!==this.div)return;mt(this,v,!0);const K=P(this,t).getActive();mt(this,_,!K||K.isEmpty())}drop(u){const x=u.dataTransfer.getData("text/plain"),K=P(this,t).getEditor(x);if(!K)return;u.preventDefault(),u.dataTransfer.dropEffect="move",ht(this,s,ue).call(this,K);const nt=this.div.getBoundingClientRect(),$=u.clientX-nt.x,z=u.clientY-nt.y;K.translate($-K.startX,z-K.startY),this.moveEditorInDOM(K),K.div.focus()}dragover(u){u.preventDefault()}destroy(){var u,x;((u=P(this,t).getActive())==null?void 0:u.parent)===this&&P(this,t).setActiveEditor(null);for(const K of P(this,C).values())(x=P(this,N))==null||x.removePointerInTextLayer(K.contentDiv),K.isAttachedToDOM=!1,K.div.remove(),K.parent=null;this.div=null,P(this,C).clear(),P(this,t).removeLayer(this)}render(u){this.viewport=u.viewport,(0,S.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const x of P(this,t).getEditors(this.pageIndex))this.add(x);this.updateMode()}update(u){this.viewport=u.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[u,x,K,nt]=this.viewport.viewBox,$=K-u,z=nt-x;return[$,z]}get viewportBaseDimensions(){const{width:u,height:x,rotation:K}=this.viewport;return K%180===0?[u,x]:[x,u]}setDimensions(){const{width:u,height:x,rotation:K}=this.viewport,nt=K%180!==0,$=Math.floor(u)+"px",z=Math.floor(x)+"px";this.div.style.width=nt?z:$,this.div.style.height=nt?$:z,this.div.setAttribute("data-main-rotation",K)}};let tt=T;N=new WeakMap,_=new WeakMap,k=new WeakMap,O=new WeakMap,C=new WeakMap,v=new WeakMap,l=new WeakMap,t=new WeakMap,s=new WeakSet,ue=function(u){var x;u.parent!==this&&(this.attach(u),u.pageIndex=this.pageIndex,(x=u.parent)==null||x.detach(u),u.parent=this,u.div&&u.isAttachedToDOM&&(u.div.remove(),this.div.append(u.div)))},g=new WeakSet,ke=function(u){switch(P(this,t).getMode()){case y.AnnotationEditorType.FREETEXT:return new J.FreeTextEditor(u);case y.AnnotationEditorType.INK:return new X.InkEditor(u)}return null},a=new WeakSet,fe=function(u){const x=this.getNextId(),K=ht(this,g,ke).call(this,{parent:this,id:x,x:u.offsetX,y:u.offsetY});return K&&this.add(K),K},n=new WeakSet,Fe=function(){mt(this,l,!0);for(const u of P(this,C).values())u.isEmpty()&&u.remove();mt(this,l,!1)},Mt(tt,"_initialized",!1),f.AnnotationEditorLayer=tt},(ot,f,Q)=>{var tt,N,_,k,O,C,v,l,Re,s,Me,g,Oe,a,pe;Object.defineProperty(f,"__esModule",{value:!0}),f.FreeTextEditor=void 0;var S=Q(1),y=Q(7),J=Q(6);const n=class extends J.AnnotationEditor{constructor(b){super({...b,name:"freeTextEditor"});rt(this,l);rt(this,s);rt(this,g);rt(this,a);rt(this,tt,this.editorDivBlur.bind(this));rt(this,N,this.editorDivFocus.bind(this));rt(this,_,this.editorDivKeydown.bind(this));rt(this,k,void 0);rt(this,O,"");rt(this,C,!1);rt(this,v,void 0);mt(this,k,b.color||n._defaultColor||J.AnnotationEditor._defaultLineColor),mt(this,v,b.fontSize||n._defaultFontSize)}static initialize(b){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(x=>[x,b.get(x)]));const u=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(u.getPropertyValue("--freetext-padding"))}static updateDefaultParams(b,u){switch(b){case S.AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=u;break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=u;break}}updateParams(b,u){switch(b){case S.AnnotationEditorParamsType.FREETEXT_SIZE:ht(this,l,Re).call(this,u);break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:ht(this,s,Me).call(this,u);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[S.AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||J.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,P(this,v)],[S.AnnotationEditorParamsType.FREETEXT_COLOR,P(this,k)]]}getInitialTranslation(){return[-n._internalPadding*this.parent.scaleFactor,-(n._internalPadding+P(this,v))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(S.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",P(this,_)),this.editorDiv.addEventListener("focus",P(this,N)),this.editorDiv.addEventListener("blur",P(this,tt)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",P(this,_)),this.editorDiv.removeEventListener("focus",P(this,N)),this.editorDiv.removeEventListener("blur",P(this,tt)),this.div.focus(),this.isEditing=!1)}focusin(b){super.focusin(b),b.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),P(this,C)||(mt(this,C,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),mt(this,O,ht(this,g,Oe).call(this).trimEnd()),ht(this,a,pe).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(b){this.enableEditMode(),this.editorDiv.focus()}keydown(b){b.target===this.div&&b.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(b){n._keyboardManager.exec(this,b)}editorDivFocus(b){this.isEditing=!0}editorDivBlur(b){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let b,u;this.width&&(b=this.x,u=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),n._l10nPromise.get("editor_free_text_aria_label").then(K=>{var nt;return(nt=this.editorDiv)==null?void 0:nt.setAttribute("aria-label",K)}),n._l10nPromise.get("free_text_default_content").then(K=>{var nt;return(nt=this.editorDiv)==null?void 0:nt.setAttribute("default-content",K)}),this.editorDiv.contentEditable=!0;const{style:x}=this.editorDiv;if(x.fontSize=`calc(${P(this,v)}px * var(--scale-factor))`,x.color=P(this,k),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,y.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[K,nt]=this.parent.viewportBaseDimensions;this.setAt(b*K,u*nt,this.width*K,this.height*nt);for(const $ of P(this,O).split(`
`)){const z=document.createElement("div");z.append($?document.createTextNode($):document.createElement("br")),this.editorDiv.append(z)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(b,u){const x=super.deserialize(b,u);return mt(x,v,b.fontSize),mt(x,k,S.Util.makeHexColor(...b.color)),mt(x,O,b.value),x}serialize(){if(this.isEmpty())return null;const b=n._internalPadding*this.parent.scaleFactor,u=this.getRect(b,b),x=J.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:S.AnnotationEditorType.FREETEXT,color:x,fontSize:P(this,v),value:P(this,O),pageIndex:this.parent.pageIndex,rect:u,rotation:this.rotation}}};let X=n;tt=new WeakMap,N=new WeakMap,_=new WeakMap,k=new WeakMap,O=new WeakMap,C=new WeakMap,v=new WeakMap,l=new WeakSet,Re=function(b){const u=K=>{this.editorDiv.style.fontSize=`calc(${K}px * var(--scale-factor))`,this.translate(0,-(K-P(this,v))*this.parent.scaleFactor),mt(this,v,K),ht(this,a,pe).call(this)},x=P(this,v);this.parent.addCommands({cmd:()=>{u(b)},undo:()=>{u(x)},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Me=function(b){const u=P(this,k);this.parent.addCommands({cmd:()=>{mt(this,k,b),this.editorDiv.style.color=b},undo:()=>{mt(this,k,u),this.editorDiv.style.color=u},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Oe=function(){const b=this.editorDiv.getElementsByTagName("div");if(b.length===0)return this.editorDiv.innerText;const u=[];for(let x=0,K=b.length;x<K;x++){const $=b[x].firstChild;($==null?void 0:$.nodeName)==="#text"?u.push($.data):u.push("")}return u.join(`
`)},a=new WeakSet,pe=function(){const[b,u]=this.parent.viewportBaseDimensions,x=this.div.getBoundingClientRect();this.width=x.width/b,this.height=x.height/u},Mt(X,"_freeTextDefaultContent",""),Mt(X,"_l10nPromise"),Mt(X,"_internalPadding",0),Mt(X,"_defaultColor",null),Mt(X,"_defaultFontSize",10),Mt(X,"_keyboardManager",new y.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.prototype.commitOrRemove]])),Mt(X,"_type","freetext"),f.FreeTextEditor=X},(ot,f,Q)=>{var _,k,O,C,v,l,t,s,r,g,m,a,e,n,d,De,b,Ie,x,Le,nt,Ne,z,ge,W,Ue,et,je,bt,Be,c,Gt,E,me,M,ee,G,se,i,Yt,p,_e,w,ne,st,be,Y,We,Z,qe,ft,He,ut,Ae,vt,ie,Tt,Kt,Ft,ye;Object.defineProperty(f,"__esModule",{value:!0}),f.InkEditor=void 0,Object.defineProperty(f,"fitCurve",{enumerable:!0,get:function(){return J.fitCurve}});var S=Q(1),y=Q(6),J=Q(25),X=Q(7);const tt=16,xt=class extends y.AnnotationEditor{constructor(it){super({...it,name:"inkEditor"});rt(this,d);rt(this,b);rt(this,x);rt(this,nt);rt(this,z);rt(this,W);rt(this,et);rt(this,bt);rt(this,c);rt(this,E);rt(this,M);rt(this,G);rt(this,i);rt(this,p);rt(this,w);rt(this,Y);rt(this,Z);rt(this,ft);rt(this,ut);rt(this,vt);rt(this,Tt);rt(this,Ft);rt(this,_,0);rt(this,k,0);rt(this,O,0);rt(this,C,this.canvasPointermove.bind(this));rt(this,v,this.canvasPointerleave.bind(this));rt(this,l,this.canvasPointerup.bind(this));rt(this,t,this.canvasPointerdown.bind(this));rt(this,s,!1);rt(this,r,!1);rt(this,g,null);rt(this,m,null);rt(this,a,0);rt(this,e,0);rt(this,n,null);this.color=it.color||null,this.thickness=it.thickness||null,this.opacity=it.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(it){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(pt=>[pt,it.get(pt)]))}static updateDefaultParams(it,pt){switch(it){case S.AnnotationEditorParamsType.INK_THICKNESS:xt._defaultThickness=pt;break;case S.AnnotationEditorParamsType.INK_COLOR:xt._defaultColor=pt;break;case S.AnnotationEditorParamsType.INK_OPACITY:xt._defaultOpacity=pt/100;break}}updateParams(it,pt){switch(it){case S.AnnotationEditorParamsType.INK_THICKNESS:ht(this,d,De).call(this,pt);break;case S.AnnotationEditorParamsType.INK_COLOR:ht(this,b,Ie).call(this,pt);break;case S.AnnotationEditorParamsType.INK_OPACITY:ht(this,x,Le).call(this,pt);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.INK_THICKNESS,xt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,xt._defaultColor||y.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(xt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[S.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||xt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,this.color||xt._defaultColor||y.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??xt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ht(this,M,ee).call(this),ht(this,G,se).call(this)),this.isAttachedToDOM||(this.parent.add(this),ht(this,i,Yt).call(this)),ht(this,Tt,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,P(this,m).disconnect(),mt(this,m,null),super.remove())}enableEditMode(){P(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",P(this,t)),this.canvas.addEventListener("pointerup",P(this,l)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",P(this,t)),this.canvas.removeEventListener("pointerup",P(this,l)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){P(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),mt(this,s,!0),this.div.classList.add("disabled"),ht(this,Tt,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(it){super.focusin(it),this.enableEditMode()}canvasPointerdown(it){it.button!==0||!this.isInEditMode()||P(this,s)||(this.setInForeground(),it.type!=="mouse"&&this.div.focus(),it.stopPropagation(),this.canvas.addEventListener("pointerleave",P(this,v)),this.canvas.addEventListener("pointermove",P(this,C)),ht(this,W,Ue).call(this,it.offsetX,it.offsetY))}canvasPointermove(it){it.stopPropagation(),ht(this,et,je).call(this,it.offsetX,it.offsetY)}canvasPointerup(it){it.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(it.stopPropagation(),ht(this,E,me).call(this,it),this.setInBackground())}canvasPointerleave(it){ht(this,E,me).call(this,it),this.setInBackground()}render(){if(this.div)return this.div;let it,pt;this.width&&(it=this.x,pt=this.y),super.render(),xt._l10nPromise.get("editor_ink_aria_label").then(_t=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",_t)});const[V,j,B,gt]=ht(this,nt,Ne).call(this);if(this.setAt(V,j,0,0),this.setDims(B,gt),ht(this,M,ee).call(this),this.width){const[_t,yt]=this.parent.viewportBaseDimensions;this.setAt(it*_t,pt*yt,this.width*_t,this.height*yt),mt(this,r,!0),ht(this,i,Yt).call(this),this.setDims(this.width*_t,this.height*yt),ht(this,c,Gt).call(this),ht(this,Ft,ye).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ht(this,G,se).call(this),this.div}setDimensions(it,pt){const V=Math.round(it),j=Math.round(pt);if(P(this,a)===V&&P(this,e)===j)return;mt(this,a,V),mt(this,e,j),this.canvas.style.visibility="hidden",P(this,_)&&Math.abs(P(this,_)-it/pt)>.01&&(pt=Math.ceil(it/P(this,_)),this.setDims(it,pt));const[B,gt]=this.parent.viewportBaseDimensions;this.width=it/B,this.height=pt/gt,P(this,s)&&ht(this,p,_e).call(this,it,pt),ht(this,i,Yt).call(this),ht(this,c,Gt).call(this),this.canvas.style.visibility="visible"}static deserialize(it,pt){var Dt,kt;const V=super.deserialize(it,pt);V.thickness=it.thickness,V.color=S.Util.makeHexColor(...it.color),V.opacity=it.opacity;const[j,B]=pt.pageDimensions,gt=V.width*j,_t=V.height*B,yt=pt.scaleFactor,St=it.thickness/2;mt(V,_,gt/_t),mt(V,s,!0),mt(V,a,Math.round(gt)),mt(V,e,Math.round(_t));for(const{bezier:Ct}of it.paths){const Lt=[];V.paths.push(Lt);let It=yt*(Ct[0]-St),jt=yt*(_t-Ct[1]-St);for(let Nt=2,Wt=Ct.length;Nt<Wt;Nt+=6){const zt=yt*(Ct[Nt]-St),Vt=yt*(_t-Ct[Nt+1]-St),Ht=yt*(Ct[Nt+2]-St),Ut=yt*(_t-Ct[Nt+3]-St),qt=yt*(Ct[Nt+4]-St),$t=yt*(_t-Ct[Nt+5]-St);Lt.push([[It,jt],[zt,Vt],[Ht,Ut],[qt,$t]]),It=qt,jt=$t}const wt=ht(this,st,be).call(this,Lt);V.bezierPath2D.push(wt)}const Pt=ht(Dt=V,ut,Ae).call(Dt);return mt(V,O,Math.max(tt,Pt[2]-Pt[0])),mt(V,k,Math.max(tt,Pt[3]-Pt[1])),ht(kt=V,p,_e).call(kt,gt,_t),V}serialize(){if(this.isEmpty())return null;const it=this.getRect(0,0),pt=this.rotation%180===0?it[3]-it[1]:it[2]-it[0],V=y.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:S.AnnotationEditorType.INK,color:V,thickness:this.thickness,opacity:this.opacity,paths:ht(this,Y,We).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,pt),pageIndex:this.parent.pageIndex,rect:it,rotation:this.rotation}}};let N=xt;_=new WeakMap,k=new WeakMap,O=new WeakMap,C=new WeakMap,v=new WeakMap,l=new WeakMap,t=new WeakMap,s=new WeakMap,r=new WeakMap,g=new WeakMap,m=new WeakMap,a=new WeakMap,e=new WeakMap,n=new WeakMap,d=new WeakSet,De=function(it){const pt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=it,ht(this,Tt,Kt).call(this)},undo:()=>{this.thickness=pt,ht(this,Tt,Kt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},b=new WeakSet,Ie=function(it){const pt=this.color;this.parent.addCommands({cmd:()=>{this.color=it,ht(this,c,Gt).call(this)},undo:()=>{this.color=pt,ht(this,c,Gt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Le=function(it){it/=100;const pt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=it,ht(this,c,Gt).call(this)},undo:()=>{this.opacity=pt,ht(this,c,Gt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},nt=new WeakSet,Ne=function(){const{width:it,height:pt,rotation:V}=this.parent.viewport;switch(V){case 90:return[0,it,it,pt];case 180:return[it,pt,it,pt];case 270:return[pt,0,it,pt];default:return[0,0,it,pt]}},z=new WeakSet,ge=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,X.opacityToHex)(this.opacity)}`},W=new WeakSet,Ue=function(it,pt){this.isEditing=!0,P(this,r)||(mt(this,r,!0),ht(this,i,Yt).call(this),this.thickness||(this.thickness=xt._defaultThickness),this.color||(this.color=xt._defaultColor||y.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=xt._defaultOpacity)),this.currentPath.push([it,pt]),mt(this,g,null),ht(this,z,ge).call(this),this.ctx.beginPath(),this.ctx.moveTo(it,pt),mt(this,n,()=>{P(this,n)&&(P(this,g)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ht(this,c,Gt).call(this),this.ctx.lineTo(...P(this,g)),mt(this,g,null),this.ctx.stroke()),window.requestAnimationFrame(P(this,n)))}),window.requestAnimationFrame(P(this,n))},et=new WeakSet,je=function(it,pt){const[V,j]=this.currentPath.at(-1);it===V&&pt===j||(this.currentPath.push([it,pt]),mt(this,g,[it,pt]))},bt=new WeakSet,Be=function(it,pt){var St;this.ctx.closePath(),mt(this,n,null),it=Math.min(Math.max(it,0),this.canvas.width),pt=Math.min(Math.max(pt,0),this.canvas.height);const[V,j]=this.currentPath.at(-1);(it!==V||pt!==j)&&this.currentPath.push([it,pt]);let B;if(this.currentPath.length!==1)B=(0,J.fitCurve)(this.currentPath,30,null);else{const Pt=[it,pt];B=[[Pt,Pt.slice(),Pt.slice(),Pt]]}const gt=ht(St=xt,st,be).call(St,B);this.currentPath.length=0;const _t=()=>{this.paths.push(B),this.bezierPath2D.push(gt),this.rebuild()},yt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ht(this,M,ee).call(this),ht(this,G,se).call(this)),ht(this,Tt,Kt).call(this))};this.parent.addCommands({cmd:_t,undo:yt,mustExec:!0})},c=new WeakSet,Gt=function(){if(this.isEmpty()){ht(this,w,ne).call(this);return}ht(this,z,ge).call(this);const{canvas:it,ctx:pt}=this;pt.setTransform(1,0,0,1,0,0),pt.clearRect(0,0,it.width,it.height),ht(this,w,ne).call(this);for(const V of this.bezierPath2D)pt.stroke(V)},E=new WeakSet,me=function(it){ht(this,bt,Be).call(this,it.offsetX,it.offsetY),this.canvas.removeEventListener("pointerleave",P(this,v)),this.canvas.removeEventListener("pointermove",P(this,C)),this.parent.addToAnnotationStorage(this)},M=new WeakSet,ee=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",xt._l10nPromise.get("editor_ink_canvas_aria_label").then(it=>{var pt;return(pt=this.canvas)==null?void 0:pt.setAttribute("aria-label",it)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},G=new WeakSet,se=function(){mt(this,m,new ResizeObserver(it=>{const pt=it[0].contentRect;pt.width&&pt.height&&this.setDimensions(pt.width,pt.height)})),P(this,m).observe(this.div)},i=new WeakSet,Yt=function(){if(!P(this,r))return;const[it,pt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*it),this.canvas.height=Math.ceil(this.height*pt),ht(this,w,ne).call(this)},p=new WeakSet,_e=function(it,pt){const V=ht(this,vt,ie).call(this),j=(it-V)/P(this,O),B=(pt-V)/P(this,k);this.scaleFactor=Math.min(j,B)},w=new WeakSet,ne=function(){const it=ht(this,vt,ie).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+it,this.translationY*this.scaleFactor+it)},st=new WeakSet,be=function(it){const pt=new Path2D;for(let V=0,j=it.length;V<j;V++){const[B,gt,_t,yt]=it[V];V===0&&pt.moveTo(...B),pt.bezierCurveTo(gt[0],gt[1],_t[0],_t[1],yt[0],yt[1])}return pt},Y=new WeakSet,We=function(it,pt,V,j){const gt=[],_t=this.thickness/2;let yt,St;for(const Pt of this.paths){yt=[],St=[];for(let Dt=0,kt=Pt.length;Dt<kt;Dt++){const[Ct,Lt,It,jt]=Pt[Dt],wt=it*(Ct[0]+pt)+_t,Nt=j-it*(Ct[1]+V)-_t,Wt=it*(Lt[0]+pt)+_t,zt=j-it*(Lt[1]+V)-_t,Vt=it*(It[0]+pt)+_t,Ht=j-it*(It[1]+V)-_t,Ut=it*(jt[0]+pt)+_t,qt=j-it*(jt[1]+V)-_t;Dt===0&&(yt.push(wt,Nt),St.push(wt,Nt)),yt.push(Wt,zt,Vt,Ht,Ut,qt),ht(this,Z,qe).call(this,wt,Nt,Wt,zt,Vt,Ht,Ut,qt,4,St)}gt.push({bezier:yt,points:St})}return gt},Z=new WeakSet,qe=function(it,pt,V,j,B,gt,_t,yt,St,Pt){if(ht(this,ft,He).call(this,it,pt,V,j,B,gt,_t,yt)){Pt.push(_t,yt);return}for(let Dt=1;Dt<St-1;Dt++){const kt=Dt/St,Ct=1-kt;let Lt=kt*it+Ct*V,It=kt*pt+Ct*j,jt=kt*V+Ct*B,wt=kt*j+Ct*gt;const Nt=kt*B+Ct*_t,Wt=kt*gt+Ct*yt;Lt=kt*Lt+Ct*jt,It=kt*It+Ct*wt,jt=kt*jt+Ct*Nt,wt=kt*wt+Ct*Wt,Lt=kt*Lt+Ct*jt,It=kt*It+Ct*wt,Pt.push(Lt,It)}Pt.push(_t,yt)},ft=new WeakSet,He=function(it,pt,V,j,B,gt,_t,yt){const Pt=(3*V-2*it-_t)**2,Dt=(3*j-2*pt-yt)**2,kt=(3*B-it-2*_t)**2,Ct=(3*gt-pt-2*yt)**2;return Math.max(Pt,kt)+Math.max(Dt,Ct)<=10},ut=new WeakSet,Ae=function(){let it=1/0,pt=-1/0,V=1/0,j=-1/0;for(const B of this.paths)for(const[gt,_t,yt,St]of B){const Pt=S.Util.bezierBoundingBox(...gt,..._t,...yt,...St);it=Math.min(it,Pt[0]),V=Math.min(V,Pt[1]),pt=Math.max(pt,Pt[2]),j=Math.max(j,Pt[3])}return[it,V,pt,j]},vt=new WeakSet,ie=function(){return P(this,s)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Tt=new WeakSet,Kt=function(it=!1){if(this.isEmpty())return;if(!P(this,s)){ht(this,c,Gt).call(this);return}const pt=ht(this,ut,Ae).call(this),V=ht(this,vt,ie).call(this);mt(this,O,Math.max(tt,pt[2]-pt[0])),mt(this,k,Math.max(tt,pt[3]-pt[1]));const j=Math.ceil(V+P(this,O)*this.scaleFactor),B=Math.ceil(V+P(this,k)*this.scaleFactor),[gt,_t]=this.parent.viewportBaseDimensions;this.width=j/gt,this.height=B/_t,mt(this,_,j/B),ht(this,Ft,ye).call(this);const yt=this.translationX,St=this.translationY;this.translationX=-pt[0],this.translationY=-pt[1],ht(this,i,Yt).call(this),ht(this,c,Gt).call(this),mt(this,a,j),mt(this,e,B),this.setDims(j,B);const Pt=it?V/this.scaleFactor/2:0;this.translate(yt-this.translationX-Pt,St-this.translationY-Pt)},Ft=new WeakSet,ye=function(){const{style:it}=this.div;P(this,_)>=1?(it.minHeight=`${tt}px`,it.minWidth=`${Math.round(P(this,_)*tt)}px`):(it.minWidth=`${tt}px`,it.minHeight=`${Math.round(tt/P(this,_))}px`)},rt(N,st),Mt(N,"_defaultColor",null),Mt(N,"_defaultOpacity",1),Mt(N,"_defaultThickness",1),Mt(N,"_l10nPromise"),Mt(N,"_type","ink"),f.InkEditor=N},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.fitCurve=void 0;const S=Q(26);f.fitCurve=S},ot=>{function f(l,t,s){if(!Array.isArray(l))throw new TypeError("First argument should be an array");if(l.forEach(a=>{if(!Array.isArray(a)||a.some(e=>typeof e!="number")||a.length!==l[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),l=l.filter((a,e)=>e===0||!a.every((n,d)=>n===l[e-1][d])),l.length<2)return[];const r=l.length,g=O(l[1],l[0]),m=O(l[r-2],l[r-1]);return Q(l,g,m,t,s)}function Q(l,t,s,r,g){var a,e,n,d,T,b,u,x,K,nt,$,z,U;if(l.length===2)return z=C.vectorLen(C.subtract(l[0],l[1]))/3,a=[l[0],C.addArrays(l[0],C.mulItems(t,z)),C.addArrays(l[1],C.mulItems(s,z)),l[1]],[a];if(e=tt(l),[a,d,b]=S(l,e,e,t,s,g),d===0||d<r)return[a];if(d<r*r)for(n=e,T=d,u=b,U=0;U<20;U++){if(n=J(a,l,n),[a,d,b]=S(l,e,n,t,s,g),d<r)return[a];if(b===u){let W=d/T;if(W>.9999&&W<1.0001)break}T=d,u=b}return $=[],x=C.subtract(l[b-1],l[b+1]),x.every(W=>W===0)&&(x=C.subtract(l[b-1],l[b]),[x[0],x[1]]=[-x[1],x[0]]),K=C.normalize(x),nt=C.mulItems(K,-1),$=$.concat(Q(l.slice(0,b+1),t,K,r,g)),$=$.concat(Q(l.slice(b),nt,s,r,g)),$}function S(l,t,s,r,g,m){var a,e,n;return a=y(l,s,r,g),[e,n]=N(l,a,t),m&&m({bez:a,points:l,params:t,maxErr:e,maxPoint:n}),[a,e,n]}function y(l,t,s,r){var g,m,a,e,n,d,T,b,u,x,K,nt,$,z,U,W,H,et=l[0],lt=l[l.length-1];for(g=[et,null,null,lt],m=C.zeros_Xx2x2(t.length),$=0,z=t.length;$<z;$++)W=t[$],H=1-W,a=m[$],a[0]=C.mulItems(s,3*W*(H*H)),a[1]=C.mulItems(r,3*H*(W*W));for(e=[[0,0],[0,0]],n=[0,0],$=0,z=l.length;$<z;$++)W=t[$],a=m[$],e[0][0]+=C.dot(a[0],a[0]),e[0][1]+=C.dot(a[0],a[1]),e[1][0]+=C.dot(a[0],a[1]),e[1][1]+=C.dot(a[1],a[1]),U=C.subtract(l[$],v.q([et,et,lt,lt],W)),n[0]+=C.dot(a[0],U),n[1]+=C.dot(a[1],U);return d=e[0][0]*e[1][1]-e[1][0]*e[0][1],T=e[0][0]*n[1]-e[1][0]*n[0],b=n[0]*e[1][1]-n[1]*e[0][1],u=d===0?0:b/d,x=d===0?0:T/d,nt=C.vectorLen(C.subtract(et,lt)),K=1e-6*nt,u<K||x<K?(g[1]=C.addArrays(et,C.mulItems(s,nt/3)),g[2]=C.addArrays(lt,C.mulItems(r,nt/3))):(g[1]=C.addArrays(et,C.mulItems(s,u)),g[2]=C.addArrays(lt,C.mulItems(r,x))),g}function J(l,t,s){return s.map((r,g)=>X(l,t[g],r))}function X(l,t,s){var r=C.subtract(v.q(l,s),t),g=v.qprime(l,s),m=C.mulMatrix(r,g),a=C.sum(C.squareItems(g))+2*C.mulMatrix(r,v.qprimeprime(l,s));return a===0?s:s-m/a}function tt(l){var t=[],s,r,g;return l.forEach((m,a)=>{s=a?r+C.vectorLen(C.subtract(m,g)):0,t.push(s),r=s,g=m}),t=t.map(m=>m/r),t}function N(l,t,s){var r,g,m,a,e,n,d,T;g=0,m=Math.floor(l.length/2);const b=_(t,10);for(e=0,n=l.length;e<n;e++)d=l[e],T=k(t,s[e],b,10),a=C.subtract(v.q(t,T),d),r=a[0]*a[0]+a[1]*a[1],r>g&&(g=r,m=e);return[g,m]}var _=function(l,t){for(var s,r=[0],g=l[0],m=0,a=1;a<=t;a++)s=v.q(l,a/t),m+=C.vectorLen(C.subtract(s,g)),r.push(m),g=s;return r=r.map(e=>e/m),r};function k(l,t,s,r){if(t<0)return 0;if(t>1)return 1;for(var g,m,a,e,n,d=1;d<=r;d++)if(t<=s[d]){e=(d-1)/r,a=d/r,m=s[d-1],g=s[d],n=(t-m)/(g-m)*(a-e)+e;break}return n}function O(l,t){return C.normalize(C.subtract(l,t))}class C{static zeros_Xx2x2(t){for(var s=[];t--;)s.push([0,0]);return s}static mulItems(t,s){return t.map(r=>r*s)}static mulMatrix(t,s){return t.reduce((r,g,m)=>r+g*s[m],0)}static subtract(t,s){return t.map((r,g)=>r-s[g])}static addArrays(t,s){return t.map((r,g)=>r+s[g])}static addItems(t,s){return t.map(r=>r+s)}static sum(t){return t.reduce((s,r)=>s+r)}static dot(t,s){return C.mulMatrix(t,s)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,s){return t.map(r=>r/s)}static squareItems(t){return t.map(s=>s*s)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class v{static q(t,s){var r=1-s,g=C.mulItems(t[0],r*r*r),m=C.mulItems(t[1],3*r*r*s),a=C.mulItems(t[2],3*r*s*s),e=C.mulItems(t[3],s*s*s);return C.addArrays(C.addArrays(g,m),C.addArrays(a,e))}static qprime(t,s){var r=1-s,g=C.mulItems(C.subtract(t[1],t[0]),3*r*r),m=C.mulItems(C.subtract(t[2],t[1]),6*r*s),a=C.mulItems(C.subtract(t[3],t[2]),3*s*s);return C.addArrays(C.addArrays(g,m),a)}static qprimeprime(t,s){return C.addArrays(C.mulItems(C.addArrays(C.subtract(t[2],C.mulItems(t[1],2)),t[0]),6*(1-s)),C.mulItems(C.addArrays(C.subtract(t[3],C.mulItems(t[2],2)),t[1]),6*s))}}ot.exports=f,ot.exports.fitCubic=Q,ot.exports.createTangent=O},(ot,f,Q)=>{var c,ve,E,Se,M,Ee;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationLayer=void 0;var S=Q(1),y=Q(8),J=Q(5),X=Q(28),tt=Q(29);const N=1e3,_=9,k=new WeakSet;function O(q){return{width:q[2]-q[0],height:q[3]-q[1]}}class C{static create(i){switch(i.data.annotationType){case S.AnnotationType.LINK:return new l(i);case S.AnnotationType.TEXT:return new t(i);case S.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new r(i);case"Btn":return i.data.radioButton?new m(i):i.data.checkBox?new g(i):new a(i);case"Ch":return new e(i)}return new s(i);case S.AnnotationType.POPUP:return new n(i);case S.AnnotationType.FREETEXT:return new T(i);case S.AnnotationType.LINE:return new b(i);case S.AnnotationType.SQUARE:return new u(i);case S.AnnotationType.CIRCLE:return new x(i);case S.AnnotationType.POLYLINE:return new K(i);case S.AnnotationType.CARET:return new $(i);case S.AnnotationType.INK:return new z(i);case S.AnnotationType.POLYGON:return new nt(i);case S.AnnotationType.HIGHLIGHT:return new U(i);case S.AnnotationType.UNDERLINE:return new W(i);case S.AnnotationType.SQUIGGLY:return new H(i);case S.AnnotationType.STRIKEOUT:return new et(i);case S.AnnotationType.STAMP:return new lt(i);case S.AnnotationType.FILEATTACHMENT:return new bt(i);default:return new v(i)}}}class v{constructor(i,{isRenderable:h=!1,ignoreBorder:p=!1,createQuadrilaterals:A=!1}={}){this.isRenderable=h,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,h&&(this.container=this._createContainer(p)),A&&(this.quadrilaterals=this._createQuadrilaterals(p))}_createContainer(i=!1){const h=this.data,p=this.page,A=this.viewport,w=document.createElement("section"),{width:L,height:st}=O(h.rect),[dt,Y,at,Z]=A.viewBox,ct=at-dt,ft=Z-Y;w.setAttribute("data-annotation-id",h.id);const F=S.Util.normalizeRect([h.rect[0],p.view[3]-h.rect[1]+p.view[1],h.rect[2],p.view[3]-h.rect[3]+p.view[1]]);if(!i&&h.borderStyle.width>0){w.style.borderWidth=`${h.borderStyle.width}px`;const At=h.borderStyle.horizontalCornerRadius,vt=h.borderStyle.verticalCornerRadius;if(At>0||vt>0){const Tt=`calc(${At}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;w.style.borderRadius=Tt}else if(this instanceof m){const Tt=`calc(${L}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;w.style.borderRadius=Tt}switch(h.borderStyle.style){case S.AnnotationBorderStyleType.SOLID:w.style.borderStyle="solid";break;case S.AnnotationBorderStyleType.DASHED:w.style.borderStyle="dashed";break;case S.AnnotationBorderStyleType.BEVELED:(0,S.warn)("Unimplemented border style: beveled");break;case S.AnnotationBorderStyleType.INSET:(0,S.warn)("Unimplemented border style: inset");break;case S.AnnotationBorderStyleType.UNDERLINE:w.style.borderBottomStyle="solid";break}const Et=h.borderColor||null;Et?w.style.borderColor=S.Util.makeHexColor(Et[0]|0,Et[1]|0,Et[2]|0):w.style.borderWidth=0}w.style.left=`${100*(F[0]-dt)/ct}%`,w.style.top=`${100*(F[1]-Y)/ft}%`;const{rotation:ut}=h;return h.hasOwnCanvas||ut===0?(w.style.width=`${100*L/ct}%`,w.style.height=`${100*st/ft}%`):this.setRotation(ut,w),w}setRotation(i,h=this.container){const[p,A,w,L]=this.viewport.viewBox,st=w-p,dt=L-A,{width:Y,height:at}=O(this.data.rect);let Z,ct;i%180===0?(Z=100*Y/st,ct=100*at/dt):(Z=100*at/st,ct=100*Y/dt),h.style.width=`${Z}%`,h.style.height=`${ct}%`,h.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(h,p,A)=>{const w=A.detail[h];A.target.style[p]=X.ColorConverters[`${w[0]}_HTML`](w.slice(1))};return(0,S.shadow)(this,"_commonActions",{display:h=>{const p=h.detail.display%2===1;this.container.style.visibility=p?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:p,print:h.detail.display===0||h.detail.display===3})},print:h=>{this.annotationStorage.setValue(this.data.id,{print:h.detail.print})},hidden:h=>{this.container.style.visibility=h.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:h.detail.hidden})},focus:h=>{setTimeout(()=>h.target.focus({preventScroll:!1}),0)},userName:h=>{h.target.title=h.detail.userName},readonly:h=>{h.detail.readonly?h.target.setAttribute("readonly",""):h.target.removeAttribute("readonly")},required:h=>{this._setRequired(h.target,h.detail.required)},bgColor:h=>{i("bgColor","backgroundColor",h)},fillColor:h=>{i("fillColor","backgroundColor",h)},fgColor:h=>{i("fgColor","color",h)},textColor:h=>{i("textColor","color",h)},borderColor:h=>{i("borderColor","borderColor",h)},strokeColor:h=>{i("strokeColor","borderColor",h)},rotation:h=>{const p=h.detail.rotation;this.setRotation(p),this.annotationStorage.setValue(this.data.id,{rotation:p})}})}_dispatchEventFromSandbox(i,h){const p=this._commonActions;for(const A of Object.keys(h.detail)){const w=i[A]||p[A];w&&w(h)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const h=this.annotationStorage.getRawValue(this.data.id);if(!h)return;const p=this._commonActions;for(const[A,w]of Object.entries(h)){const L=p[A];if(L){const st={detail:{[A]:w},target:i};L(st),delete h[A]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const h=[],p=this.data.rect;for(const A of this.data.quadPoints)this.data.rect=[A[2].x,A[2].y,A[1].x,A[1].y],h.push(this._createContainer(i));return this.data.rect=p,h}_createPopup(i,h){let p=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,p=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",p.append(i));const w=new d({container:p,trigger:i,color:h.color,titleObj:h.titleObj,modificationDate:h.modificationDate,contentsObj:h.contentsObj,richText:h.richText,hideWrapper:!0}).render();w.style.left="100%",p.append(w)}_renderQuadrilaterals(i){for(const h of this.quadrilaterals)h.className=i;return this.quadrilaterals}render(){(0,S.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,h=null){const p=[];if(this._fieldObjects){const A=this._fieldObjects[i];if(A)for(const{page:w,id:L,exportValues:st}of A){if(w===-1||L===h)continue;const dt=typeof st=="string"?st:null,Y=document.querySelector(`[data-element-id="${L}"]`);if(Y&&!k.has(Y)){(0,S.warn)(`_getElementsByName - element not allowed: ${L}`);continue}p.push({id:L,exportValue:dt,domElement:Y})}return p}for(const A of document.getElementsByName(i)){const{id:w,exportValue:L}=A;w!==h&&k.has(A)&&p.push({id:w,exportValue:L,domElement:A})}return p}static get platform(){const i=typeof navigator<"u"?navigator.platform:"";return(0,S.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class l extends v{constructor(i,h=null){super(i,{isRenderable:!0,ignoreBorder:!!(h!=null&&h.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:h}=this,p=document.createElement("a");p.setAttribute("data-element-id",i.id);let A=!1;return i.url?(h.addLinkAttributes(p,i.url,i.newWindow),A=!0):i.action?(this._bindNamedAction(p,i.action),A=!0):i.dest?(this._bindLink(p,i.dest),A=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(p,i),A=!0),i.resetForm?(this._bindResetFormAction(p,i.resetForm),A=!0):this.isTooltipOnly&&!A&&(this._bindLink(p,""),A=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((w,L)=>{const st=L===0?p:p.cloneNode();return w.append(st),w}):(this.container.className="linkAnnotation",A&&this.container.append(p),this.container)}_bindLink(i,h){i.href=this.linkService.getDestinationHash(h),i.onclick=()=>(h&&this.linkService.goToDestination(h),!1),(h||h==="")&&(i.className="internalLink")}_bindNamedAction(i,h){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(h),!1),i.className="internalLink"}_bindJSAction(i,h){i.href=this.linkService.getAnchorUrl("");const p=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const A of Object.keys(h.actions)){const w=p.get(A);w&&(i[w]=()=>{var L;return(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h.id,name:A}}),!1})}i.onclick||(i.onclick=()=>!1),i.className="internalLink"}_bindResetFormAction(i,h){const p=i.onclick;if(p||(i.href=this.linkService.getAnchorUrl("")),i.className="internalLink",!this._fieldObjects){(0,S.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),p||(i.onclick=()=>!1);return}i.onclick=()=>{var at;p&&p();const{fields:A,refs:w,include:L}=h,st=[];if(A.length!==0||w.length!==0){const Z=new Set(w);for(const ct of A){const ft=this._fieldObjects[ct]||[];for(const{id:F}of ft)Z.add(F)}for(const ct of Object.values(this._fieldObjects))for(const ft of ct)Z.has(ft.id)===L&&st.push(ft)}else for(const Z of Object.values(this._fieldObjects))st.push(...Z);const dt=this.annotationStorage,Y=[];for(const Z of st){const{id:ct}=Z;switch(Y.push(ct),Z.type){case"text":{const F=Z.defaultValue||"";dt.setValue(ct,{value:F});break}case"checkbox":case"radiobutton":{const F=Z.defaultValue===Z.exportValues;dt.setValue(ct,{value:F});break}case"combobox":case"listbox":{const F=Z.defaultValue||"";dt.setValue(ct,{value:F});break}default:continue}const ft=document.querySelector(`[data-element-id="${ct}"]`);if(ft){if(!k.has(ft)){(0,S.warn)(`_bindResetFormAction - element not allowed: ${ct}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Y,name:"ResetForm"}})),!1}}}class t extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class s extends v{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:h,isMac:p}=v.platform;return h&&i.ctrlKey||p&&i.metaKey}_setEventListener(i,h,p,A){h.includes("mouse")?i.addEventListener(h,w=>{var L;(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:A(w),shift:w.shiftKey,modifier:this._getKeyModifier(w)}})}):i.addEventListener(h,w=>{var L;(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:p,value:A(w)}})})}_setEventListeners(i,h,p){var A;for(const[w,L]of h)(L==="Action"||(A=this.data.actions)!=null&&A[L])&&this._setEventListener(i,w,L,p)}_setBackgroundColor(i){const h=this.data.backgroundColor||null;i.style.backgroundColor=h===null?"transparent":S.Util.makeHexColor(h[0],h[1],h[2])}_setTextStyle(i){const h=["left","center","right"],{fontColor:p}=this.data.defaultAppearanceData,A=this.data.defaultAppearanceData.fontSize||_,w=i.style;let L;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]),dt=Math.round(st/(S.LINE_FACTOR*A))||1,Y=st/dt;L=Math.min(A,Math.round(Y/S.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]);L=Math.min(A,Math.round(st/S.LINE_FACTOR))}w.fontSize=`calc(${L}px * var(--scale-factor))`,w.color=S.Util.makeHexColor(p[0],p[1],p[2]),this.data.textAlignment!==null&&(w.textAlign=h[this.data.textAlignment])}_setRequired(i,h){h?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",h)}}class r extends s{constructor(i){const h=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:h})}setPropertyOnSiblings(i,h,p,A){const w=this.annotationStorage;for(const L of this._getElementsByName(i.name,i.id))L.domElement&&(L.domElement[h]=p),w.setValue(L.id,{[A]:p})}render(){var A;const i=this.annotationStorage,h=this.data.id;this.container.className="textWidgetAnnotation";let p=null;if(this.renderForms){const w=i.getValue(h,{value:this.data.fieldValue});let L=w.formattedValue||w.value||"";const st=i.getValue(h,{charLimit:this.data.maxLen}).charLimit;st&&L.length>st&&(L=L.slice(0,st));const dt={userValue:L,formattedValue:null,valueOnFocus:""};this.data.multiLine?(p=document.createElement("textarea"),p.textContent=L,this.data.doNotScroll&&(p.style.overflowY="hidden")):(p=document.createElement("input"),p.type="text",p.setAttribute("value",L),this.data.doNotScroll&&(p.style.overflowX="hidden")),k.add(p),p.setAttribute("data-element-id",h),p.disabled=this.data.readOnly,p.name=this.data.fieldName,p.tabIndex=N,this._setRequired(p,this.data.required),st&&(p.maxLength=st),p.addEventListener("input",at=>{i.setValue(h,{value:at.target.value}),this.setPropertyOnSiblings(p,"value",at.target.value,"value")}),p.addEventListener("resetform",at=>{const Z=this.data.defaultFieldValue??"";p.value=dt.userValue=Z,dt.formattedValue=null});let Y=at=>{const{formattedValue:Z}=dt;Z!=null&&(at.target.value=Z),at.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){p.addEventListener("focus",Z=>{dt.userValue&&(Z.target.value=dt.userValue),dt.valueOnFocus=Z.target.value}),p.addEventListener("updatefromsandbox",Z=>{const ct={value(ft){dt.userValue=ft.detail.value??"",i.setValue(h,{value:dt.userValue.toString()}),ft.target.value=dt.userValue},formattedValue(ft){const{formattedValue:F}=ft.detail;dt.formattedValue=F,F!=null&&ft.target!==document.activeElement&&(ft.target.value=F),i.setValue(h,{formattedValue:F})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var vt;const{charLimit:F}=ft.detail,{target:ut}=ft;if(F===0){ut.removeAttribute("maxLength");return}ut.setAttribute("maxLength",F);let At=dt.userValue;!At||At.length<=F||(At=At.slice(0,F),ut.value=dt.userValue=At,i.setValue(h,{value:At}),(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:ut.selectionStart,selEnd:ut.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,Z)}),p.addEventListener("keydown",Z=>{var F;let ct=-1;if(Z.key==="Escape"?ct=0:Z.key==="Enter"?ct=2:Z.key==="Tab"&&(ct=3),ct===-1)return;const{value:ft}=Z.target;dt.valueOnFocus!==ft&&(dt.userValue=ft,(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:ft,willCommit:!0,commitKey:ct,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}}))});const at=Y;Y=null,p.addEventListener("blur",Z=>{var ft;const{value:ct}=Z.target;dt.userValue=ct,this._mouseState.isDown&&dt.valueOnFocus!==ct&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:ct,willCommit:!0,commitKey:1,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}})),at(Z)}),(A=this.data.actions)!=null&&A.Keystroke&&p.addEventListener("beforeinput",Z=>{var Tt;const{data:ct,target:ft}=Z,{value:F,selectionStart:ut,selectionEnd:At}=ft;let vt=ut,Et=At;switch(Z.inputType){case"deleteWordBackward":{const Rt=F.substring(0,ut).match(/\w*[^\w]*$/);Rt&&(vt-=Rt[0].length);break}case"deleteWordForward":{const Rt=F.substring(ut).match(/^[^\w]*\w*/);Rt&&(Et+=Rt[0].length);break}case"deleteContentBackward":ut===At&&(vt-=1);break;case"deleteContentForward":ut===At&&(Et+=1);break}Z.preventDefault(),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:F,change:ct||"",willCommit:!1,selStart:vt,selEnd:Et}})}),this._setEventListeners(p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.value)}if(Y&&p.addEventListener("blur",Y),this.data.comb){const Z=(this.data.rect[2]-this.data.rect[0])/st;p.classList.add("comb"),p.style.letterSpacing=`calc(${Z}px * var(--scale-factor) - 1ch)`}}else p=document.createElement("div"),p.textContent=this.data.fieldValue,p.style.verticalAlign="middle",p.style.display="table-cell";return this._setTextStyle(p),this._setBackgroundColor(p),this._setDefaultPropertiesFromJS(p),this.container.append(p),this.container}}class g extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,h=this.data,p=h.id;let A=i.getValue(p,{value:h.exportValue===h.fieldValue}).value;typeof A=="string"&&(A=A!=="Off",i.setValue(p,{value:A})),this.container.className="buttonWidgetAnnotation checkBox";const w=document.createElement("input");return k.add(w),w.setAttribute("data-element-id",p),w.disabled=h.readOnly,this._setRequired(w,this.data.required),w.type="checkbox",w.name=h.fieldName,A&&w.setAttribute("checked",!0),w.setAttribute("exportValue",h.exportValue),w.tabIndex=N,w.addEventListener("change",L=>{const{name:st,checked:dt}=L.target;for(const Y of this._getElementsByName(st,p)){const at=dt&&Y.exportValue===h.exportValue;Y.domElement&&(Y.domElement.checked=at),i.setValue(Y.id,{value:at})}i.setValue(p,{value:dt})}),w.addEventListener("resetform",L=>{const st=h.defaultFieldValue||"Off";L.target.checked=st===h.exportValue}),this.enableScripting&&this.hasJSActions&&(w.addEventListener("updatefromsandbox",L=>{const st={value(dt){dt.target.checked=dt.detail.value!=="Off",i.setValue(p,{value:dt.target.checked})}};this._dispatchEventFromSandbox(st,L)}),this._setEventListeners(w,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],L=>L.target.checked)),this._setBackgroundColor(w),this._setDefaultPropertiesFromJS(w),this.container.append(w),this.container}}class m extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,h=this.data,p=h.id;let A=i.getValue(p,{value:h.fieldValue===h.buttonValue}).value;typeof A=="string"&&(A=A!==h.buttonValue,i.setValue(p,{value:A}));const w=document.createElement("input");if(k.add(w),w.setAttribute("data-element-id",p),w.disabled=h.readOnly,this._setRequired(w,this.data.required),w.type="radio",w.name=h.fieldName,A&&w.setAttribute("checked",!0),w.tabIndex=N,w.addEventListener("change",L=>{const{name:st,checked:dt}=L.target;for(const Y of this._getElementsByName(st,p))i.setValue(Y.id,{value:!1});i.setValue(p,{value:dt})}),w.addEventListener("resetform",L=>{const st=h.defaultFieldValue;L.target.checked=st!=null&&st===h.buttonValue}),this.enableScripting&&this.hasJSActions){const L=h.buttonValue;w.addEventListener("updatefromsandbox",st=>{const dt={value:Y=>{const at=L===Y.detail.value;for(const Z of this._getElementsByName(Y.target.name)){const ct=at&&Z.id===p;Z.domElement&&(Z.domElement.checked=ct),i.setValue(Z.id,{value:ct})}}};this._dispatchEventFromSandbox(dt,st)}),this._setEventListeners(w,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.checked)}return this._setBackgroundColor(w),this._setDefaultPropertiesFromJS(w),this.container.append(w),this.container}}class a extends l{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const h=i.lastChild;return this.enableScripting&&this.hasJSActions&&h&&(this._setDefaultPropertiesFromJS(h),h.addEventListener("updatefromsandbox",p=>{this._dispatchEventFromSandbox({},p)})),i}}class e extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,h=this.data.id,p=i.getValue(h,{value:this.data.fieldValue}),A=document.createElement("select");k.add(A),A.setAttribute("data-element-id",h),A.disabled=this.data.readOnly,this._setRequired(A,this.data.required),A.name=this.data.fieldName,A.tabIndex=N;let w=this.data.combo&&this.data.options.length>0;this.data.combo||(A.size=this.data.options.length,this.data.multiSelect&&(A.multiple=!0)),A.addEventListener("resetform",Y=>{const at=this.data.defaultFieldValue;for(const Z of A.options)Z.selected=Z.value===at});for(const Y of this.data.options){const at=document.createElement("option");at.textContent=Y.displayValue,at.value=Y.exportValue,p.value.includes(Y.exportValue)&&(at.setAttribute("selected",!0),w=!1),A.append(at)}let L=null;if(w){const Y=document.createElement("option");Y.value=" ",Y.setAttribute("hidden",!0),Y.setAttribute("selected",!0),A.prepend(Y),L=()=>{Y.remove(),A.removeEventListener("input",L),L=null},A.addEventListener("input",L)}const st=(Y,at)=>{const Z=at?"value":"textContent",ct=Y.target.options;return Y.target.multiple?Array.prototype.filter.call(ct,ft=>ft.selected).map(ft=>ft[Z]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][Z]},dt=Y=>{const at=Y.target.options;return Array.prototype.map.call(at,Z=>({displayValue:Z.textContent,exportValue:Z.value}))};return this.enableScripting&&this.hasJSActions?(A.addEventListener("updatefromsandbox",Y=>{const at={value(Z){L==null||L();const ct=Z.detail.value,ft=new Set(Array.isArray(ct)?ct:[ct]);for(const F of A.options)F.selected=ft.has(F.value);i.setValue(h,{value:st(Z,!0)})},multipleSelection(Z){A.multiple=!0},remove(Z){const ct=A.options,ft=Z.detail.remove;ct[ft].selected=!1,A.remove(ft),ct.length>0&&Array.prototype.findIndex.call(ct,ut=>ut.selected)===-1&&(ct[0].selected=!0),i.setValue(h,{value:st(Z,!0),items:dt(Z)})},clear(Z){for(;A.length!==0;)A.remove(0);i.setValue(h,{value:null,items:[]})},insert(Z){const{index:ct,displayValue:ft,exportValue:F}=Z.detail.insert,ut=A.children[ct],At=document.createElement("option");At.textContent=ft,At.value=F,ut?ut.before(At):A.append(At),i.setValue(h,{value:st(Z,!0),items:dt(Z)})},items(Z){const{items:ct}=Z.detail;for(;A.length!==0;)A.remove(0);for(const ft of ct){const{displayValue:F,exportValue:ut}=ft,At=document.createElement("option");At.textContent=F,At.value=ut,A.append(At)}A.options.length>0&&(A.options[0].selected=!0),i.setValue(h,{value:st(Z,!0),items:dt(Z)})},indices(Z){const ct=new Set(Z.detail.indices);for(const ft of Z.target.options)ft.selected=ct.has(ft.index);i.setValue(h,{value:st(Z,!0)})},editable(Z){Z.target.disabled=!Z.detail.editable}};this._dispatchEventFromSandbox(at,Y)}),A.addEventListener("input",Y=>{var ct;const at=st(Y,!0),Z=st(Y,!1);i.setValue(h,{value:at}),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Z,changeEx:at,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Y=>Y.target.checked)):A.addEventListener("input",function(Y){i.setValue(h,{value:st(Y,!0)})}),this.data.combo&&this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class n extends v{constructor(i){var p,A,w;const h=!!((p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h})}render(){const i=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",i.includes(this.data.parentType))return this.container;const h=`[data-annotation-id="${this.data.parentId}"]`,p=this.layer.querySelectorAll(h);if(p.length===0)return this.container;const A=new d({container:this.container,trigger:Array.from(p),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),w=this.page,L=S.Util.normalizeRect([this.data.parentRect[0],w.view[3]-this.data.parentRect[1]+w.view[1],this.data.parentRect[2],w.view[3]-this.data.parentRect[3]+w.view[1]]),st=L[0]+this.data.parentRect[2]-this.data.parentRect[0],dt=L[1],[Y,at,Z,ct]=this.viewport.viewBox,ft=Z-Y,F=ct-at;return this.container.style.left=`${100*(st-Y)/ft}%`,this.container.style.top=`${100*(dt-at)/F}%`,this.container.append(A.render()),this.container}}class d{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var st,dt;const h=document.createElement("div");h.className="popupWrapper",this.hideElement=this.hideWrapper?h:this.container,this.hideElement.hidden=!0;const p=document.createElement("div");p.className="popup";const A=this.color;if(A){const Y=.7*(255-A[0])+A[0],at=.7*(255-A[1])+A[1],Z=.7*(255-A[2])+A[2];p.style.backgroundColor=S.Util.makeHexColor(Y|0,at|0,Z|0)}const w=document.createElement("h1");w.dir=this.titleObj.dir,w.textContent=this.titleObj.str,p.append(w);const L=y.PDFDateString.toDateObject(this.modificationDate);if(L){const Y=document.createElement("span");Y.className="popupDate",Y.textContent="{{date}}, {{time}}",Y.dataset.l10nId="annotation_date_string",Y.dataset.l10nArgs=JSON.stringify({date:L.toLocaleDateString(),time:L.toLocaleTimeString()}),p.append(Y)}if((st=this.richText)!=null&&st.str&&(!((dt=this.contentsObj)!=null&&dt.str)||this.contentsObj.str===this.richText.str))tt.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:p}),p.lastChild.className="richText popupContent";else{const Y=this._formatContents(this.contentsObj);p.append(Y)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Y of this.trigger)Y.addEventListener("click",this._toggle.bind(this)),Y.addEventListener("mouseover",this._show.bind(this,!1)),Y.addEventListener("mouseout",this._hide.bind(this,!1));return p.addEventListener("click",this._hide.bind(this,!0)),h.append(p),h}_formatContents({str:i,dir:h}){const p=document.createElement("p");p.className="popupContent",p.dir=h;const A=i.split(/(?:\r\n?|\n)/);for(let w=0,L=A.length;w<L;++w){const st=A[w];p.append(document.createTextNode(st)),w<L-1&&p.append(document.createElement("br"))}return p}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class T extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const h of this.textContent){const p=document.createElement("span");p.textContent=h,i.append(p)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class b extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:h,height:p}=O(i.rect),A=this.svgFactory.create(h,p,!0),w=this.svgFactory.createElement("svg:line");return w.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),w.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),w.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),w.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),w.setAttribute("stroke-width",i.borderStyle.width||1),w.setAttribute("stroke","transparent"),w.setAttribute("fill","transparent"),A.append(w),this.container.append(A),this._createPopup(w,i),this.container}}class u extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:h,height:p}=O(i.rect),A=this.svgFactory.create(h,p,!0),w=i.borderStyle.width,L=this.svgFactory.createElement("svg:rect");return L.setAttribute("x",w/2),L.setAttribute("y",w/2),L.setAttribute("width",h-w),L.setAttribute("height",p-w),L.setAttribute("stroke-width",w||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),A.append(L),this.container.append(A),this._createPopup(L,i),this.container}}class x extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:h,height:p}=O(i.rect),A=this.svgFactory.create(h,p,!0),w=i.borderStyle.width,L=this.svgFactory.createElement("svg:ellipse");return L.setAttribute("cx",h/2),L.setAttribute("cy",p/2),L.setAttribute("rx",h/2-w/2),L.setAttribute("ry",p/2-w/2),L.setAttribute("stroke-width",w||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),A.append(L),this.container.append(A),this._createPopup(L,i),this.container}}class K extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:h,height:p}=O(i.rect),A=this.svgFactory.create(h,p,!0);let w=[];for(const st of i.vertices){const dt=st.x-i.rect[0],Y=i.rect[3]-st.y;w.push(dt+","+Y)}w=w.join(" ");const L=this.svgFactory.createElement(this.svgElementName);return L.setAttribute("points",w),L.setAttribute("stroke-width",i.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),A.append(L),this.container.append(A),this._createPopup(L,i),this.container}}class nt extends K{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $ extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class z extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:h,height:p}=O(i.rect),A=this.svgFactory.create(h,p,!0);for(const w of i.inkLists){let L=[];for(const dt of w){const Y=dt.x-i.rect[0],at=i.rect[3]-dt.y;L.push(`${Y},${at}`)}L=L.join(" ");const st=this.svgFactory.createElement(this.svgElementName);st.setAttribute("points",L),st.setAttribute("stroke-width",i.borderStyle.width||1),st.setAttribute("stroke","transparent"),st.setAttribute("fill","transparent"),this._createPopup(st,i),A.append(st)}return this.container.append(A),this.container}}class U extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class W extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class H extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class et extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class lt extends v{constructor(i){var p,A,w;const h=!!(i.data.hasPopup||(p=i.data.titleObj)!=null&&p.str||(A=i.data.contentsObj)!=null&&A.str||(w=i.data.richText)!=null&&w.str);super(i,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bt extends v{constructor(i){var A;super(i,{isRenderable:!0});const{filename:h,content:p}=this.data.file;this.filename=(0,y.getFilenameFromUrl)(h),this.content=p,(A=this.linkService.eventBus)==null||A.dispatch("fileattachmentannotation",{source:this,filename:h,content:p})}render(){var h,p;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((h=this.data.titleObj)!=null&&h.str||(p=this.data.contentsObj)!=null&&p.str||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const G=class{static render(i){var st,dt;const{annotations:h,div:p,viewport:A,accessibilityManager:w}=i;ht(this,E,Se).call(this,p,A);let L=0;for(const Y of h){if(Y.annotationType!==S.AnnotationType.POPUP){const{width:Z,height:ct}=O(Y.rect);if(Z<=0||ct<=0)continue}const at=C.create({data:Y,layer:p,page:i.page,viewport:A,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new y.DOMSVGFactory,annotationStorage:i.annotationStorage||new J.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(at.isRenderable){const Z=at.render();if(Y.hidden&&(Z.style.visibility="hidden"),Array.isArray(Z))for(const ct of Z)ct.style.zIndex=L++,ht(st=G,c,ve).call(st,ct,Y.id,p,w);else Z.style.zIndex=L++,at instanceof n?p.prepend(Z):ht(dt=G,c,ve).call(dt,Z,Y.id,p,w)}}ht(this,M,Ee).call(this,p,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:h,div:p,viewport:A}=i;ht(this,E,Se).call(this,p,A),ht(this,M,Ee).call(this,p,h),p.hidden=!1}};let D=G;c=new WeakSet,ve=function(i,h,p,A){const w=i.firstChild||i;w.id=`${y.AnnotationPrefix}${h}`,p.append(i),A==null||A.moveElementInDOM(p,i,w,!1)},E=new WeakSet,Se=function(i,{width:h,height:p,rotation:A}){const{style:w}=i,L=A%180!==0,st=Math.floor(h)+"px",dt=Math.floor(p)+"px";w.width=L?dt:st,w.height=L?st:dt,i.setAttribute("data-main-rotation",A)},M=new WeakSet,Ee=function(i,h){if(h){for(const[p,A]of h){const w=i.querySelector(`[data-annotation-id="${p}"]`);if(!w)continue;const{firstChild:L}=w;L?L.nodeName==="CANVAS"?L.replaceWith(A):L.before(A):w.append(A)}h.clear()}},rt(D,c),rt(D,E),rt(D,M),f.AnnotationLayer=D},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.ColorConverters=void 0;function Q(y){return Math.floor(Math.max(0,Math.min(1,y))*255).toString(16).padStart(2,"0")}class S{static CMYK_G([J,X,tt,N]){return["G",1-Math.min(1,.3*J+.59*tt+.11*X+N)]}static G_CMYK([J]){return["CMYK",0,0,0,1-J]}static G_RGB([J]){return["RGB",J,J,J]}static G_HTML([J]){const X=Q(J);return`#${X}${X}${X}`}static RGB_G([J,X,tt]){return["G",.3*J+.59*X+.11*tt]}static RGB_HTML([J,X,tt]){const N=Q(J),_=Q(X),k=Q(tt);return`#${N}${_}${k}`}static T_HTML(){return"#00000000"}static CMYK_RGB([J,X,tt,N]){return["RGB",1-Math.min(1,J+N),1-Math.min(1,tt+N),1-Math.min(1,X+N)]}static CMYK_HTML(J){const X=this.CMYK_RGB(J).slice(1);return this.RGB_HTML(X)}static RGB_CMYK([J,X,tt]){const N=1-J,_=1-X,k=1-tt,O=Math.min(N,_,k);return["CMYK",N,_,k,O]}}f.ColorConverters=S},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.XfaLayer=void 0;var S=Q(20);class y{static setupStorage(X,tt,N,_,k){const O=_.getValue(tt,{value:null});switch(N.name){case"textarea":if(O.value!==null&&(X.textContent=O.value),k==="print")break;X.addEventListener("input",C=>{_.setValue(tt,{value:C.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(O.value===N.attributes.xfaOn?X.setAttribute("checked",!0):O.value===N.attributes.xfaOff&&X.removeAttribute("checked"),k==="print")break;X.addEventListener("change",C=>{_.setValue(tt,{value:C.target.checked?C.target.getAttribute("xfaOn"):C.target.getAttribute("xfaOff")})})}else{if(O.value!==null&&X.setAttribute("value",O.value),k==="print")break;X.addEventListener("input",C=>{_.setValue(tt,{value:C.target.value})})}break;case"select":if(O.value!==null)for(const C of N.children)C.attributes.value===O.value&&(C.attributes.selected=!0);X.addEventListener("input",C=>{const v=C.target.options,l=v.selectedIndex===-1?"":v[v.selectedIndex].value;_.setValue(tt,{value:l})});break}}static setAttributes({html:X,element:tt,storage:N=null,intent:_,linkService:k}){const{attributes:O}=tt,C=X instanceof HTMLAnchorElement;O.type==="radio"&&(O.name=`${O.name}-${_}`);for(const[v,l]of Object.entries(O))if(l!=null)switch(v){case"class":l.length&&X.setAttribute(v,l.join(" "));break;case"dataId":break;case"id":X.setAttribute("data-element-id",l);break;case"style":Object.assign(X.style,l);break;case"textContent":X.textContent=l;break;default:(!C||v!=="href"&&v!=="newWindow")&&X.setAttribute(v,l)}C&&k.addLinkAttributes(X,O.href,O.newWindow),N&&O.dataId&&this.setupStorage(X,O.dataId,tt,N)}static render(X){var t;const tt=X.annotationStorage,N=X.linkService,_=X.xfaHtml,k=X.intent||"display",O=document.createElement(_.name);_.attributes&&this.setAttributes({html:O,element:_,intent:k,linkService:N});const C=[[_,-1,O]],v=X.div;if(v.append(O),X.viewport){const s=`matrix(${X.viewport.transform.join(",")})`;v.style.transform=s}k!=="richText"&&v.setAttribute("class","xfaLayer xfaFont");const l=[];for(;C.length>0;){const[s,r,g]=C.at(-1);if(r+1===s.children.length){C.pop();continue}const m=s.children[++C.at(-1)[1]];if(m===null)continue;const{name:a}=m;if(a==="#text"){const n=document.createTextNode(m.value);l.push(n),g.append(n);continue}let e;if((t=m==null?void 0:m.attributes)!=null&&t.xmlns?e=document.createElementNS(m.attributes.xmlns,a):e=document.createElement(a),g.append(e),m.attributes&&this.setAttributes({html:e,element:m,storage:tt,intent:k,linkService:N}),m.children&&m.children.length>0)C.push([m,-1,e]);else if(m.value){const n=document.createTextNode(m.value);S.XfaText.shouldBuildText(a)&&l.push(n),e.append(n)}}for(const s of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:l}}static update(X){const tt=`matrix(${X.viewport.transform.join(",")})`;X.div.style.transform=tt,X.div.hidden=!1}}f.XfaLayer=y},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.TextLayerRenderTask=void 0,f.renderTextLayer=g;var S=Q(1),y=Q(8);const J=1e5,X=30,tt=.8,N=new Map,_=/^\s+$/g;function k(m,a){const e=N.get(m);if(e)return e;a.save(),a.font=`${X}px ${m}`;const n=a.measureText("");let d=n.fontBoundingBoxAscent,T=Math.abs(n.fontBoundingBoxDescent);if(d){a.restore();const u=d/(d+T);return N.set(m,u),u}a.strokeStyle="red",a.clearRect(0,0,X,X),a.strokeText("g",0,0);let b=a.getImageData(0,0,X,X).data;T=0;for(let u=b.length-1-3;u>=0;u-=4)if(b[u]>0){T=Math.ceil(u/4/X);break}a.clearRect(0,0,X,X),a.strokeText("A",0,X),b=a.getImageData(0,0,X,X).data,d=0;for(let u=0,x=b.length;u<x;u+=4)if(b[u]>0){d=X-Math.floor(u/4/X);break}if(a.restore(),d){const u=d/(d+T);return N.set(m,u),u}return N.set(m,tt),tt}function O(m,a,e,n){const d=document.createElement("span"),T=m._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:a.str!=="",hasEOL:a.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:a.str!=="",hasEOL:a.hasEOL,fontSize:0};m._textDivs.push(d);const b=S.Util.transform(m._viewport.transform,a.transform);let u=Math.atan2(b[1],b[0]);const x=e[a.fontName];x.vertical&&(u+=Math.PI/2);const K=Math.hypot(b[2],b[3]),nt=K*k(x.fontFamily,n);let $,z;u===0?($=b[4],z=b[5]-nt):($=b[4]+nt*Math.sin(u),z=b[5]-nt*Math.cos(u)),d.style.left=`${$}px`,d.style.top=`${z}px`,d.style.fontSize=`${K}px`,d.style.fontFamily=x.fontFamily,T.fontSize=K,d.setAttribute("role","presentation"),d.textContent=a.str,d.dir=a.dir,m._fontInspectorEnabled&&(d.dataset.fontName=a.fontName),u!==0&&(T.angle=u*(180/Math.PI));let U=!1;if(a.str.length>1||m._enhanceTextSelection&&_.test(a.str))U=!0;else if(a.str!==" "&&a.transform[0]!==a.transform[3]){const W=Math.abs(a.transform[0]),H=Math.abs(a.transform[3]);W!==H&&Math.max(W,H)/Math.min(W,H)>1.5&&(U=!0)}if(U&&(x.vertical?T.canvasWidth=a.height*m._viewport.scale:T.canvasWidth=a.width*m._viewport.scale),m._textDivProperties.set(d,T),m._textContentStream&&m._layoutText(d),m._enhanceTextSelection&&T.hasText){let W=1,H=0;u!==0&&(W=Math.cos(u),H=Math.sin(u));const et=(x.vertical?a.height:a.width)*m._viewport.scale,lt=K;let bt,D;u!==0?(bt=[W,H,-H,W,$,z],D=S.Util.getAxialAlignedBoundingBox([0,0,et,lt],bt)):D=[$,z,$+et,z+lt],m._bounds.push({left:D[0],top:D[1],right:D[2],bottom:D[3],div:d,size:[et,lt],m:bt})}}function C(m){if(m._canceled)return;const a=m._textDivs,e=m._capability,n=a.length;if(n>J){m._renderingDone=!0,e.resolve();return}if(!m._textContentStream)for(let d=0;d<n;d++)m._layoutText(a[d]);m._renderingDone=!0,e.resolve()}function v(m,a,e){let n=0;for(let d=0;d<e;d++){const T=m[a++];T>0&&(n=n?Math.min(T,n):T)}return n}function l(m){const a=m._bounds,e=m._viewport,n=t(e.width,e.height,a);for(let d=0;d<n.length;d++){const T=a[d].div,b=m._textDivProperties.get(T);if(b.angle===0){b.paddingLeft=a[d].left-n[d].left,b.paddingTop=a[d].top-n[d].top,b.paddingRight=n[d].right-a[d].right,b.paddingBottom=n[d].bottom-a[d].bottom,m._textDivProperties.set(T,b);continue}const u=n[d],x=a[d],K=x.m,nt=K[0],$=K[1],z=[[0,0],[0,x.size[1]],[x.size[0],0],x.size],U=new Float64Array(64);for(let H=0,et=z.length;H<et;H++){const lt=S.Util.applyTransform(z[H],K);U[H+0]=nt&&(u.left-lt[0])/nt,U[H+4]=$&&(u.top-lt[1])/$,U[H+8]=nt&&(u.right-lt[0])/nt,U[H+12]=$&&(u.bottom-lt[1])/$,U[H+16]=$&&(u.left-lt[0])/-$,U[H+20]=nt&&(u.top-lt[1])/nt,U[H+24]=$&&(u.right-lt[0])/-$,U[H+28]=nt&&(u.bottom-lt[1])/nt,U[H+32]=nt&&(u.left-lt[0])/-nt,U[H+36]=$&&(u.top-lt[1])/-$,U[H+40]=nt&&(u.right-lt[0])/-nt,U[H+44]=$&&(u.bottom-lt[1])/-$,U[H+48]=$&&(u.left-lt[0])/$,U[H+52]=nt&&(u.top-lt[1])/-nt,U[H+56]=$&&(u.right-lt[0])/$,U[H+60]=nt&&(u.bottom-lt[1])/-nt}const W=1+Math.min(Math.abs(nt),Math.abs($));b.paddingLeft=v(U,32,16)/W,b.paddingTop=v(U,48,16)/W,b.paddingRight=v(U,0,16)/W,b.paddingBottom=v(U,16,16)/W,m._textDivProperties.set(T,b)}}function t(m,a,e){const n=e.map(function(T,b){return{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom,index:b,x1New:void 0,x2New:void 0}});s(m,n);const d=new Array(e.length);for(const T of n){const b=T.index;d[b]={left:T.x1New,top:0,right:T.x2New,bottom:0}}e.map(function(T,b){const u=d[b],x=n[b];x.x1=T.top,x.y1=m-u.right,x.x2=T.bottom,x.y2=m-u.left,x.index=b,x.x1New=void 0,x.x2New=void 0}),s(a,n);for(const T of n){const b=T.index;d[b].top=T.x1New,d[b].bottom=T.x2New}return d}function s(m,a){a.sort(function(d,T){return d.x1-T.x1||d.index-T.index});const n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const d of a){let T=0;for(;T<n.length&&n[T].end<=d.y1;)T++;let b=n.length-1;for(;b>=0&&n[b].start>=d.y2;)b--;let u,x,K,nt,$=-1/0;for(K=T;K<=b;K++){u=n[K],x=u.boundary;let W;x.x2>d.x1?W=x.index>d.index?x.x1New:d.x1:x.x2New===void 0?W=(x.x2+d.x1)/2:W=x.x2New,W>$&&($=W)}for(d.x1New=$,K=T;K<=b;K++)u=n[K],x=u.boundary,x.x2New===void 0?x.x2>d.x1?x.index>d.index&&(x.x2New=x.x2):x.x2New=$:x.x2New>$&&(x.x2New=Math.max($,x.x2));const z=[];let U=null;for(K=T;K<=b;K++){u=n[K],x=u.boundary;const W=x.x2>d.x2?x:d;U===W?z.at(-1).end=u.end:(z.push({start:u.start,end:u.end,boundary:W}),U=W)}for(n[T].start<d.y1&&(z[0].start=d.y1,z.unshift({start:n[T].start,end:d.y1,boundary:n[T].boundary})),d.y2<n[b].end&&(z.at(-1).end=d.y2,z.push({start:d.y2,end:n[b].end,boundary:n[b].boundary})),K=T;K<=b;K++){if(u=n[K],x=u.boundary,x.x2New!==void 0)continue;let W=!1;for(nt=T-1;!W&&nt>=0&&n[nt].start>=x.y1;nt--)W=n[nt].boundary===x;for(nt=b+1;!W&&nt<n.length&&n[nt].end<=x.y2;nt++)W=n[nt].boundary===x;for(nt=0;!W&&nt<z.length;nt++)W=z[nt].boundary===x;W||(x.x2New=$)}Array.prototype.splice.apply(n,[T,b-T+1,...z])}for(const d of n){const T=d.boundary;T.x2New===void 0&&(T.x2New=Math.max(m,T.x2))}}class r{constructor({textContent:a,textContentStream:e,container:n,viewport:d,textDivs:T,textContentItemsStr:b,enhanceTextSelection:u}){var x;u&&(0,y.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=a,this._textContentStream=e,this._container=n,this._document=n.ownerDocument,this._viewport=d,this._textDivs=T||[],this._textContentItemsStr=b||[],this._enhanceTextSelection=!!u,this._fontInspectorEnabled=!!((x=globalThis.FontInspector)!=null&&x.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,S.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new S.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(a,e){for(let n=0,d=a.length;n<d;n++){if(a[n].str===void 0){if(a[n].type==="beginMarkedContentProps"||a[n].type==="beginMarkedContent"){const T=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),a[n].id!==null&&this._container.setAttribute("id",`${a[n].id}`),T.append(this._container)}else a[n].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(a[n].str),O(this,a[n],e,this._layoutTextCtx)}}_layoutText(a){const e=this._textDivProperties.get(a);let n="";if(e.canvasWidth!==0&&e.hasText){const{fontFamily:d}=a.style,{fontSize:T}=e;(T!==this._layoutTextLastFontSize||d!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${T*this._devicePixelRatio}px ${d}`,this._layoutTextLastFontSize=T,this._layoutTextLastFontFamily=d);const{width:b}=this._layoutTextCtx.measureText(a.textContent);if(b>0){const u=this._devicePixelRatio*e.canvasWidth/b;this._enhanceTextSelection&&(e.scale=u),n=`scaleX(${u})`}}if(e.angle!==0&&(n=`rotate(${e.angle}deg) ${n}`),n.length>0&&(this._enhanceTextSelection&&(e.originalTransform=n),a.style.transform=n),e.hasText&&this._container.append(a),e.hasEOL){const d=document.createElement("br");d.setAttribute("role","presentation"),this._container.append(d)}}_render(a=0){const e=(0,S.createPromiseCapability)();let n=Object.create(null);const d=this._document.createElement("canvas");if(d.height=d.width=X,this._layoutTextCtx=d.getContext("2d",{alpha:!1}),this._textContent){const T=this._textContent.items,b=this._textContent.styles;this._processItems(T,b),e.resolve()}else if(this._textContentStream){const T=()=>{this._reader.read().then(({value:b,done:u})=>{if(u){e.resolve();return}Object.assign(n,b.styles),this._processItems(b.items,n),T()},e.reject)};this._reader=this._textContentStream.getReader(),T()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');e.promise.then(()=>{n=null,a?this._renderTimer=setTimeout(()=>{C(this),this._renderTimer=null},a):C(this)},this._capability.reject)}expandTextDivs(a=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(l(this),this._bounds=null);const e=[],n=[];for(let d=0,T=this._textDivs.length;d<T;d++){const b=this._textDivs[d],u=this._textDivProperties.get(b);u.hasText&&(a?(e.length=0,n.length=0,u.originalTransform&&e.push(u.originalTransform),u.paddingTop>0?(n.push(`${u.paddingTop}px`),e.push(`translateY(${-u.paddingTop}px)`)):n.push(0),u.paddingRight>0?n.push(`${u.paddingRight/u.scale}px`):n.push(0),u.paddingBottom>0?n.push(`${u.paddingBottom}px`):n.push(0),u.paddingLeft>0?(n.push(`${u.paddingLeft/u.scale}px`),e.push(`translateX(${-u.paddingLeft/u.scale}px)`)):n.push(0),b.style.padding=n.join(" "),e.length&&(b.style.transform=e.join(" "))):(b.style.padding=null,b.style.transform=u.originalTransform))}}}f.TextLayerRenderTask=r;function g(m){const a=new r({textContent:m.textContent,textContentStream:m.textContentStream,container:m.container,viewport:m.viewport,textDivs:m.textDivs,textContentItemsStr:m.textContentItemsStr,enhanceTextSelection:m.enhanceTextSelection});return a._render(m.timeout),a}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.SVGGraphics=void 0;var S=Q(8),y=Q(1),J=Q(3);let X=class{constructor(){(0,y.unreachable)("Not implemented: SVGGraphics")}};f.SVGGraphics=X;{let t=function(e){let n=[];const d=[];for(const T of e){if(T.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),d.push(n),n=n.at(-1).items;continue}T.fn==="restore"?n=d.pop():n.push(T)}return n},s=function(e){if(Number.isInteger(e))return e.toString();const n=e.toFixed(10);let d=n.length-1;if(n[d]!=="0")return n;do d--;while(n[d]==="0");return n.substring(0,n[d]==="."?d:d+1)},r=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${s(e[0])} ${s(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const n=Math.acos(e[0])*180/Math.PI;return`rotate(${s(n)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${s(e[4])} ${s(e[5])})`;return`matrix(${s(e[0])} ${s(e[1])} ${s(e[2])} ${s(e[3])} ${s(e[4])} ${s(e[5])})`};const tt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},N="http://www.w3.org/XML/1998/namespace",_="http://www.w3.org/1999/xlink",k=["butt","round","square"],O=["miter","round","bevel"],C=function(e,n="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([e],{type:n}));const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let b=`data:${n};base64,`;for(let u=0,x=e.length;u<x;u+=3){const K=e[u]&255,nt=e[u+1]&255,$=e[u+2]&255,z=K>>2,U=(K&3)<<4|nt>>4,W=u+1<x?(nt&15)<<2|$>>6:64,H=u+2<x?$&63:64;b+=T[z]+T[U]+T[W]+T[H]}return b},v=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,d=new Int32Array(256);for(let $=0;$<256;$++){let z=$;for(let U=0;U<8;U++)z&1?z=3988292384^z>>1&2147483647:z=z>>1&2147483647;d[$]=z}function T($,z,U){let W=-1;for(let H=z;H<U;H++){const et=(W^$[H])&255,lt=d[et];W=W>>>8^lt}return W^-1}function b($,z,U,W){let H=W;const et=z.length;U[H]=et>>24&255,U[H+1]=et>>16&255,U[H+2]=et>>8&255,U[H+3]=et&255,H+=4,U[H]=$.charCodeAt(0)&255,U[H+1]=$.charCodeAt(1)&255,U[H+2]=$.charCodeAt(2)&255,U[H+3]=$.charCodeAt(3)&255,H+=4,U.set(z,H),H+=z.length;const lt=T(U,W+4,H);U[H]=lt>>24&255,U[H+1]=lt>>16&255,U[H+2]=lt>>8&255,U[H+3]=lt&255}function u($,z,U){let W=1,H=0;for(let et=z;et<U;++et)W=(W+($[et]&255))%65521,H=(H+W)%65521;return H<<16|W}function x($){if(!J.isNodeJS)return K($);try{let z;parseInt(process.versions.node)>=8?z=$:z=Buffer.from($);const U=require$$5.deflateSync(z,{level:9});return U instanceof Uint8Array?U:new Uint8Array(U)}catch(z){(0,y.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+z)}return K($)}function K($){let z=$.length;const U=65535,W=Math.ceil(z/U),H=new Uint8Array(2+z+W*5+4);let et=0;H[et++]=120,H[et++]=156;let lt=0;for(;z>U;)H[et++]=0,H[et++]=255,H[et++]=255,H[et++]=0,H[et++]=0,H.set($.subarray(lt,lt+U),et),et+=U,lt+=U,z-=U;H[et++]=1,H[et++]=z&255,H[et++]=z>>8&255,H[et++]=~z&65535&255,H[et++]=(~z&65535)>>8&255,H.set($.subarray(lt),et),et+=$.length-lt;const bt=u($,0,$.length);return H[et++]=bt>>24&255,H[et++]=bt>>16&255,H[et++]=bt>>8&255,H[et++]=bt&255,H}function nt($,z,U,W){const H=$.width,et=$.height;let lt,bt,D;const c=$.data;switch(z){case y.ImageKind.GRAYSCALE_1BPP:bt=0,lt=1,D=H+7>>3;break;case y.ImageKind.RGB_24BPP:bt=2,lt=8,D=H*3;break;case y.ImageKind.RGBA_32BPP:bt=6,lt=8,D=H*4;break;default:throw new Error("invalid format")}const o=new Uint8Array((1+D)*et);let E=0,R=0;for(let h=0;h<et;++h)o[E++]=0,o.set(c.subarray(R,R+D),E),R+=D,E+=D;if(z===y.ImageKind.GRAYSCALE_1BPP&&W){E=0;for(let h=0;h<et;h++){E++;for(let p=0;p<D;p++)o[E++]^=255}}const M=new Uint8Array([H>>24&255,H>>16&255,H>>8&255,H&255,et>>24&255,et>>16&255,et>>8&255,et&255,lt,bt,0,0,0]),I=x(o),G=e.length+n*3+M.length+I.length,q=new Uint8Array(G);let i=0;return q.set(e,i),i+=e.length,b("IHDR",M,q,i),i+=n+M.length,b("IDATA",I,q,i),i+=n+I.length,b("IEND",new Uint8Array(0),q,i),C(q,"image/png",U)}return function(z,U,W){const H=z.kind===void 0?y.ImageKind.GRAYSCALE_1BPP:z.kind;return nt(z,H,U,W)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=tt.fontWeight,this.fontSize=0,this.textMatrix=y.IDENTITY_MATRIX,this.fontMatrix=y.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=y.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=tt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,d){this.x=n,this.y=d}}let g=0,m=0,a=0;f.SVGGraphics=X=class{constructor(e,n,d=!1){(0,S.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new S.DOMSVGFactory,this.current=new l,this.transformMatrix=y.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!d,this._operatorIdMapping=[];for(const T in y.OPS)this._operatorIdMapping[y.OPS[T]]=T}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const n=e.fnArray,d=e.argsArray;for(let T=0,b=n.length;T<b;T++)if(n[T]===y.OPS.dependency)for(const u of d[T]){const x=u.startsWith("g_")?this.commonObjs:this.objs,K=new Promise(nt=>{x.get(u,nt)});this.current.dependencies.push(K)}return Promise.all(this.current.dependencies)}transform(e,n,d,T,b,u){const x=[e,n,d,T,b,u];this.transformMatrix=y.Util.transform(this.transformMatrix,x),this.tgrp=null}getSVG(e,n){this.viewport=n;const d=this._initialize(n);return this.loadDependencies(e).then(()=>(this.transformMatrix=y.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),d))}convertOpList(e){const n=this._operatorIdMapping,d=e.argsArray,T=e.fnArray,b=[];for(let u=0,x=T.length;u<x;u++){const K=T[u];b.push({fnId:K,fn:n[K],args:d[u]})}return t(b)}executeOpTree(e){for(const n of e){const d=n.fn,T=n.fnId,b=n.args;switch(T|0){case y.OPS.beginText:this.beginText();break;case y.OPS.dependency:break;case y.OPS.setLeading:this.setLeading(b);break;case y.OPS.setLeadingMoveText:this.setLeadingMoveText(b[0],b[1]);break;case y.OPS.setFont:this.setFont(b);break;case y.OPS.showText:this.showText(b[0]);break;case y.OPS.showSpacedText:this.showText(b[0]);break;case y.OPS.endText:this.endText();break;case y.OPS.moveText:this.moveText(b[0],b[1]);break;case y.OPS.setCharSpacing:this.setCharSpacing(b[0]);break;case y.OPS.setWordSpacing:this.setWordSpacing(b[0]);break;case y.OPS.setHScale:this.setHScale(b[0]);break;case y.OPS.setTextMatrix:this.setTextMatrix(b[0],b[1],b[2],b[3],b[4],b[5]);break;case y.OPS.setTextRise:this.setTextRise(b[0]);break;case y.OPS.setTextRenderingMode:this.setTextRenderingMode(b[0]);break;case y.OPS.setLineWidth:this.setLineWidth(b[0]);break;case y.OPS.setLineJoin:this.setLineJoin(b[0]);break;case y.OPS.setLineCap:this.setLineCap(b[0]);break;case y.OPS.setMiterLimit:this.setMiterLimit(b[0]);break;case y.OPS.setFillRGBColor:this.setFillRGBColor(b[0],b[1],b[2]);break;case y.OPS.setStrokeRGBColor:this.setStrokeRGBColor(b[0],b[1],b[2]);break;case y.OPS.setStrokeColorN:this.setStrokeColorN(b);break;case y.OPS.setFillColorN:this.setFillColorN(b);break;case y.OPS.shadingFill:this.shadingFill(b[0]);break;case y.OPS.setDash:this.setDash(b[0],b[1]);break;case y.OPS.setRenderingIntent:this.setRenderingIntent(b[0]);break;case y.OPS.setFlatness:this.setFlatness(b[0]);break;case y.OPS.setGState:this.setGState(b[0]);break;case y.OPS.fill:this.fill();break;case y.OPS.eoFill:this.eoFill();break;case y.OPS.stroke:this.stroke();break;case y.OPS.fillStroke:this.fillStroke();break;case y.OPS.eoFillStroke:this.eoFillStroke();break;case y.OPS.clip:this.clip("nonzero");break;case y.OPS.eoClip:this.clip("evenodd");break;case y.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case y.OPS.paintImageXObject:this.paintImageXObject(b[0]);break;case y.OPS.paintInlineImageXObject:this.paintInlineImageXObject(b[0]);break;case y.OPS.paintImageMaskXObject:this.paintImageMaskXObject(b[0]);break;case y.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(b[0],b[1]);break;case y.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case y.OPS.closePath:this.closePath();break;case y.OPS.closeStroke:this.closeStroke();break;case y.OPS.closeFillStroke:this.closeFillStroke();break;case y.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case y.OPS.nextLine:this.nextLine();break;case y.OPS.transform:this.transform(b[0],b[1],b[2],b[3],b[4],b[5]);break;case y.OPS.constructPath:this.constructPath(b[0],b[1]);break;case y.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,y.warn)(`Unimplemented operator ${d}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,n,d,T,b,u){const x=this.current;x.textMatrix=x.lineMatrix=[e,n,d,T,b,u],x.textMatrixScale=Math.hypot(e,n),x.x=x.lineX=0,x.y=x.lineY=0,x.xcoords=[],x.ycoords=[],x.tspan=this.svgFactory.createElement("svg:tspan"),x.tspan.setAttributeNS(null,"font-family",x.fontFamily),x.tspan.setAttributeNS(null,"font-size",`${s(x.fontSize)}px`),x.tspan.setAttributeNS(null,"y",s(-x.y)),x.txtElement=this.svgFactory.createElement("svg:text"),x.txtElement.append(x.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=y.IDENTITY_MATRIX,e.lineMatrix=y.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,n){const d=this.current;d.x=d.lineX+=e,d.y=d.lineY+=n,d.xcoords=[],d.ycoords=[],d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${s(d.fontSize)}px`),d.tspan.setAttributeNS(null,"y",s(-d.y))}showText(e){const n=this.current,d=n.font,T=n.fontSize;if(T===0)return;const b=n.fontSizeScale,u=n.charSpacing,x=n.wordSpacing,K=n.fontDirection,nt=n.textHScale*K,$=d.vertical,z=$?1:-1,U=d.defaultVMetrics,W=T*n.fontMatrix[0];let H=0;for(const bt of e){if(bt===null){H+=K*x;continue}else if(typeof bt=="number"){H+=z*bt*T/1e3;continue}const D=(bt.isSpace?x:0)+u,c=bt.fontChar;let o,E,R=bt.width;if($){let I;const G=bt.vmetric||U;I=bt.vmetric?G[1]:R*.5,I=-I*W;const q=G[2]*W;R=G?-G[0]:R,o=I/b,E=(H+q)/b}else o=H/b,E=0;(bt.isInFont||d.missingFile)&&(n.xcoords.push(n.x+o),$&&n.ycoords.push(-n.y+E),n.tspan.textContent+=c);let M;$?M=R*W-D*K:M=R*W+D*K,H+=M}n.tspan.setAttributeNS(null,"x",n.xcoords.map(s).join(" ")),$?n.tspan.setAttributeNS(null,"y",n.ycoords.map(s).join(" ")):n.tspan.setAttributeNS(null,"y",s(-n.y)),$?n.y-=H:n.x+=H*nt,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${s(n.fontSize)}px`),n.fontStyle!==tt.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==tt.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const et=n.textRenderingMode&y.TextRenderingMode.FILL_STROKE_MASK;if(et===y.TextRenderingMode.FILL||et===y.TextRenderingMode.FILL_STROKE?(n.fillColor!==tt.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===y.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),et===y.TextRenderingMode.STROKE||et===y.TextRenderingMode.FILL_STROKE){const bt=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,bt)}let lt=n.textMatrix;n.textRise!==0&&(lt=lt.slice(),lt[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${r(lt)} scale(${s(nt)}, -1)`),n.txtElement.setAttributeNS(N,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(e,n){this.setLeading(-n),this.moveText(e,n)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=C(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${n}); }
`}setFont(e){const n=this.current,d=this.commonObjs.get(e[0]);let T=e[1];n.font=d,this.embedFonts&&!d.missingFile&&!this.embeddedFonts[d.loadedName]&&(this.addFontStyle(d),this.embeddedFonts[d.loadedName]=d),n.fontMatrix=d.fontMatrix||y.FONT_IDENTITY_MATRIX;let b="normal";d.black?b="900":d.bold&&(b="bold");const u=d.italic?"italic":"normal";T<0?(T=-T,n.fontDirection=-1):n.fontDirection=1,n.fontSize=T,n.fontFamily=d.loadedName,n.fontWeight=b,n.fontStyle=u,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",s(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const e=this.current;e.textRenderingMode&y.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=e.txtElement)!=null&&n.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=k[e]}setLineJoin(e){this.current.lineJoin=O[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,n,d){this.current.strokeColor=y.Util.makeHexColor(e,n,d)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,n,d){this.current.fillColor=y.Util.makeHexColor(e,n,d),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const n=this.viewport.width,d=this.viewport.height,T=y.Util.inverseTransform(this.transformMatrix),b=y.Util.applyTransform([0,0],T),u=y.Util.applyTransform([0,d],T),x=y.Util.applyTransform([n,0],T),K=y.Util.applyTransform([n,d],T),nt=Math.min(b[0],u[0],x[0],K[0]),$=Math.min(b[1],u[1],x[1],K[1]),z=Math.max(b[0],u[0],x[0],K[0]),U=Math.max(b[1],u[1],x[1],K[1]),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x",nt),W.setAttributeNS(null,"y",$),W.setAttributeNS(null,"width",z-nt),W.setAttributeNS(null,"height",U-$),W.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&W.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(W)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const n=e[1],d=e[2],T=e[3]||y.IDENTITY_MATRIX,[b,u,x,K]=e[4],nt=e[5],$=e[6],z=e[7],U=`shading${a++}`,[W,H,et,lt]=y.Util.normalizeRect([...y.Util.applyTransform([b,u],T),...y.Util.applyTransform([x,K],T)]),[bt,D]=y.Util.singularValueDecompose2dScale(T),c=nt*bt,o=$*D,E=this.svgFactory.createElement("svg:pattern");E.setAttributeNS(null,"id",U),E.setAttributeNS(null,"patternUnits","userSpaceOnUse"),E.setAttributeNS(null,"width",c),E.setAttributeNS(null,"height",o),E.setAttributeNS(null,"x",`${W}`),E.setAttributeNS(null,"y",`${H}`);const R=this.svg,M=this.transformMatrix,I=this.current.fillColor,G=this.current.strokeColor,q=this.svgFactory.create(et-W,lt-H);if(this.svg=q,this.transformMatrix=T,z===2){const i=y.Util.makeHexColor(...n);this.current.fillColor=i,this.current.strokeColor=i}return this.executeOpTree(this.convertOpList(d)),this.svg=R,this.transformMatrix=M,this.current.fillColor=I,this.current.strokeColor=G,E.append(q.childNodes[0]),this.defs.append(E),`url(#${U})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const n=`shading${a++}`,d=e[3];let T;switch(e[1]){case"axial":const b=e[4],u=e[5];T=this.svgFactory.createElement("svg:linearGradient"),T.setAttributeNS(null,"id",n),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"x1",b[0]),T.setAttributeNS(null,"y1",b[1]),T.setAttributeNS(null,"x2",u[0]),T.setAttributeNS(null,"y2",u[1]);break;case"radial":const x=e[4],K=e[5],nt=e[6],$=e[7];T=this.svgFactory.createElement("svg:radialGradient"),T.setAttributeNS(null,"id",n),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"cx",K[0]),T.setAttributeNS(null,"cy",K[1]),T.setAttributeNS(null,"r",$),T.setAttributeNS(null,"fx",x[0]),T.setAttributeNS(null,"fy",x[1]),T.setAttributeNS(null,"fr",nt);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const b of d){const u=this.svgFactory.createElement("svg:stop");u.setAttributeNS(null,"offset",b[0]),u.setAttributeNS(null,"stop-color",b[1]),T.append(u)}return this.defs.append(T),`url(#${n})`;case"Mesh":return(0,y.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,n){this.current.dashArray=e,this.current.dashPhase=n}constructPath(e,n){const d=this.current;let T=d.x,b=d.y,u=[],x=0;for(const K of e)switch(K|0){case y.OPS.rectangle:T=n[x++],b=n[x++];const nt=n[x++],$=n[x++],z=T+nt,U=b+$;u.push("M",s(T),s(b),"L",s(z),s(b),"L",s(z),s(U),"L",s(T),s(U),"Z");break;case y.OPS.moveTo:T=n[x++],b=n[x++],u.push("M",s(T),s(b));break;case y.OPS.lineTo:T=n[x++],b=n[x++],u.push("L",s(T),s(b));break;case y.OPS.curveTo:T=n[x+4],b=n[x+5],u.push("C",s(n[x]),s(n[x+1]),s(n[x+2]),s(n[x+3]),s(T),s(b)),x+=6;break;case y.OPS.curveTo2:u.push("C",s(T),s(b),s(n[x]),s(n[x+1]),s(n[x+2]),s(n[x+3])),T=n[x+2],b=n[x+3],x+=4;break;case y.OPS.curveTo3:T=n[x+2],b=n[x+3],u.push("C",s(n[x]),s(n[x+1]),s(T),s(b),s(T),s(b)),x+=4;break;case y.OPS.closePath:u.push("Z");break}u=u.join(" "),d.path&&e.length>0&&e[0]!==y.OPS.rectangle&&e[0]!==y.OPS.moveTo?u=d.path.getAttributeNS(null,"d")+u:(d.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(d.path)),d.path.setAttributeNS(null,"d",u),d.path.setAttributeNS(null,"fill","none"),d.element=d.path,d.setCurrentPoint(T,b)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const n=`clippath${g++}`,d=this.svgFactory.createElement("svg:clipPath");d.setAttributeNS(null,"id",n),d.setAttributeNS(null,"transform",r(this.transformMatrix));const T=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?T.setAttributeNS(null,"clip-rule","evenodd"):T.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,d.append(T),this.defs.append(d),e.activeClipUrl){e.clipGroup=null;for(const b of this.extraStack)b.clipGroup=null;d.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const n=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",n)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[n,d]of e)switch(n){case"LW":this.setLineWidth(d);break;case"LC":this.setLineCap(d);break;case"LJ":this.setLineJoin(d);break;case"ML":this.setMiterLimit(d);break;case"D":this.setDash(d[0],d[1]);break;case"RI":this.setRenderingIntent(d);break;case"FL":this.setFlatness(d);break;case"Font":this.setFont(d);break;case"CA":this.setStrokeAlpha(d);break;case"ca":this.setFillAlpha(d);break;default:(0,y.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,n=1){const d=this.current;let T=d.dashArray;n!==1&&T.length>0&&(T=T.map(function(b){return n*b})),e.setAttributeNS(null,"stroke",d.strokeColor),e.setAttributeNS(null,"stroke-opacity",d.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",s(d.miterLimit)),e.setAttributeNS(null,"stroke-linecap",d.lineCap),e.setAttributeNS(null,"stroke-linejoin",d.lineJoin),e.setAttributeNS(null,"stroke-width",s(n*d.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",T.map(s).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",s(n*d.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const n=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!n){(0,y.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(e,n){const d=e.width,T=e.height,b=v(e,this.forceDataSchema,!!n),u=this.svgFactory.createElement("svg:rect");u.setAttributeNS(null,"x","0"),u.setAttributeNS(null,"y","0"),u.setAttributeNS(null,"width",s(d)),u.setAttributeNS(null,"height",s(T)),this.current.element=u,this.clip("nonzero");const x=this.svgFactory.createElement("svg:image");x.setAttributeNS(_,"xlink:href",b),x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y",s(-T)),x.setAttributeNS(null,"width",s(d)+"px"),x.setAttributeNS(null,"height",s(T)+"px"),x.setAttributeNS(null,"transform",`scale(${s(1/d)} ${s(-1/T)})`),n?n.append(x):this._ensureTransformGroup().append(x)}paintImageMaskXObject(e){const n=this.current,d=e.width,T=e.height,b=n.fillColor;n.maskId=`mask${m++}`;const u=this.svgFactory.createElement("svg:mask");u.setAttributeNS(null,"id",n.maskId);const x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y","0"),x.setAttributeNS(null,"width",s(d)),x.setAttributeNS(null,"height",s(T)),x.setAttributeNS(null,"fill",b),x.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(u),this._ensureTransformGroup().append(x),this.paintInlineImageXObject(e,u)}paintFormXObjectBegin(e,n){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),n){const d=n[2]-n[0],T=n[3]-n[1],b=this.svgFactory.createElement("svg:rect");b.setAttributeNS(null,"x",n[0]),b.setAttributeNS(null,"y",n[1]),b.setAttributeNS(null,"width",s(d)),b.setAttributeNS(null,"height",s(T)),this.current.element=b,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const n=this.svgFactory.create(e.width,e.height),d=this.svgFactory.createElement("svg:defs");n.append(d),this.defs=d;const T=this.svgFactory.createElement("svg:g");return T.setAttributeNS(null,"transform",r(e.transform)),n.append(T),this.svg=T,n}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFNodeStream=void 0;var S=Q(1),y=Q(33);const J=require$$5,X=require$$5,tt=require$$5,N=require$$5,_=/^file:\/\/\/[a-zA-Z]:\//;function k(m){const a=N.parse(m);return a.protocol==="file:"||a.host?a:/^[a-z]:[/\\]/i.test(m)?N.parse(`file:///${m}`):(a.host||(a.protocol="file:"),a)}class O{constructor(a){this.source=a,this.url=k(a.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&a.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var a;return((a=this._fullRequestReader)==null?void 0:a._loaded)??0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new r(this):new t(this),this._fullRequestReader}getRangeReader(a,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new g(this,a,e):new s(this,a,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(a){this._fullRequestReader&&this._fullRequestReader.cancel(a);for(const e of this._rangeRequestReaders.slice(0))e.cancel(a)}}f.PDFNodeStream=O;class C{constructor(a){this._url=a.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=a.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)(),this._headersCapability=(0,S.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const a=this._readableStream.read();return a===null?(this._readCapability=(0,S.createPromiseCapability)(),this.read()):(this._loaded+=a.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(a).buffer,done:!1})}cancel(a){if(!this._readableStream){this._error(a);return}this._readableStream.destroy(a)}_error(a){this._storedError=a,this._readCapability.resolve()}_setReadableStream(a){this._readableStream=a,a.on("readable",()=>{this._readCapability.resolve()}),a.on("end",()=>{a.destroy(),this._done=!0,this._readCapability.resolve()}),a.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new S.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class v{constructor(a){this._url=a.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)();const e=a.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const a=this._readableStream.read();return a===null?(this._readCapability=(0,S.createPromiseCapability)(),this.read()):(this._loaded+=a.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(a).buffer,done:!1})}cancel(a){if(!this._readableStream){this._error(a);return}this._readableStream.destroy(a)}_error(a){this._storedError=a,this._readCapability.resolve()}_setReadableStream(a){this._readableStream=a,a.on("readable",()=>{this._readCapability.resolve()}),a.on("end",()=>{a.destroy(),this._done=!0,this._readCapability.resolve()}),a.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(m,a){return{protocol:m.protocol,auth:m.auth,host:m.hostname,port:m.port,path:m.path,method:"GET",headers:a}}class t extends C{constructor(a){super(a);const e=n=>{if(n.statusCode===404){const u=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(n);const d=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:T,suggestedLength:b}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:a.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=T,this._contentLength=b||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(d)};this._request=null,this._url.protocol==="http:"?this._request=X.request(l(this._url,a.httpHeaders),e):this._request=tt.request(l(this._url,a.httpHeaders),e),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class s extends v{constructor(a,e,n){super(a),this._httpHeaders={};for(const T in a.httpHeaders){const b=a.httpHeaders[T];typeof b>"u"||(this._httpHeaders[T]=b)}this._httpHeaders.Range=`bytes=${e}-${n-1}`;const d=T=>{if(T.statusCode===404){const b=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=b;return}this._setReadableStream(T)};this._request=null,this._url.protocol==="http:"?this._request=X.request(l(this._url,this._httpHeaders),d):this._request=tt.request(l(this._url,this._httpHeaders),d),this._request.on("error",T=>{this._storedError=T}),this._request.end()}}class r extends C{constructor(a){super(a);let e=decodeURIComponent(this._url.path);_.test(this._url.href)&&(e=e.replace(/^\//,"")),J.lstat(e,(n,d)=>{if(n){n.code==="ENOENT"&&(n=new S.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=d.size,this._setReadableStream(J.createReadStream(e)),this._headersCapability.resolve()})}}class g extends v{constructor(a,e,n){super(a);let d=decodeURIComponent(this._url.path);_.test(this._url.href)&&(d=d.replace(/^\//,"")),this._setReadableStream(J.createReadStream(d,{start:e,end:n-1}))}}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.createResponseStatusError=N,f.extractFilenameFromHeader=tt,f.validateRangeRequestCapabilities=X,f.validateResponseStatus=_;var S=Q(1),y=Q(34),J=Q(8);function X({getResponseHeader:k,isHttp:O,rangeChunkSize:C,disableRange:v}){const l={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(k("Content-Length"),10);return!Number.isInteger(t)||(l.suggestedLength=t,t<=2*C)||v||!O||k("Accept-Ranges")!=="bytes"||(k("Content-Encoding")||"identity")!=="identity"||(l.allowRangeRequests=!0),l}function tt(k){const O=k("Content-Disposition");if(O){let C=(0,y.getFilenameFromContentDispositionHeader)(O);if(C.includes("%"))try{C=decodeURIComponent(C)}catch{}if((0,J.isPdfFile)(C))return C}return null}function N(k,O){return k===404||k===0&&O.startsWith("file:")?new S.MissingPDFException('Missing PDF "'+O+'".'):new S.UnexpectedResponseException(`Unexpected server response (${k}) while retrieving PDF "${O}".`,k)}function _(k){return k===200||k===206}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.getFilenameFromContentDispositionHeader=y;var S=Q(1);function y(J){let X=!0,tt=N("filename\\*","i").exec(J);if(tt){tt=tt[1];let t=C(tt);return t=unescape(t),t=v(t),t=l(t),k(t)}if(tt=O(J),tt){const t=l(tt);return k(t)}if(tt=N("filename","i").exec(J),tt){tt=tt[1];let t=C(tt);return t=l(t),k(t)}function N(t,s){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function _(t,s){if(t){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const r=new TextDecoder(t,{fatal:!0}),g=(0,S.stringToBytes)(s);s=r.decode(g),X=!1}catch{}}return s}function k(t){return X&&/[\x80-\xff]/.test(t)&&(t=_("utf-8",t),X&&(t=_("iso-8859-1",t))),t}function O(t){const s=[];let r;const g=N("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(r=g.exec(t))!==null;){let[,a,e,n]=r;if(a=parseInt(a,10),a in s){if(a===0)break;continue}s[a]=[e,n]}const m=[];for(let a=0;a<s.length&&a in s;++a){let[e,n]=s[a];n=C(n),e&&(n=unescape(n),a===0&&(n=v(n))),m.push(n)}return m.join("")}function C(t){if(t.startsWith('"')){const s=t.slice(1).split('\\"');for(let r=0;r<s.length;++r){const g=s[r].indexOf('"');g!==-1&&(s[r]=s[r].slice(0,g),s.length=r+1),s[r]=s[r].replace(/\\(.)/g,"$1")}t=s.join('"')}return t}function v(t){const s=t.indexOf("'");if(s===-1)return t;const r=t.slice(0,s),m=t.slice(s+1).replace(/^[^']*'/,"");return _(r,m)}function l(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,r,g,m){if(g==="q"||g==="Q")return m=m.replace(/_/g," "),m=m.replace(/=([0-9a-fA-F]{2})/g,function(a,e){return String.fromCharCode(parseInt(e,16))}),_(r,m);try{m=atob(m)}catch{}return _(r,m)})}return""}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFNetworkStream=void 0;var S=Q(1),y=Q(33);const J=200,X=206;function tt(C){const v=C.response;return typeof v!="string"?v:(0,S.stringToBytes)(v).buffer}class N{constructor(v,l={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.getXhr=l.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,l,t){const s={begin:v,end:l};for(const r in t)s[r]=t[r];return this.request(s)}requestFull(v){return this.request(v)}request(v){const l=this.getXhr(),t=this.currXhrId++,s=this.pendingRequests[t]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const r in this.httpHeaders){const g=this.httpHeaders[r];typeof g>"u"||l.setRequestHeader(r,g)}return this.isHttp&&"begin"in v&&"end"in v?(l.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),s.expectedStatus=X):s.expectedStatus=J,l.responseType="arraybuffer",v.onError&&(l.onerror=function(r){v.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,t),l.onprogress=this.onProgress.bind(this,t),s.onHeadersReceived=v.onHeadersReceived,s.onDone=v.onDone,s.onError=v.onError,s.onProgress=v.onProgress,l.send(null),t}onProgress(v,l){var s;const t=this.pendingRequests[v];t&&((s=t.onProgress)==null||s.call(t,l))}onStateChange(v,l){var a,e,n;const t=this.pendingRequests[v];if(!t)return;const s=t.xhr;if(s.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),s.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],s.status===0&&this.isHttp){(a=t.onError)==null||a.call(t,s.status);return}const r=s.status||J;if(!(r===J&&t.expectedStatus===X)&&r!==t.expectedStatus){(e=t.onError)==null||e.call(t,s.status);return}const m=tt(s);if(r===X){const d=s.getResponseHeader("Content-Range"),T=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);t.onDone({begin:parseInt(T[1],10),chunk:m})}else m?t.onDone({begin:0,chunk:m}):(n=t.onError)==null||n.call(t,s.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const l=this.pendingRequests[v].xhr;delete this.pendingRequests[v],l.abort()}}class _{constructor(v){this._source=v,this._manager=new N(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const l=this._rangeRequestReaders.indexOf(v);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new k(this._manager,this._source),this._fullRequestReader}getRangeReader(v,l){const t=new O(this._manager,v,l);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(v){var l;(l=this._fullRequestReader)==null||l.cancel(v);for(const t of this._rangeRequestReaders.slice(0))t.cancel(v)}}f.PDFNetworkStream=_;class k{constructor(v,l){this._manager=v;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=v.requestFull(t),this._headersReceivedCapability=(0,S.createPromiseCapability)(),this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,l=this._manager.getRequestXhr(v),t=g=>l.getResponseHeader(g),{allowRangeRequests:s,suggestedLength:r}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,y.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){var l;(l=this.onProgress)==null||l.call(this,{loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=(0,S.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class O{constructor(v,l,t){this._manager=v;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(l,t,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var v;(v=this.onClosed)==null||v.call(this,this)}_onDone(v){const l=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,y.createResponseStatusError)(v,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){var l;this.isStreamingSupported||(l=this.onProgress)==null||l.call(this,{loaded:v.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const v=(0,S.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(ot,f,Q)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFFetchStream=void 0;var S=Q(1),y=Q(33);function J(k,O,C){return{method:"GET",headers:k,signal:C.signal,mode:"cors",credentials:O?"include":"same-origin",redirect:"follow"}}function X(k){const O=new Headers;for(const C in k){const v=k[C];typeof v>"u"||O.append(C,v)}return O}class tt{constructor(O){this.source=O,this.isHttp=/^https?:/i.test(O.url),this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new N(this),this._fullRequestReader}getRangeReader(O,C){if(C<=this._progressiveDataLength)return null;const v=new _(this,O,C);return this._rangeRequestReaders.push(v),v}cancelAllRequests(O){this._fullRequestReader&&this._fullRequestReader.cancel(O);for(const C of this._rangeRequestReaders.slice(0))C.cancel(O)}}f.PDFFetchStream=tt;class N{constructor(O){this._stream=O,this._reader=null,this._loaded=0,this._filename=null;const C=O.source;this._withCredentials=C.withCredentials||!1,this._contentLength=C.length,this._headersCapability=(0,S.createPromiseCapability)(),this._disableRange=C.disableRange||!1,this._rangeChunkSize=C.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!C.disableStream,this._isRangeSupported=!C.disableRange,this._headers=X(this._stream.httpHeaders);const v=C.url;fetch(v,J(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,y.validateResponseStatus)(l.status))throw(0,y.createResponseStatusError)(l.status,v);this._reader=l.body.getReader(),this._headersCapability.resolve();const t=g=>l.headers.get(g),{allowRangeRequests:s,suggestedLength:r}=(0,y.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=(0,y.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new S.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:O,done:C}=await this._reader.read();return C?{value:O,done:C}:(this._loaded+=O.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){this._reader&&this._reader.cancel(O),this._abortController.abort()}}class _{constructor(O,C,v){this._stream=O,this._reader=null,this._loaded=0;const l=O.source;this._withCredentials=l.withCredentials||!1,this._readCapability=(0,S.createPromiseCapability)(),this._isStreamingSupported=!l.disableStream,this._abortController=new AbortController,this._headers=X(this._stream.httpHeaders),this._headers.append("Range",`bytes=${C}-${v-1}`);const t=l.url;fetch(t,J(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!(0,y.validateResponseStatus)(s.status))throw(0,y.createResponseStatusError)(s.status,t);this._readCapability.resolve(),this._reader=s.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:O,done:C}=await this._reader.read();return C?{value:O,done:C}:(this._loaded+=O.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(O).buffer,done:!1})}cancel(O){this._reader&&this._reader.cancel(O),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(ot){var f=__webpack_module_cache__[ot];if(f!==void 0)return f.exports;var Q=__webpack_module_cache__[ot]={exports:{}};return __webpack_modules__[ot](Q,Q.exports,__w_pdfjs_require__),Q.exports}var __webpack_exports__={};return(()=>{var ot=__webpack_exports__;Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"AnnotationEditorLayer",{enumerable:!0,get:function(){return y.AnnotationEditorLayer}}),Object.defineProperty(ot,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return f.AnnotationEditorParamsType}}),Object.defineProperty(ot,"AnnotationEditorType",{enumerable:!0,get:function(){return f.AnnotationEditorType}}),Object.defineProperty(ot,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return J.AnnotationEditorUIManager}}),Object.defineProperty(ot,"AnnotationLayer",{enumerable:!0,get:function(){return X.AnnotationLayer}}),Object.defineProperty(ot,"AnnotationMode",{enumerable:!0,get:function(){return f.AnnotationMode}}),Object.defineProperty(ot,"CMapCompressionType",{enumerable:!0,get:function(){return f.CMapCompressionType}}),Object.defineProperty(ot,"GlobalWorkerOptions",{enumerable:!0,get:function(){return tt.GlobalWorkerOptions}}),Object.defineProperty(ot,"InvalidPDFException",{enumerable:!0,get:function(){return f.InvalidPDFException}}),Object.defineProperty(ot,"LoopbackPort",{enumerable:!0,get:function(){return Q.LoopbackPort}}),Object.defineProperty(ot,"MissingPDFException",{enumerable:!0,get:function(){return f.MissingPDFException}}),Object.defineProperty(ot,"OPS",{enumerable:!0,get:function(){return f.OPS}}),Object.defineProperty(ot,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Q.PDFDataRangeTransport}}),Object.defineProperty(ot,"PDFDateString",{enumerable:!0,get:function(){return S.PDFDateString}}),Object.defineProperty(ot,"PDFWorker",{enumerable:!0,get:function(){return Q.PDFWorker}}),Object.defineProperty(ot,"PasswordResponses",{enumerable:!0,get:function(){return f.PasswordResponses}}),Object.defineProperty(ot,"PermissionFlag",{enumerable:!0,get:function(){return f.PermissionFlag}}),Object.defineProperty(ot,"PixelsPerInch",{enumerable:!0,get:function(){return S.PixelsPerInch}}),Object.defineProperty(ot,"RenderingCancelledException",{enumerable:!0,get:function(){return S.RenderingCancelledException}}),Object.defineProperty(ot,"SVGGraphics",{enumerable:!0,get:function(){return k.SVGGraphics}}),Object.defineProperty(ot,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return f.UNSUPPORTED_FEATURES}}),Object.defineProperty(ot,"UnexpectedResponseException",{enumerable:!0,get:function(){return f.UnexpectedResponseException}}),Object.defineProperty(ot,"Util",{enumerable:!0,get:function(){return f.Util}}),Object.defineProperty(ot,"VerbosityLevel",{enumerable:!0,get:function(){return f.VerbosityLevel}}),Object.defineProperty(ot,"XfaLayer",{enumerable:!0,get:function(){return O.XfaLayer}}),Object.defineProperty(ot,"build",{enumerable:!0,get:function(){return Q.build}}),Object.defineProperty(ot,"createPromiseCapability",{enumerable:!0,get:function(){return f.createPromiseCapability}}),Object.defineProperty(ot,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return f.createValidAbsoluteUrl}}),Object.defineProperty(ot,"getDocument",{enumerable:!0,get:function(){return Q.getDocument}}),Object.defineProperty(ot,"getFilenameFromUrl",{enumerable:!0,get:function(){return S.getFilenameFromUrl}}),Object.defineProperty(ot,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return S.getPdfFilenameFromUrl}}),Object.defineProperty(ot,"getXfaPageViewport",{enumerable:!0,get:function(){return S.getXfaPageViewport}}),Object.defineProperty(ot,"isPdfFile",{enumerable:!0,get:function(){return S.isPdfFile}}),Object.defineProperty(ot,"loadScript",{enumerable:!0,get:function(){return S.loadScript}}),Object.defineProperty(ot,"renderTextLayer",{enumerable:!0,get:function(){return _.renderTextLayer}}),Object.defineProperty(ot,"shadow",{enumerable:!0,get:function(){return f.shadow}}),Object.defineProperty(ot,"version",{enumerable:!0,get:function(){return Q.version}});var f=__w_pdfjs_require__(1),Q=__w_pdfjs_require__(4),S=__w_pdfjs_require__(8),y=__w_pdfjs_require__(22),J=__w_pdfjs_require__(7),X=__w_pdfjs_require__(27),tt=__w_pdfjs_require__(15),N=__w_pdfjs_require__(3),_=__w_pdfjs_require__(30),k=__w_pdfjs_require__(31),O=__w_pdfjs_require__(29);if(N.isNodeJS){const{PDFNodeStream:C}=__w_pdfjs_require__(32);(0,Q.setPDFNetworkStreamFactory)(v=>new C(v))}else{const{PDFNetworkStream:C}=__w_pdfjs_require__(35),{PDFFetchStream:v}=__w_pdfjs_require__(36);(0,Q.setPDFNetworkStreamFactory)(l=>(0,S.isValidFetchUrl)(l.url)?new v(l):new C(l))}})(),__webpack_exports__})())})(pdf$2);const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
