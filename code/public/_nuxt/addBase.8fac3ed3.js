import{a as se,e as oe,r as o,h as V,o as l,c as h,k as n,y as s,x as y,j as A,A as C,Q as ne,i as u,z as ue,l as m,F as S,s as E,K as ie,C as ce,D as de,m as ve,G as re}from"./entry.d811778a.js";import{_ as X}from"./robot.23bfda18.js";const _e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAnJJREFUSEutVj2LE1EUPXdmGCz8ASksVhB0UbGysFNsFAWzncKKBvIxQypBOyVZLG1swnxsIIorWkbcwmJFBMHC0gVXWHBBwRSWKZY4eVdvmAmTZF422d3XzXv3nnPnnjf3DGHKajabJ5RSeaXUFSI6CSAHwALQAbDJzB+Zec113R0dDGUdeJ63YJpmjZmXY8BpdchZWyl1L4togsD3/WUi8gAc3Qt17HyXiArlcvl1en+EYHV1taaUqs8JPBJuGEa9VCqtJJtDgjAMbzLzq4OAJ7nMfNtxnDV5HhBIzw3D+AbgyGEQAOgqpc6KJgMC3/fbRHTjkMATmOeVSuUuxdX/0IEz8xsiOgdgYSxmG8B3ANc0uZFpmovk+/5DInqcFSTgjuPkG41GzrKsDwBOxXGfoii6Wq1Wu0EQrOtIiOiBEGwQ0WVNFTu2bV8oFAqdFMmfBLzVauV6vd4XAMc0Bb6nIAh+x1+orktbtm1fSkhEQKk8Bk+/VVb+LyHgGcQdkkjsjOASGgnB3xnGwbDnkpWhibZGIfip6+G4oFK57I1pkgifRdLZS+StKIrOj/UcaU0sy/qccYUTsg0Kw/A+Mz+Zdk0zej7UJAzDt8x8XZP/iGTm9/t9GRMy5ycWEa0z85nxKolom5k3AeR1Aiiljg9GRRAEzwDcmeE2zRPSrlQqS+lh93UfHqAj3FVKLQ6HXTzwxGhezFOiLpaIbiXGM2I4nufVDcOoHYREKbXiuu7QtCYsMzae1j68ocvMbmI0SZFa0yeipzN6RATgpVjtTKafbo94xf/rKH8WFwGcJiL5kgWww8ziBe8sy2oXi0Xxhsz1Dw81OYUXiSuyAAAAAElFTkSuQmCC",pe=B=>(ce("data-v-8c2825ee"),B=B(),de(),B),me=pe(()=>s("div",{class:"modal-title"},"选择企业知识库",-1)),fe={class:"search"},he=["onClick"],ye={key:1,class:"bank-btn"},ge={key:2,class:"bank-btn"},be={class:"baseList"},ke={class:"baseList-item"},Ae={class:"baseList-item-content",style:{width:"100%",overflow:"hidden"}},we={class:"img"},Ce=["src"],xe={key:1,src:X,alt:""},Le={class:"name",style:{width:"100%"}},Ve={class:"sub"},Se={class:"baseList-item"},Be={class:"baseList-item-content",style:{width:"100%",overflow:"hidden"}},Ge={class:"img"},Ke=["src"],ze={key:1,src:X,alt:""},Ne={class:"name",style:{width:"100%"}},Ie={class:"sub"},Ee={class:"baseList-item"},Oe={class:"baseList-item-content",style:{width:"100%",overflow:"hidden"}},Ue={class:"img"},Re=["src"],Fe={key:1,src:X,alt:""},Te={class:"name",style:{width:"100%"}},Xe={class:"sub"},je={class:"bottom"},De={class:"bottom-name"},Me=se({__name:"addBase",props:{limit:{default:99999},systemShow:{type:Boolean,default:!0}},emits:["init"],setup(B,{expose:W,emit:$}){const j=B,H=oe(),{proxy:g}=ve(),G=o(!1),_=o(!1),b=o([]),d=o([]),x=o([]),k=o(""),K=o([]),p=o("0"),D=o([]),R=o([]),M=o([]),O=o([]),q=o([]),L=o(""),z=o(!1),N=o(!1),v=o({categoryCode:"",total:0,pageSize:1e3,pageNo:1,name:""}),Z=()=>{let t=[],a=[],r=[];if(t=R.value.filter(i=>b.value.includes(i.code)),a=M.value.filter(i=>b.value.includes(i.code)),r=O.value.filter(i=>b.value.includes(i.code)),x.value=t.concat(a).concat(r),x.value.length==0){g.$Message.error("请选择");return}let c=[],f=[];x.value.forEach((i,I)=>{if(b.value.indexOf(i.code)!=-1&&f.indexOf(i.code)==-1&&(f.push(i.code),c.push(i)),I==Number(x.value.length-1)){if(c.length>j.limit){g.$Message.error("最多选择"+j.limit+"个知识库");return}G.value=!1,$("init",c)}})},Y=()=>{k.value="",T()},J=()=>{let t={dataType:"ALL",robotCode:H.currentRoute.value.query.code,name:k.value};_.value=!0,g.$api.queryCateKnowledgeList(t).then(a=>{_.value=!1,d.value=[],R.value=[],q.value=a.data,a.data.forEach((r,c)=>{r.knowledgeListResVOList.forEach((f,i)=>{d.value.push({...f,cateName:r.cateName}),R.value.push({...f,cateName:r.cateName})})})})},P=t=>{x.value=d.value.filter(a=>t.includes(a.code))},ee=t=>{K.value=[],x.value=[],b.value=[],t&&t.length>0&&t.forEach(a=>{K.value.push(a.code)}),G.value=!0,g.$api.getKnowledgeCategoryList().then(a=>{D.value=a.data}),N.value=!1,g.$api.queryCateKnowledgeRecentList().then(a=>{O.value=a.data,a.data&&a.data.length>0?(N.value=!0,U("-1",a.data)):(N.value=!1,U("0")),z.value=!1,setTimeout(()=>{z.value=!0},100)}).catch(()=>{N.value=!1,U("0"),z.value=!1,setTimeout(()=>{z.value=!0},100)})},U=(t,a)=>{p.value=t,k.value="",t==-1&&(a&&a.length>0?d.value=a:g.$api.queryCateKnowledgeRecentList().then(r=>{d.value=r.data,O.value=r.data})),t==0&&J(),t==1&&(v.value.pageNo=1,v.value.name="",F())},F=()=>{d.value=[],_.value=!0,v.value.name=k.value,g.$api.getAssetKnowledgeList(v.value).then(t=>{d.value=t.data,M.value=t.data,_.value=!1}).catch(()=>{_.value=!1})},T=()=>{v.value.pageNo=1,p.value=="0"&&J(),p.value=="1"&&F(),p.value=="-1"&&(_.value=!0,v.value.name=k.value,g.$api.queryCateKnowledgeRecentList(v.value).then(t=>{_.value=!1,d.value=t.data,O.value=t.data}).catch(()=>{_.value=!1}))},Q=t=>{v.value.categoryCode=t.code?t.code:"",v.value.pageNo=1,F()};return W({showFn:ee}),(t,a)=>{const r=V("Input"),c=V("Button"),f=V("TabPane"),i=V("Tabs"),I=V("Checkbox"),ae=V("CheckboxGroup"),te=ie;return l(),h(te,{modelValue:G.value,"onUpdate:modelValue":a[6]||(a[6]=e=>G.value=e),"mask-closable":!1,modalWidth:788},{header:n(()=>[me]),footer:n(()=>[s("div",je,[s("div",De,"已选择"+y(b.value.length)+"个知识库",1),A(c,{onClick:Z,type:"primary",loading:_.value},{default:n(()=>[C("确定")]),_:1},8,["loading"]),A(c,{onClick:a[5]||(a[5]=e=>G.value=!1)},{default:n(()=>[C("取消")]),_:1})])]),default:n(()=>[s("div",fe,[A(r,{class:"search-input",modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),onKeydown:ne(T,["enter"]),placeholder:"请输入知识库名称"},{suffix:n(()=>[k.value?(l(),u("img",{key:0,onClick:ue(Y,["stop"]),class:"search-input-close",src:_e},null,8,he)):m("",!0)]),_:1},8,["modelValue","onKeydown"]),A(c,{type:"primary",loading:_.value,onClick:T},{default:n(()=>[C("查询")]),_:1},8,["loading"])]),z.value?(l(),h(i,{key:0,onOnClick:U,"model-value":p.value},{default:n(()=>[N.value?(l(),h(f,{key:0,label:"最近",name:"-1"})):m("",!0),A(f,{label:"企业知识库",name:"0"}),t.systemShow?(l(),h(f,{key:1,label:"系统知识库",name:"1"})):m("",!0)]),_:1},8,["model-value"])):m("",!0),p.value=="1"?(l(),u("div",ye,[A(c,{class:"bank-btn-item",onClick:a[1]||(a[1]=e=>Q("")),type:v.value.categoryCode==""?"primary":"default"},{default:n(()=>[C("全部")]),_:1},8,["type"]),(l(!0),u(S,null,E(D.value,(e,w)=>(l(),h(c,{class:"bank-btn-item",onClick:le=>Q(e),type:e.code==v.value.categoryCode?"primary":"default",key:w},{default:n(()=>[C(y(e.name),1)]),_:2},1032,["onClick","type"]))),128))])):m("",!0),p.value=="0"?(l(),u("div",ge,[A(c,{class:"bank-btn-item",type:L.value==""?"primary":"default",onClick:a[2]||(a[2]=e=>L.value="")},{default:n(()=>[C("全部")]),_:1},8,["type"]),(l(!0),u(S,null,E(q.value,(e,w)=>(l(),h(c,{class:"bank-btn-item",type:L.value==e.cateName?"primary":"default",onClick:le=>L.value=e.cateName,key:w},{default:n(()=>[C(y(e.cateName),1)]),_:2},1032,["type","onClick"]))),128))])):m("",!0),s("div",be,[A(ae,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),onOnChange:a[4]||(a[4]=e=>P(e))},{default:n(()=>[p.value=="-1"?(l(!0),u(S,{key:0},E(d.value,(e,w)=>(l(),h(I,{disabled:K.value.indexOf(e.code)!=-1,label:e.code},{default:n(()=>[s("div",ke,[s("div",Ae,[s("div",we,[e.avatar?(l(),u("img",{key:0,src:e.avatar,alt:""},null,8,Ce)):(l(),u("img",xe))]),s("div",Le,[s("div",null,y(e.name),1),s("div",Ve,y(e.permissionUser),1)])])])]),_:2},1032,["disabled","label"]))),256)):m("",!0),p.value=="0"?(l(!0),u(S,{key:1},E(d.value,(e,w)=>(l(),u(S,null,[L.value==""||L.value==e.cateName?(l(),h(I,{key:0,disabled:K.value.indexOf(e.code)!=-1,label:e.code},{default:n(()=>[s("div",Se,[s("div",Be,[s("div",Ge,[e.avatar?(l(),u("img",{key:0,src:e.avatar,alt:""},null,8,Ke)):(l(),u("img",ze))]),s("div",Ne,[s("div",null,y(e.name),1),s("div",Ie,y(e.permissionUser),1)])])])]),_:2},1032,["disabled","label"])):m("",!0)],64))),256)):m("",!0),p.value=="1"?(l(!0),u(S,{key:2},E(d.value,(e,w)=>(l(),h(I,{key:w,disabled:K.value.indexOf(e.code)!=-1,label:e.code},{default:n(()=>[s("div",Ee,[s("div",Oe,[s("div",Ue,[e.avatar?(l(),u("img",{key:0,src:e.avatar,alt:""},null,8,Re)):(l(),u("img",Fe))]),s("div",Te,[s("div",null,y(e.name),1),s("div",Xe,y(e.permissionUser),1)])])])]),_:2},1032,["disabled","label"]))),128)):m("",!0)]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}});const Qe=re(Me,[["__scopeId","data-v-8c2825ee"]]);export{Qe as _};
