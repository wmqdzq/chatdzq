import{a as ae,r as c,b as ie,e as le,h as b,i as a,y as e,u as f,j as p,k as m,l as i,x as u,A as _,F as g,s as $,B as ce,v as P,c as B,z as H,m as re,J,_ as de,C as ue,D as pe,o,G as me}from"./entry.d811778a.js";import{_ as _e}from"./previewImg.3bbe8181.js";import{_ as ve,d as he,e as ke,f as ye,g as fe,h as ge,j as Ae,k as Ce,l as Ee,m as Re,i as Se,a as Te,b as be,c as we}from"./icon12.6e5e51b3.js";import{_ as Ne}from"./bottom-arrow.2b2a94f1.js";import{h as Ie,c as W}from"./content.8ac9cfa6.js";import{T as Oe,M as Y}from"./index.b87a4887.js";import"./_commonjsHelpers.86de73f2.js";import"./_commonjs-dynamic-modules.302442b1.js";import"./transform.b1da36c5.js";const Le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAWpJREFUaEPtVjtuwzAMfTJ6hPZWHTq0Q8cMgewT2UKHjh2aIUNulR4hsAMFNqAASUWJJAqjzBiTT+9DWnZY+c+tnD9MwF8naAlYAkwHbISYBrLbLQG2hUwAS4BpILvdEmBbyAT4Pwn0ff/cNM3nbNjWe79nmnfVHkJ4AfAR/xzHcdN13YGCT04ghHAE8DiDnqZpem/bdkc5JFczDMOrc+4LwMNc++O9f8r1xee1AmKviIgb5CO2ioAY8XfiElvEHfInAG/UESUnENneO7BmnKSwigRIiZAiX7QD6UJxCHB6by11cQILSA2Rmp7cm6haQOk4aZCvHqHScdIiLyIgl8TlkOtLiv36TQ1kjRAliblmuWFFyYslkFnsVKfI7a2SAEGEOHnxBH4RoUJeTUAETj+PAYh/fi9miS1x7sLRem4CtJyl4loCVKe06iwBLWepuJYA1SmtOktAy1kqriVAdUqrzhLQcpaKu/oEzp9P3DHb+INaAAAAAElFTkSuQmCC",xe=""+new URL("more.a85658d9.svg",import.meta.url).href,l=S=>(ue("data-v-5a7285fe"),S=S(),pe(),S),Ue={class:"search"},De=l(()=>e("img",{src:Le},null,-1)),$e=l(()=>e("div",null,"返回",-1)),Pe=[De,$e],Be={class:"search-content"},He={key:0,class:"mosaic"},Je={class:"mosaic-btn"},Ve={class:"content-left"},qe={class:"left-h2"},Fe=l(()=>e("div",{class:"answer"},[e("img",{src:Ae}),e("div",null,"回答")],-1)),Me={key:0,class:"loading text-hide"},Qe=l(()=>e("div",{class:"spinnerCom fl mr-10"},null,-1)),je={class:"detailContent"},ze={class:"list"},Ge={class:"item"},We={class:"extend"},Ye=l(()=>e("div",null,"延伸阅读",-1)),Ke=l(()=>e("img",{src:Ne},null,-1)),Ze=[Ye,Ke],Xe={key:0,class:"extend-content"},et={class:"content-item"},tt=["title"],st=["href"],nt={key:0,class:"item",style:{display:"none"}},ot={class:"inquiry-title"},at=l(()=>e("img",{src:Ce},null,-1)),it={class:"inquiry-title-right"},lt=l(()=>e("img",{style:{"margin-left":"8px"},src:Re},null,-1)),ct=l(()=>e("div",{class:"popperClass2-item"},"导出WORD",-1)),rt=l(()=>e("div",{class:"popperClass2-item"},"导出PDF",-1)),dt={class:"inquiry-input"},ut=["onClick"],pt={class:"title"},mt=["src"],_t={key:0},vt={class:"fr"},ht=l(()=>e("em",{class:"right-arrow"},null,-1)),kt={key:0,class:"content"},yt={key:1,class:"references"},ft=["href"],gt={key:1,class:"content-right"},At={class:"area"},Ct={class:"title"},Et={key:0,src:ke},Rt={key:1,src:ye},St={key:0,src:fe},Tt={key:1,src:ge},bt={class:"content"},wt={key:0,style:{width:"calc(100% - 32px)","margin-left":"16px"}},Nt=l(()=>e("div",{class:"spinnerCom fl mr-10"},null,-1)),It={class:"content-text"},Ot=l(()=>e("div",{class:"markmap-content"},[e("svg",{id:"markmap",width:"100%",height:"100%",class:"w-screen h-screen leading-none markmap mm-dwm9rn-1"})],-1)),Lt={class:"markmap-action"},xt={key:0,class:"spinnerCom"},Ut=l(()=>e("div",null,null,-1)),Dt=l(()=>e("div",{class:"ppt-content"},[e("img",{src:Ee}),e("div",null,"生成PPT")],-1)),$t=l(()=>e("div",{class:"popperClass2-item"},"下载PPT",-1)),Pt=l(()=>e("div",{class:"popperClass2-item"},"去编辑PPT",-1)),Bt=l(()=>e("div",{class:"maxBrain"},[e("div",{class:"markmap-content",id:"searchCanvas"},[e("svg",{id:"markmap2",width:"100%",height:"100%",class:"w-screen h-screen leading-none markmap mm-dwm9rn-1"})])],-1)),Ht=ae({__name:"[code]",setup(S){const V=c(!0),v=c(""),q=new Oe;q.transform(v.value);const h=c(1),w=c(""),K=c("资料搜索中..."),Z=ie(),N=le(),{proxy:A}=re(),F=c("");c(!1);const I=c(!1),M=c([]),E=c(!1),O=c(!1),T=c(!1),Q=c(),C=c([{name:"相关事件",key:"RELATED_EVENTS",icon:Se,iconActive:"icon75_1",content:"",columns:[{title:"事件名称",key:"eventTitle"},{title:"事件概述",key:"eventDescribe"}],status:!1},{name:"相关组织",key:"ORGANIZE",icon:Te,iconActive:"icon76_1",content:"",columns:[{title:"组织名称",key:"organizeName"},{title:"概述",key:"organizeDescribe"}],status:!1},{name:"相关人物",key:"CHARACTER",icon:be,iconActive:"icon77_1",content:"",columns:[{title:"人物名称",key:"characterName"},{title:"概述",key:"characterDescribe"}],status:!1},{name:"参考文献",key:"REFERENCES",icon:we,iconActive:"icon78_1",content:"",status:!1}]),j=c({content:"",searchDepth:"CONCISE",searchScope:"WHOLE_NETWORK",learningScope:"",outputLanguage:"CN",extendedReadingFlag:!0});let L,x;const X=()=>{var n;A.$api.getAiSearchRecordDetail({code:(n=N.currentRoute.value.params)==null?void 0:n.code}).then(s=>{j.value.content=s.data.request,F.value=s.data.content,A.$isEmpty(s.data.extent)||(w.value=s.data.aiRecordCode,v.value=JSON.parse(s.data.extent).OUTLINE,C.value[0].content=JSON.parse(s.data.extent).EVENT,C.value[1].content=JSON.parse(s.data.extent).ORGANIZE,C.value[2].content=JSON.parse(s.data.extent).CHARACTER,C.value[3].content=JSON.parse(s.data.extent).REFERENCES,M.value=JSON.parse(s.data.extent).EXTENDED_READING),A.$isEmpty(v.value)&&(V.value=!1)})},ee=()=>{{let n=window.location.origin+"/share/search/"+w.value;A.$CopyTex(n)}},z=n=>{J("authtoken").value&&(h.value=n,n==2&&setTimeout(()=>{L=Y.create("#markmap"),x=Y.create("#markmap2"),setTimeout(()=>{te()},50)},100))},te=()=>{const{root:n,features:s}=q.transform(v.value);L.setData(n),L.fit(),x.setData(n),x.fit()},G=A.$debounce(n=>{T.value=!0;let s=document.getElementById("searchCanvas");Ie(s,{scale:4,width:s.offsetWidth,height:s.offsetHeight,useCORS:!0}).then(R=>{let d=document.body.appendChild(R);d.style.display="none",document.body.removeChild(d);let r=se(d.toDataURL("image/png"));const k=URL.createObjectURL(r);if(n==1&&(Q.value.showFn(k),T.value=!1),n==2){const y=new XMLHttpRequest;y.open("GET",k,!0),y.responseType="blob",y.onload=function(){const U=window.URL.createObjectURL(y.response),t=document.createElement("a");t.href=U,t.target="_blank",t.download="脑图",t.click(),t.remove(),A.$Message.success("已下载"),T.value=!1},y.send()}})},300),se=n=>{for(var s=n.split(","),R=s[0].match(/:(.*?);/)[1],d=atob(s[1]),r=d.length,k=new Uint8Array(r);r--;)k[r]=d.charCodeAt(r);return new Blob([k],{type:R})};return X(),(n,s)=>{const R=b("Button"),d=b("Poptip"),r=de,k=b("Input"),y=b("Table"),U=_e;return o(),a("div",Ue,[e("div",{class:"search-back",onClick:s[0]||(s[0]=t=>f(N).push("/"))},Pe),e("div",Be,[("useCookie"in n?n.useCookie:f(J))("authtoken").value?i("",!0):(o(),a("div",He,[e("div",Je,[p(R,{type:"primary",shape:"circle",onClick:s[1]||(s[1]=t=>f(N).push("/login"))},{default:m(()=>[_("请登录查看全部")]),_:1})])])),e("div",Ve,[e("h2",qe,u(j.value.content),1),Fe,n.loadStatus&&f(Z).isLoad?(o(),a("div",Me,[Qe,_(" "+u(K.value),1)])):i("",!0),e("div",je,[p(W,{content:F.value},null,8,["content"])]),e("div",ze,[e("ul",null,[e("li",Ge,[e("div",We,[e("div",{class:"extend-top",onClick:s[2]||(s[2]=t=>I.value=!I.value)},Ze),!n.$isEmpty(C.value[3].content)&&I.value?(o(),a("div",Xe,[(o(!0),a(g,null,$(M.value,t=>(o(),a("div",et,[e("div",{class:"snippet text-hide-2",title:t.snippet},u(t.snippet),9,tt),e("a",{target:"_blank",class:"text-hide",href:t.seeMoreUrl},[e("span",null,u(t.title),1)],8,st)]))),256))])):i("",!0)])]),n.$isEmpty(w.value)?i("",!0):(o(),a("li",nt,[e("div",{class:"inquiry",style:ce({height:E.value?"150px":"auto"})},[e("div",ot,[e("div",{class:"inquiry-title-left"},[e("div",{class:"left-action",onClick:ee},[at,_(" 分享 ")])]),e("div",it,[e("div",{style:{"padding-bottom":"4px"},onClick:s[3]||(s[3]=t=>E.value=!E.value)},"追问"),p(r,null,{default:m(()=>[p(d,{placement:"bottom","popper-class":"popperClass2"},{content:m(()=>[ct,rt]),default:m(()=>[lt]),_:1})]),_:1})])]),p(r,null,{default:m(()=>[e("div",dt,[E.value?(o(),B(k,{key:0,class:"inquiry-content",modelValue:n.questionContent,"onUpdate:modelValue":s[4]||(s[4]=t=>n.questionContent=t),type:"textarea",rows:3,placeholder:"继续提问..."},null,8,["modelValue"])):i("",!0),E.value?(o(),a("div",{key:1,class:"input-btn",onClick:s[5]||(s[5]=(...t)=>n.toQuestion&&n.toQuestion(...t))},"搜索")):i("",!0)])]),_:1})],4)])),(o(!0),a(g,null,$(C.value,(t,ne)=>(o(),a(g,null,[n.$isEmpty(t.content)?i("",!0):(o(),a("li",{class:P(["item",t.status?"active":""]),key:ne,onClick:D=>t.status=!t.status},[e("div",pt,[e("img",{src:t.icon,alt:""},null,8,mt),_(" "+u(t.name)+" ",1),n.$isEmpty(t.content)?i("",!0):(o(),a("text",_t,u(JSON.parse(t.content).length),1)),e("div",vt,[_(u(t.status?"收起":"展开")+" ",1),ht])]),n.$isEmpty(t.content)?i("",!0):(o(),a("div",kt,[t.key=="RELATED_EVENTS"||t.key=="ORGANIZE"||t.key=="CHARACTER"?(o(),B(y,{key:0,columns:t.columns,data:JSON.parse(t.content)||[]},null,8,["columns","data"])):i("",!0),t.key=="REFERENCES"?(o(),a("div",yt,[n.$isEmpty(t.content)?i("",!0):(o(!0),a(g,{key:0},$(JSON.parse(t.content),(D,oe)=>(o(),a("a",{class:"text-hide-2",target:"_blank",href:D.seeMoreUrl},u(oe+1)+" "+u(D.title),9,ft))),256))])):i("",!0)]))],10,ut))],64))),256))])])]),V.value?(o(),a("div",gt,[e("div",At,[e("div",Ct,[e("div",{class:P(["title-item",h.value==1?"title-item-active":""]),onClick:s[6]||(s[6]=t=>z(1)),style:{display:"flex"}},[h.value==1?(o(),a("img",Et)):(o(),a("img",Rt)),_(" 大纲 ")],2),e("div",{class:P(["title-item",h.value==2?"title-item-active":""]),onClick:s[7]||(s[7]=t=>z(2)),style:{display:"flex","margin-left":"24px"}},[h.value==2?(o(),a("img",St)):(o(),a("img",Tt)),_(" 脑图 ")],2)]),e("div",bt,[n.$isEmpty(v.value)?(o(),a("div",wt,[("useCookie"in n?n.useCookie:f(J))("authtoken").value?(o(),a(g,{key:0},[Nt,_("大纲生成中... ")],64)):i("",!0)])):i("",!0),e("div",It,[h.value==1?(o(),B(W,{key:0,content:v.value},null,8,["content"])):i("",!0),h.value==2?(o(),a(g,{key:1},[Ot,e("div",Lt,[T.value?(o(),a("div",xt)):(o(),a(g,{key:1},[e("img",{class:"action-item",onClick:s[8]||(s[8]=H(t=>f(G)(1),["stop"])),src:ve}),e("img",{class:"action-item",onClick:s[9]||(s[9]=H(t=>f(G)(2),["stop"])),src:he})],64))])],64)):i("",!0)])]),n.$isEmpty(v.value)?i("",!0):(o(),a("div",{key:0,class:"createPPT",onClick:s[12]||(s[12]=(...t)=>n.toCreatePPT&&n.toCreatePPT(...t)),style:{display:"none"}},[Ut,Dt,p(r,null,{default:m(()=>[p(d,{modelValue:O.value,"onUpdate:modelValue":s[11]||(s[11]=t=>O.value=t),placement:"bottom","popper-class":"popperClass2"},{content:m(()=>[$t,Pt]),default:m(()=>[e("img",{src:xe,onClick:s[10]||(s[10]=H(t=>O.value=!0,["stop"]))})]),_:1},8,["modelValue"])]),_:1})]))])])):i("",!0)]),p(U,{ref_key:"previewImgRef",ref:Q},null,512),Bt])}}});const Wt=me(Ht,[["__scopeId","data-v-5a7285fe"]]);export{Wt as default};
