import{a as A,t as M,r as y,P as Q,h as R,o as d,c as L,k as _,j as i,A as N,z as U,y as o,u as m,i as u,F as C,l as S,_ as z,K as E,C as O,D,m as F,G as T,x as $,s as q,B as K,f as P,w as W}from"./entry.b3d0478f.js";import{c as j}from"./content.2ef9ea5b.js";const g=r=>(O("data-v-3f579886"),r=r(),D(),r),G=g(()=>o("div",{class:"confirmTitle"},"更新数据",-1)),H={class:"confirm-list"},X={class:"confirm-list-item"},Y=g(()=>o("div",null,"辅助数据(只读)",-1)),Z=g(()=>o("div",{class:"mb-5"},"问题",-1)),ee=g(()=>o("div",{class:"mt-10 mb-5"},"答案",-1)),te={class:"confirm-list-item"},oe=g(()=>o("div",null,"相关数据内容(修改)",-1)),se=g(()=>o("div",{class:"mb-5"},"问题",-1)),ne=g(()=>o("div",{class:"mt-10 mb-5"},"答案",-1)),ae=A({__name:"modify",props:{code:String,knowledgeCode:String,tagCode:String},emits:["init"],setup(r,{expose:w,emit:v}){const h=r,{proxy:n}=F(),{code:k,knowledgeCode:f,tagCode:a}=M(h),c=y(!1),s=y(!0);let e=Q({});const b=t=>{c.value=!0,s.value=!1,e=JSON.parse(JSON.stringify(t)),e.request2=JSON.parse(JSON.stringify(e.request)),e.content2=JSON.parse(JSON.stringify(e.content))},V=()=>{let t={request:"",content:"",code:e.code,knowledgeCode:f.value,robotCode:k.value,tagType:e.type,tagCode:a.value};if(e.type=="QA"){if(n.$isEmpty(e.request)){n.$Message.error("请输入问题");return}if(n.$isEmpty(e.content)){n.$Message.error("请输入答案");return}t.request=e.request}else{if(n.$isEmpty(e.content)){n.$Message.error("请输入文本数据");return}t.request=e.content}t.content=e.content,s.value=!0,n.$api.space_editKnowledgeBase(t).then(()=>{c.value=!1,s.value=!1,n.$Message.success("变更数据成功"),v("init")}).catch(()=>{s.value=!1})};return w({showFn:b}),(t,l)=>{const x=R("Input"),B=z,I=R("Button"),J=E;return d(),L(J,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=p=>c.value=p),"mask-closable":!1,modalWidth:788},{header:_(()=>[G]),footer:_(()=>[i(I,{onClick:l[4]||(l[4]=U(p=>c.value=!1,["stop"]))},{default:_(()=>[N("取消")]),_:1}),i(I,{type:"primary",onClick:U(V,["stop"]),loading:s.value},{default:_(()=>[N("确定")]),_:1},8,["onClick","loading"])]),default:_(()=>[o("div",H,[o("div",X,[Y,m(e).type=="QA"?(d(),u(C,{key:0},[Z,i(x,{placeholder:"请输入问题",readonly:!0,maxlength:"25",modelValue:m(e).request2,"onUpdate:modelValue":l[0]||(l[0]=p=>m(e).request2=p)},null,8,["modelValue"]),ee],64)):S("",!0),i(B,null,{default:_(()=>[i(x,{type:"textarea",rows:16,readonly:!0,modelValue:m(e).content2,"onUpdate:modelValue":l[1]||(l[1]=p=>m(e).content2=p)},null,8,["modelValue"])]),_:1})]),o("div",te,[oe,m(e).type=="QA"?(d(),u(C,{key:0},[se,i(x,{placeholder:"请输入问题",maxlength:"20",modelValue:m(e).request,"onUpdate:modelValue":l[2]||(l[2]=p=>m(e).request=p)},null,8,["modelValue"]),ne],64)):S("",!0),i(B,null,{default:_(()=>[i(x,{type:"textarea",rows:16,modelValue:m(e).content,"onUpdate:modelValue":l[3]||(l[3]=p=>m(e).content=p)},null,8,["modelValue"])]),_:1})])])]),_:1},8,["modelValue"])}}});const le=T(ae,[["__scopeId","data-v-3f579886"]]),de=r=>(O("data-v-d29a04a3"),r=r(),D(),r),re={class:"modalTitle"},ce=de(()=>o("div",{class:"modal-notice"},[o("div",null,"注意：修改知识库内容成功后，此处不会显示。点击编辑后才显示最新的内容")],-1)),ie={class:"modal-content"},ue={class:"modal-content-item"},_e={class:"modal-content-item-degree"},pe={key:0},me={key:0},ve=["onClick"],fe={class:"modal-content-item-title"},ye={class:"modal-content-item-content"},Ce=A({__name:"quote",setup(r,{expose:w}){const v=y(!1),{proxy:h}=F(),n=y([]),k=y(),f=y({robotCode:"",aiRecordCode:""}),a=()=>{h.$api.queryKnowledgeBaseList({robotCode:f.value.robotCode,aiRecordCode:f.value.aiRecordCode}).then(s=>{v.value=!0,n.value=s.data})};return w({showFn:s=>{v.value=!0,f.value.robotCode=s.robotCode,f.value.aiRecordCode=s.aiRecordCode,a()}}),(s,e)=>{const b=R("Button"),V=E;return d(),u(C,null,[i(V,{class:"chatDataModal",modalWidth:788,modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),mask:!0,"mask-closable":!1},{header:_(()=>[o("div",re,"引用知识库("+$(n.value.length)+"条)",1)]),footer:_(()=>[i(b,{onClick:e[0]||(e[0]=t=>v.value=!1)},{default:_(()=>[N("关闭")]),_:1})]),default:_(()=>[ce,o("div",ie,[(d(!0),u(C,null,q(n.value,t=>(d(),u("div",ue,[o("div",_e,[o("div",null,"匹配度:"+$(t.score),1),o("div",null,[t.type!="STRUCTURE_DATA"?(d(),u("span",pe,$(t.knowledgeName),1)):S("",!0),t.knowledgeName&&t.fileName?(d(),u(C,{key:1},[t.type!="STRUCTURE_DATA"?(d(),u("span",me,"-")):S("",!0)],64)):S("",!0),N($(t.fileName),1)]),o("a",{class:"pointer",onClick:l=>s.$refs.modifyRef.showFn(t),style:K({visibility:t.type!="STRUCTURE_DATA"?"":"hidden"})},"编辑",12,ve)]),o("div",fe,$(t.titleName),1),o("div",ye,[i(j,{content:t.content},null,8,["content"])])]))),256))])]),_:1},8,["modelValue"]),i(le,{ref_key:"modifyRef",ref:k,code:f.value.robotCode,onInit:a},null,8,["code"])],64)}}});const be=T(Ce,[["__scopeId","data-v-d29a04a3"]]);const ge={class:"scroll-container"},he=["onClick"],ke={__name:"barrage",props:{list:Array},emits:["init"],setup(r,{emit:w}){const v=r,{list:h}=M(v),n=y([[],[],[]]);P(()=>{k(h.value)});const k=a=>{const c=Math.ceil(a.length/3);n.value=[a.slice(0,c),a.slice(c,2*c),a.slice(2*c)]},f=a=>{w("prompt",a)};return W(()=>h.value,a=>{k(a)},{deep:!0,immediate:!0}),(a,c)=>(d(),u("div",ge,[(d(),u(C,null,q(3,s=>o("div",{class:"scroll-wrapper",key:"wrapper-"+s},[(d(!0),u(C,null,q(n.value[s-1],(e,b)=>(d(),u("div",{class:"itemBox",key:"item-"+s+"-"+b,onClick:V=>f(e.promptContent)},$(e.promptContent),9,he))),128))])),64))]))}},Se=T(ke,[["__scopeId","data-v-00a926b4"]]);export{be as Q,Se as b};
