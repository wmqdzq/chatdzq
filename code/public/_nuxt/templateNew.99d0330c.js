import{a as le,r as d,I as ae,b as ie,t as ue,J as M,p as P,w as v,h as $,i as n,y as s,u as l,z as re,l as _,j as h,k as x,F as N,s as A,x as L,v as F,A as K,m as ce,_ as pe,C as de,D as me,o as a,G as _e}from"./entry.d811778a.js";import{_ as ve}from"./ossUploaderNew.392fe014.js";import{_ as fe}from"./previewImg.3bbe8181.js";import{_ as ge,a as he}from"./close3.bdd7467f.js";import{a as z}from"./recordNew.b010c077.js";const b=k=>(de("data-v-cb57057e"),k=k(),me(),k),ye={class:"inputContainer"},Ce={class:"input-paus"},Le=["onClick"],ke=b(()=>s("img",{class:"img",src:ge},null,-1)),Ie=b(()=>s("div",null,"停止生成",-1)),be=[ke,Ie],we={key:0,class:"appoint"},Se=b(()=>s("div",{class:"appoint-btn"},"@ 员工名",-1)),$e={class:"appoint-content"},Ne=["onClick"],Ae={class:"appoint-list"},Ee={class:"list-tag"},xe=["onClick"],Re={class:"icon pointer"},Te=b(()=>s("div",{class:"logo"},null,-1)),Be={key:0},Ue=b(()=>s("div",{class:"triangleRight"},null,-1)),Ve={key:0,class:"icon upload"},Oe={key:1,class:"icon internet"},Je={key:1,class:"fileListArea"},Me={key:0,class:"userImgListCom clearfix"},Pe={class:"userImgItem"},Fe={key:1,class:"userFileListCom clearfix"},Ke={class:"userFileItem"},ze=["onClick"],De=["src"],je={key:2,class:"agreement"},qe=["href"],Ge=le({name:"cInput",__name:"templateNew",props:{content:{},consumeEnergy:{},placeholder:{default:"请输入您要问的问题，通过Ctrl+回车换行"},robotCode:{},robotType:{},isUoload:{type:Boolean},isInternet:{type:Boolean},format:{},isAgreement:{type:Boolean,default:!0},isPaus:{type:Boolean,default:!0},isLoginCheck:{type:Boolean,default:!0},isAppoint:{type:Boolean,default:!1},userCodeList:{},userList:{},robotInfo:{default:{}},uploadLists:{}},emits:["update:content","update:isAgent","submit","upload","update:userCodeList","update:uploadLists","change"],setup(k,{emit:c}){const u=k,R=d(),T=ae(),y=ie(),I=d(!1),w=d(!1),E=d([]),p=d([]),{consumeEnergy:B,placeholder:U,robotCode:D,isLoginCheck:V,uploadLists:j}=ue(u);d();const{proxy:m}=ce(),i=d(null),S=d(!0),f=d(!1),O=m.$debounce(()=>{if(V.value&&!M("authtoken").value){T.push("/login");return}if(y.isLoad){m.$Message.error("请等机器人回复后再发送哦~");return}let e=JSON.parse(JSON.stringify(i.value));if(e=e?e.replace(/[\r\n]/g,"").trim():"",!e)m.$Message.error("你还没有输入问题呢！"),i.value=null;else{if(e.length>6e3){m.$Message.error("您输入的问题过长！");return}c("update:content",e),P(()=>{c("submit"),f.value=!0,setTimeout(()=>{i.value=null},50)})}},300),q=()=>{c("update:content",i.value),c("change",i.value)},G=m.$debounce(e=>{if(V.value&&!M("authtoken").value){T.push("/login");return}if(e.ctrlKey&&e.keyCode===13){let t=JSON.parse(JSON.stringify(i.value));t=t?t.replace(/[\r\n]/g,"").trim():"",t?i.value=i.value+`
`:(m.$Message.error("你还没有输入问题呢！"),i.value=null,f.value=!1)}if(!e.ctrlKey&&e.keyCode===13){let t=JSON.parse(JSON.stringify(i.value));if(t=t?t.replace(/[\r\n]/g,"").trim():"",!t)m.$Message.error("你还没有输入问题呢！"),f.value=!1,setTimeout(()=>{i.value=null},50);else{if(y.isLoad){m.$Message.error("请等机器人回复后再发送哦~");return}i.value=i.value.replace(/\n$/,""),c("update:content",t),P(()=>{c("submit"),f.value=!0,setTimeout(()=>{i.value=null},50)})}}},300),H=()=>{S.value=!S.value,c("update:isAgent",S.value)};let r=d({imgList:[],fileList:[]});const Q=e=>{e.forEach(t=>{const g=t.name.split(".").pop().toLowerCase();["jpg","jpeg","png","gif","bmp","webp"].includes(g)?r.value.imgList.push(t):r.value.fileList.push(t)})},W=()=>{y.resetStream(),y.abortReadingStream()},X=()=>{w.value=!0,E.value=[],m.$api.queryDigitalRobotInfoList().then(e=>{E.value=e.data,w.value=!1}).catch(()=>{w.value=!1})},Y=e=>{p.value.length===0?p.value.push(e):p.value.some(g=>g.userCode===e.userCode)||p.value.push(e),I.value=!1};return v(()=>u.content,()=>{i.value=u.content,(!u.content||u.content=="")&&(f.value=!1)},{deep:!0,immediate:!0}),v(()=>u.consumeEnergy,()=>{u.consumeEnergy==0?f.value=!0:f.value=!1},{deep:!0,immediate:!0}),v(()=>I.value,()=>{u.isAppoint&&I.value&&X()}),v(()=>p.value,()=>{c("update:userCodeList",[]);let e=[];p.value.forEach((t,g)=>{e.push(t.userCode),g==Number(p.value.length-1)&&c("update:userCodeList",e)})},{deep:!0}),v(()=>u.userList,e=>{p.value=e},{deep:!0}),v(()=>u.robotInfo,()=>{console.log(u.robotInfo),console.log(u.robotInfo)},{deep:!0}),v(()=>r.value,e=>{c("update:uploadLists",e)},{deep:!0}),v(()=>j.value,e=>{r.value=e},{deep:!0}),(e,t)=>{const g=$("Spin"),J=$("Poptip"),Z=$("Input"),ee=pe,te=ve,se=$("Image"),oe=fe;return a(),n("div",ye,[s("div",Ce,[l(y).isLoad&&u.isPaus?(a(),n("div",{key:0,class:"input-top",onClick:re(W,["stop"])},be,8,Le)):_("",!0)]),e.robotInfo&&e.robotInfo.type&&e.robotInfo.type=="AI_ASSISTANT"?(a(),n("div",we,[h(J,{placement:"top",transfer:!0,"popper-class":"popperClassTemplate",modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=o=>I.value=o)},{content:x(()=>[s("div",$e,[h(g,{fix:"",show:w.value},null,8,["show"]),(a(!0),n(N,null,A(E.value,o=>(a(),n("div",{class:"content-item",onClick:C=>Y(o)},L(o.userName),9,Ne))),256))])]),default:x(()=>[Se]),_:1},8,["modelValue"]),s("div",Ae,[(a(!0),n(N,null,A(p.value,(o,C)=>(a(),n("div",Ee,[s("div",null,L(o.userName),1),s("img",{class:"tag-close",onClick:ne=>p.value.splice(C,1),src:he},null,8,xe)]))),256))])])):_("",!0),s("div",{class:F(["area",e.isUoload?"uploadArea":""])},[h(ee,null,{default:x(()=>[h(Z,{type:"textarea",border:!1,autosize:{minRows:1,maxRows:4},rows:1,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value=o),onOnChange:q,onKeydown:l(G),placeholder:l(U)?l(U):"请输入您要问的问题"},null,8,["modelValue","onKeydown","placeholder"])]),_:1}),s("div",Re,[s("div",{class:"submit",onClick:t[2]||(t[2]=(...o)=>l(O)&&l(O)(...o))},[Te,l(B)?(a(),n("div",Be,"-"+L(l(B)),1)):_("",!0),Ue])]),e.isUoload?(a(),n("div",Ve,[h(te,{format:e.format,modeType:"icon",multiple:!0,code:l(D),type:e.robotType,onUploadSuccess:Q},null,8,["format","code","type"])])):_("",!0),e.isInternet?(a(),n("div",Oe,[s("span",{class:F(S.value?"active":""),onClick:H},null,2)])):_("",!0)],2),!e.$isEmpty(l(r).imgList)||!e.$isEmpty(l(r).fileList)?(a(),n("div",Je,[e.$isEmpty(l(r).imgList)?_("",!0):(a(),n("div",Me,[(a(!0),n(N,null,A(l(r).imgList,o=>(a(),n("div",Pe,[s("img",{class:"del",onClick:t[3]||(t[3]=C=>l(r).imgList.splice(e.index,1)),src:z,alt:""}),h(se,{class:"userPic",onClick:C=>R.value.showFn(o.url),src:o.url,fit:"cover"},null,8,["onClick","src"])]))),256))])),e.$isEmpty(l(r).fileList)?_("",!0):(a(),n("div",Fe,[(a(!0),n(N,null,A(l(r).fileList,(o,C)=>(a(),n("div",Ke,[s("img",{class:"del",onClick:ne=>l(r).fileList.splice(C,1),src:z,alt:""},null,8,ze),s("img",{class:"filePic",src:e.$loadFileImages(o.name),alt:""},null,8,De),s("h3",null,L(o.name.split(".")[0]),1),s("p",null,L(o.name.split(".")[1].toUpperCase())+"，"+L(o.size)+"KB",1)]))),256))]))])):_("",!0),u.isAgreement?(a(),n("p",je,[K(" 请遵守"),s("a",{href:l(y).configuration.userServiceLink},"《用户服务协议》",8,qe),K("，Ai结果由各大模型输出，其内容仅供参考，不代表我们的观点和态度。 ")])):_("",!0),h(oe,{ref_key:"previewImgRef",ref:R},null,512)])}}});const Ze=_e(Ge,[["__scopeId","data-v-cb57057e"]]);export{Ze as i};
